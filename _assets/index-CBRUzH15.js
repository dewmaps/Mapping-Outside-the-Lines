var eO=Object.defineProperty;var Vw=L=>{throw TypeError(L)};var tO=(L,w,p)=>w in L?eO(L,w,{enumerable:!0,configurable:!0,writable:!0,value:p}):L[w]=p;var yr=(L,w,p)=>tO(L,typeof w!="symbol"?w+"":w,p),Gw=(L,w,p)=>w.has(L)||Vw("Cannot "+p);var aa=(L,w,p)=>(Gw(L,w,"read from private field"),p?p.call(L):w.get(L)),Yw=(L,w,p)=>w.has(L)?Vw("Cannot add the same private member more than once"):w instanceof WeakSet?w.add(L):w.set(L,p);var zr=(L,w,p)=>(Gw(L,w,"access private method"),p);(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))v(x);new MutationObserver(x=>{for(const k of x)if(k.type==="childList")for(const I of k.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&v(I)}).observe(document,{childList:!0,subtree:!0});function p(x){const k={};return x.integrity&&(k.integrity=x.integrity),x.referrerPolicy&&(k.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?k.credentials="include":x.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function v(x){if(x.ep)return;x.ep=!0;const k=p(x);fetch(x.href,k)}})();var Su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iO(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}var Xw={},Zw;function rO(){if(Zw)return Xw;Zw=1,(()=>{var L=Object.create,w=Object.defineProperty,p=Object.defineProperties,v=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols,M=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,se=(e,t,i)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,A=(e,t)=>{for(var i in t||(t={}))j.call(t,i)&&se(e,i,t[i]);if(I)for(var i of I(t))X.call(t,i)&&se(e,i,t[i]);return e},D=(e,t)=>p(e,x(t)),$e=e=>w(e,"__esModule",{value:!0}),oe=(e,t)=>{var i={};for(var r in e)j.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&I)for(var r of I(e))t.indexOf(r)<0&&X.call(e,r)&&(i[r]=e[r]);return i},mt=(e,t)=>()=>(e&&(t=e(e=0)),t),Ke=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),wt=(e,t)=>{for(var i in t)w(e,i,{get:t[i],enumerable:!0})},je=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of k(t))!j.call(e,n)&&(i||n!=="default")&&w(e,n,{get:()=>t[n],enumerable:!(r=v(t,n))||r.enumerable});return e},De=(e,t)=>je($e(w(e!=null?L(M(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),Qt=(e=>(t,i)=>e&&e.get(t)||(i=je($e({}),t,1),e&&e.set(t,i),i))(typeof WeakMap<"u"?new WeakMap:0),Ve=(e,t,i)=>(se(e,typeof t!="symbol"?t+"":t,i),i);function $t(e,t){for(var i in t)e[i]=t[i];return e}function gi(e){var t=e.parentNode;t&&t.removeChild(e)}function $(e,t,i){var r,n,o,l={};for(o in t)o=="key"?r=t[o]:o=="ref"?n=t[o]:l[o]=t[o];if(arguments.length>2&&(l.children=arguments.length>3?ua.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)l[o]===void 0&&(l[o]=e.defaultProps[o]);return Ai(e,l,r,n,null)}function Ai(e,t,i,r,n){var o={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:n??++bf};return n==null&&Te.vnode!=null&&Te.vnode(o),o}function br(){return{current:null}}function Je(e){return e.children}function Gt(e,t){this.props=e,this.context=t}function Pt(e,t){if(t==null)return e.__?Pt(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Pt(e):null}function Fi(e){var t,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Fi(e)}}function or(e){(!e.__d&&(e.__d=!0)&&ca.push(e)&&!qi.__r++||xf!==Te.debounceRendering)&&((xf=Te.debounceRendering)||wf)(qi)}function qi(){for(var e;qi.__r=ca.length;)e=ca.sort(function(t,i){return t.__v.__b-i.__v.__b}),ca=[],e.some(function(t){var i,r,n,o,l,u;t.__d&&(l=(o=(i=t).__v).__e,(u=i.__P)&&(r=[],(n=$t({},o)).__v=o.__v+1,mi(u,o,n,i.__n,u.ownerSVGElement!==void 0,o.__h!=null?[l]:null,r,l??Pt(o),o.__h),ct(r,o),o.__e!=l&&Fi(o)))})}function Yi(e,t,i,r,n,o,l,u,h,g){var f,y,S,C,_,T,R,O=r&&r.__k||Ou,E=O.length;for(i.__k=[],f=0;f<t.length;f++)if((C=i.__k[f]=(C=t[f])==null||typeof C=="boolean"?null:typeof C=="string"||typeof C=="number"||typeof C=="bigint"?Ai(null,C,null,null,C):Array.isArray(C)?Ai(Je,{children:C},null,null,null):C.__b>0?Ai(C.type,C.props,C.key,null,C.__v):C)!=null){if(C.__=i,C.__b=i.__b+1,(S=O[f])===null||S&&C.key==S.key&&C.type===S.type)O[f]=void 0;else for(y=0;y<E;y++){if((S=O[y])&&C.key==S.key&&C.type===S.type){O[y]=void 0;break}S=null}mi(e,C,S=S||ha,n,o,l,u,h,g),_=C.__e,(y=C.ref)&&S.ref!=y&&(R||(R=[]),S.ref&&R.push(S.ref,null,C),R.push(y,C.__c||_,C)),_!=null?(T==null&&(T=_),typeof C.type=="function"&&C.__k===S.__k?C.__d=h=lr(C,h,e):h=Z(e,C,S,O,_,h),typeof i.type=="function"&&(i.__d=h)):h&&S.__e==h&&h.parentNode!=e&&(h=Pt(S))}for(i.__e=T,f=E;f--;)O[f]!=null&&(typeof i.type=="function"&&O[f].__e!=null&&O[f].__e==i.__d&&(i.__d=Pt(r,f+1)),yf(O[f],O[f]));if(R)for(f=0;f<R.length;f++)mo(R[f],R[++f],R[++f])}function lr(e,t,i){for(var r,n=e.__k,o=0;n&&o<n.length;o++)(r=n[o])&&(r.__=e,t=typeof r.type=="function"?lr(r,t,i):Z(i,r,r,n,r.__e,t));return t}function pe(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(i){pe(i,t)}):t.push(e)),t}function Z(e,t,i,r,n,o){var l,u,h;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(i==null||n!=o||n.parentNode==null)e:if(o==null||o.parentNode!==e)e.appendChild(n),l=null;else{for(u=o,h=0;(u=u.nextSibling)&&h<r.length;h+=2)if(u==n)break e;e.insertBefore(n,o),l=o}return l!==void 0?l:n.nextSibling}function re(e,t,i,r,n){var o;for(o in i)o==="children"||o==="key"||o in t||te(e,o,null,i[o],r);for(o in t)n&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||i[o]===t[o]||te(e,o,t[o],i[o],r)}function he(e,t,i){t[0]==="-"?e.setProperty(t,i):e[t]=i==null?"":typeof i!="number"||Sf.test(t)?i:i+"px"}function te(e,t,i,r,n){var o;e:if(t==="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||he(e.style,t,"");if(i)for(t in i)r&&i[t]===r[t]||he(e.style,t,i[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=i,i?r||e.addEventListener(t,o?tt:Re,o):e.removeEventListener(t,o?tt:Re,o);else if(t!=="dangerouslySetInnerHTML"){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=i??"";break e}catch{}typeof i=="function"||(i!=null&&(i!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,i):e.removeAttribute(t))}}function Re(e){this.l[e.type+!1](Te.event?Te.event(e):e)}function tt(e){this.l[e.type+!0](Te.event?Te.event(e):e)}function mi(e,t,i,r,n,o,l,u,h){var g,f,y,S,C,_,T,R,O,E,F,z=t.type;if(t.constructor!==void 0)return null;i.__h!=null&&(h=i.__h,u=t.__e=i.__e,t.__h=null,o=[u]),(g=Te.__b)&&g(t);try{e:if(typeof z=="function"){if(R=t.props,O=(g=z.contextType)&&r[g.__c],E=g?O?O.props.value:g.__:r,i.__c?T=(f=t.__c=i.__c).__=f.__E:("prototype"in z&&z.prototype.render?t.__c=f=new z(R,E):(t.__c=f=new Gt(R,E),f.constructor=z,f.render=Iu),O&&O.sub(f),f.props=R,f.state||(f.state={}),f.context=E,f.__n=r,y=f.__d=!0,f.__h=[]),f.__s==null&&(f.__s=f.state),z.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=$t({},f.__s)),$t(f.__s,z.getDerivedStateFromProps(R,f.__s))),S=f.props,C=f.state,y)z.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(z.getDerivedStateFromProps==null&&R!==S&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(R,E),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(R,f.__s,E)===!1||t.__v===i.__v){f.props=R,f.state=f.__s,t.__v!==i.__v&&(f.__d=!1),f.__v=t,t.__e=i.__e,t.__k=i.__k,t.__k.forEach(function(U){U&&(U.__=t)}),f.__h.length&&l.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(R,f.__s,E),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(S,C,_)})}f.context=E,f.props=R,f.state=f.__s,(g=Te.__r)&&g(t),f.__d=!1,f.__v=t,f.__P=e,g=f.render(f.props,f.state,f.context),f.state=f.__s,f.getChildContext!=null&&(r=$t($t({},r),f.getChildContext())),y||f.getSnapshotBeforeUpdate==null||(_=f.getSnapshotBeforeUpdate(S,C)),F=g!=null&&g.type===Je&&g.key==null?g.props.children:g,Yi(e,Array.isArray(F)?F:[F],t,i,r,n,o,l,u,h),f.base=t.__e,t.__h=null,f.__h.length&&l.push(f),T&&(f.__E=f.__=null),f.__e=!1}else o==null&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=ys(i.__e,t,i,r,n,o,l,h);(g=Te.diffed)&&g(t)}catch(U){t.__v=null,(h||o!=null)&&(t.__e=u,t.__h=!!h,o[o.indexOf(u)]=null),Te.__e(U,t,i)}}function ct(e,t){Te.__c&&Te.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(r){r.call(i)})}catch(r){Te.__e(r,i.__v)}})}function ys(e,t,i,r,n,o,l,u){var h,g,f,y=i.props,S=t.props,C=t.type,_=0;if(C==="svg"&&(n=!0),o!=null){for(;_<o.length;_++)if((h=o[_])&&"setAttribute"in h==!!C&&(C?h.localName===C:h.nodeType===3)){e=h,o[_]=null;break}}if(e==null){if(C===null)return document.createTextNode(S);e=n?document.createElementNS("http://www.w3.org/2000/svg",C):document.createElement(C,S.is&&S),o=null,u=!1}if(C===null)y===S||u&&e.data===S||(e.data=S);else{if(o=o&&ua.call(e.childNodes),g=(y=i.props||ha).dangerouslySetInnerHTML,f=S.dangerouslySetInnerHTML,!u){if(o!=null)for(y={},_=0;_<e.attributes.length;_++)y[e.attributes[_].name]=e.attributes[_].value;(f||g)&&(f&&(g&&f.__html==g.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(re(e,S,y,n,u),f)t.__k=[];else if(_=t.props.children,Yi(e,Array.isArray(_)?_:[_],t,i,r,n&&C!=="foreignObject",o,l,o?o[0]:i.__k&&Pt(i,0),u),o!=null)for(_=o.length;_--;)o[_]!=null&&gi(o[_]);u||("value"in S&&(_=S.value)!==void 0&&(_!==e.value||C==="progress"&&!_||C==="option"&&_!==y.value)&&te(e,"value",_,y.value,!1),"checked"in S&&(_=S.checked)!==void 0&&_!==e.checked&&te(e,"checked",_,y.checked,!1))}return e}function mo(e,t,i){try{typeof e=="function"?e(t):e.current=t}catch(r){Te.__e(r,i)}}function yf(e,t,i){var r,n;if(Te.unmount&&Te.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||mo(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){Te.__e(o,t)}r.base=r.__P=null}if(r=e.__k)for(n=0;n<r.length;n++)r[n]&&yf(r[n],t,typeof e.type!="function");i||e.__e==null||gi(e.__e),e.__e=e.__d=void 0}function Iu(e,t,i){return this.constructor(e,i)}function wr(e,t,i){var r,n,o;Te.__&&Te.__(e,t),n=(r=typeof i=="function")?null:i&&i.__k||t.__k,o=[],mi(t,e=(!r&&i||t).__k=$(Je,null,[e]),n||ha,ha,t.ownerSVGElement!==void 0,!r&&i?[i]:n?null:t.firstChild?ua.call(t.childNodes):null,o,!r&&i?i:n?n.__e:t.firstChild,r),ct(o,e)}function Ru(e,t){wr(e,t,Ru)}function Lu(e,t,i){var r,n,o,l=$t({},e.props);for(o in t)o=="key"?r=t[o]:o=="ref"?n=t[o]:l[o]=t[o];return arguments.length>2&&(l.children=arguments.length>3?ua.call(arguments,2):i),Ai(e.type,l,r||e.key,n||e.ref,null)}function Kt(e,t){var i={__c:t="__cC"+_f++,__:e,Consumer:function(r,n){return r.children(n)},Provider:function(r){var n,o;return this.getChildContext||(n=[],(o={})[t]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&n.some(or)},this.sub=function(l){n.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){n.splice(n.indexOf(l),1),u&&u.call(l)}}),r.children}};return i.Provider.__=i.Consumer.contextType=i}var ua,Te,bf,ca,wf,xf,_f,ha,Ou,Sf,Xe=mt(()=>{ha={},Ou=[],Sf=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ua=Ou.slice,Te={__e:function(e,t,i,r){for(var n,o,l;t=t.__;)if((n=t.__c)&&!n.__)try{if((o=n.constructor)&&o.getDerivedStateFromError!=null&&(n.setState(o.getDerivedStateFromError(e)),l=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e,r||{}),l=n.__d),l)return n.__E=n}catch(u){e=u}throw e}},bf=0,Gt.prototype.setState=function(e,t){var i;i=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=$t({},this.state),typeof e=="function"&&(e=e($t({},i),this.props)),e&&$t(i,e),e!=null&&this.__v&&(t&&this.__h.push(t),or(this))},Gt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),or(this))},Gt.prototype.render=Je,ca=[],wf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,qi.__r=0,_f=0});function bs(e,t){Te.__h&&Te.__h(oi,e,Ln||t),Ln=0;var i=oi.__H||(oi.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function ze(e){return Ln=1,ws(kf,e)}function ws(e,t,i){var r=bs(Rn++,2);return r.t=e,r.__c||(r.__=[i?i(t):kf(void 0,t),function(n){var o=r.t(r.__[0],n);r.__[0]!==o&&(r.__=[o,r.__[1]],r.__c.setState({}))}],r.__c=oi),r.__}function fe(e,t){var i=bs(Rn++,3);!Te.__s&&Fu(i.__H,t)&&(i.__=e,i.__H=t,oi.__H.__h.push(i))}function Tt(e,t){var i=bs(Rn++,4);!Te.__s&&Fu(i.__H,t)&&(i.__=e,i.__H=t,oi.__h.push(i))}function ke(e){return Ln=5,Ae(function(){return{current:e}},[])}function Ef(e,t,i){Ln=6,Tt(function(){return typeof e=="function"?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},i==null?i:i.concat(e))}function Ae(e,t){var i=bs(Rn++,7);return Fu(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function Ue(e,t){return Ln=8,Ae(function(){return e},t)}function Yt(e){var t=oi.context[e.__c],i=bs(Rn++,9);return i.c=e,t?(i.__==null&&(i.__=!0,t.sub(oi)),t.props.value):e.__}function Cf(e,t){Te.useDebugValue&&Te.useDebugValue(t?t(e):e)}function Tx(e){var t=bs(Rn++,10),i=ze();return t.__=e,oi.componentDidCatch||(oi.componentDidCatch=function(r){t.__&&t.__(r),i[1](r)}),[i[0],function(){i[1](void 0)}]}function Ix(){for(var e;e=Mu.shift();)if(e.__P)try{e.__H.__h.forEach(vo),e.__H.__h.forEach($u),e.__H.__h=[]}catch(t){e.__H.__h=[],Te.__e(t,e.__v)}}function vo(e){var t=oi,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),oi=t}function $u(e){var t=oi;e.__c=e.__(),oi=t}function Fu(e,t){return!e||e.length!==t.length||t.some(function(i,r){return i!==e[r]})}function kf(e,t){return typeof t=="function"?t(e):t}var Rn,oi,Af,Ln,Mu,zu,Nu,ju,Bu,Du,Uu,Pf=mt(()=>{Xe(),Ln=0,Mu=[],zu=Te.__b,Nu=Te.__r,ju=Te.diffed,Bu=Te.__c,Du=Te.unmount,Te.__b=function(e){oi=null,zu&&zu(e)},Te.__r=function(e){Nu&&Nu(e),Rn=0;var t=(oi=e.__c).__H;t&&(t.__h.forEach(vo),t.__h.forEach($u),t.__h=[])},Te.diffed=function(e){ju&&ju(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(Mu.push(t)!==1&&Af===Te.requestAnimationFrame||((Af=Te.requestAnimationFrame)||function(i){var r,n=function(){clearTimeout(o),Uu&&cancelAnimationFrame(r),setTimeout(i)},o=setTimeout(n,100);Uu&&(r=requestAnimationFrame(n))})(Ix)),oi=null},Te.__c=function(e,t){t.some(function(i){try{i.__h.forEach(vo),i.__h=i.__h.filter(function(r){return!r.__||$u(r)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],Te.__e(r,i.__v)}}),Bu&&Bu(e,t)},Te.unmount=function(e){Du&&Du(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(r){try{vo(r)}catch(n){t=n}}),t&&Te.__e(t,i.__v))},Uu=typeof requestAnimationFrame=="function"}),xs={};wt(xs,{Children:()=>tn,Component:()=>Gt,Fragment:()=>Je,PureComponent:()=>yo,StrictMode:()=>Wf,Suspense:()=>da,SuspenseList:()=>_s,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>ec,cloneElement:()=>bo,createContext:()=>Kt,createElement:()=>$,createFactory:()=>$f,createPortal:()=>Lf,createRef:()=>br,default:()=>J,findDOMNode:()=>Mf,flushSync:()=>ic,forwardRef:()=>li,hydrate:()=>Of,isValidElement:()=>fa,lazy:()=>Rf,memo:()=>Hu,render:()=>Ss,unmountComponentAtNode:()=>Ff,unstable_batchedUpdates:()=>tc,useCallback:()=>Ue,useContext:()=>Yt,useDebugValue:()=>Cf,useEffect:()=>fe,useErrorBoundary:()=>Tx,useImperativeHandle:()=>Ef,useLayoutEffect:()=>Tt,useMemo:()=>Ae,useReducer:()=>ws,useRef:()=>ke,useState:()=>ze,version:()=>wo});function Tf(e,t){for(var i in t)e[i]=t[i];return e}function Wu(e,t){for(var i in e)if(i!=="__source"&&!(i in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function yo(e){this.props=e}function Hu(e,t){function i(n){var o=this.props.ref,l=o==n.ref;return!l&&o&&(o.call?o(null):o.current=null),t?!t(this.props,n)||!l:Wu(this.props,n)}function r(n){return this.shouldComponentUpdate=i,$(e,n)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}function li(e){function t(i){var r=Tf({},i);return delete r.ref,e(r,i.ref||null)}return t.$$typeof=zf,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}function da(){this.__u=0,this.t=null,this.__b=null}function If(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Rf(e){var t,i,r;function n(o){if(t||(t=e()).then(function(l){i=l.default||l},function(l){r=l}),r)throw r;if(!i)throw t;return $(i,o)}return n.displayName="Lazy",n.__f=!0,n}function _s(){this.u=null,this.o=null}function Rx(e){return this.getChildContext=function(){return e.context},e.children}function Lx(e){var t=this,i=e.i;t.componentWillUnmount=function(){wr(null,t.l),t.l=null,t.i=null},t.i&&t.i!==i&&t.componentWillUnmount(),e.__v?(t.l||(t.i=i,t.l={nodeType:1,parentNode:i,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,n){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),wr($(Rx,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Lf(e,t){return $(Lx,{__v:e,i:t})}function Ss(e,t,i){return t.__k==null&&(t.textContent=""),wr(e,t),typeof i=="function"&&i(),e?e.__c:null}function Of(e,t,i){return Ru(e,t),typeof i=="function"&&i(),e?e.__c:null}function Ox(){}function $x(){return this.cancelBubble}function Fx(){return this.defaultPrevented}function $f(e){return $.bind(null,e)}function fa(e){return!!e&&e.$$typeof===Yu}function bo(e){return fa(e)?Lu.apply(null,arguments):e}function Ff(e){return!!e.__k&&(wr(null,e),!0)}function Mf(e){return e&&(e.base||e.nodeType===1&&e)||null}var qu,zf,Qu,tn,Nf,Vu,Gu,Yu,jf,Bf,Df,Xu,Uf,Zu,Ku,Ju,ec,wo,tc,ic,Wf,J,Qe=mt(()=>{Pf(),Pf(),Xe(),Xe(),(yo.prototype=new Gt).isPureReactComponent=!0,yo.prototype.shouldComponentUpdate=function(e,t){return Wu(this.props,e)||Wu(this.state,t)},qu=Te.__b,Te.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),qu&&qu(e)},zf=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911,Qu=function(e,t){return e==null?null:pe(pe(e).map(t))},tn={map:Qu,forEach:Qu,count:function(e){return e?pe(e).length:0},only:function(e){var t=pe(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:pe},Nf=Te.__e,Te.__e=function(e,t,i,r){if(e.then){for(var n,o=t;o=o.__;)if((n=o.__c)&&n.__c)return t.__e==null&&(t.__e=i.__e,t.__k=i.__k),n.__c(e,t)}Nf(e,t,i,r)},Vu=Te.unmount,Te.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),Vu&&Vu(e)},(da.prototype=new Gt).__c=function(e,t){var i=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(i);var n=If(r.__v),o=!1,l=function(){o||(o=!0,i.__R=null,n?n(u):u())};i.__R=l;var u=function(){if(!--r.__u){if(r.state.__e){var g=r.state.__e;r.__v.__k[0]=(function y(S,C,_){return S&&(S.__v=null,S.__k=S.__k&&S.__k.map(function(T){return y(T,C,_)}),S.__c&&S.__c.__P===C&&(S.__e&&_.insertBefore(S.__e,S.__d),S.__c.__e=!0,S.__c.__P=_)),S})(g,g.__c.__P,g.__c.__O)}var f;for(r.setState({__e:r.__b=null});f=r.t.pop();)f.forceUpdate()}},h=t.__h===!0;r.__u++||h||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(l,l)},da.prototype.componentWillUnmount=function(){this.t=[]},da.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var i=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=(function o(l,u,h){return l&&(l.__c&&l.__c.__H&&(l.__c.__H.__.forEach(function(g){typeof g.__c=="function"&&g.__c()}),l.__c.__H=null),(l=Tf({},l)).__c!=null&&(l.__c.__P===h&&(l.__c.__P=u),l.__c=null),l.__k=l.__k&&l.__k.map(function(g){return o(g,u,h)})),l})(this.__b,i,r.__O=r.__P)}this.__b=null}var n=t.__e&&$(Je,null,e.fallback);return n&&(n.__h=null),[$(Je,null,t.__e?null:e.children),n]},Gu=function(e,t,i){if(++i[1]===i[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(i=e.u;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.u=i=i[2]}},(_s.prototype=new Gt).__e=function(e){var t=this,i=If(t.__v),r=t.o.get(e);return r[0]++,function(n){var o=function(){t.props.revealOrder?(r.push(n),Gu(t,e,r)):n()};i?i(o):o()}},_s.prototype.render=function(e){this.u=null,this.o=new Map;var t=pe(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var i=t.length;i--;)this.o.set(t[i],this.u=[1,0,this.u]);return e.children},_s.prototype.componentDidUpdate=_s.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,i){Gu(e,i,t)})},Yu=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,jf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Bf=typeof document<"u",Df=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)},Gt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Gt.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}),Xu=Te.event,Te.event=function(e){return Xu&&(e=Xu(e)),e.persist=Ox,e.isPropagationStopped=$x,e.isDefaultPrevented=Fx,e.nativeEvent=e},Zu={configurable:!0,get:function(){return this.class}},Ku=Te.vnode,Te.vnode=function(e){var t=e.type,i=e.props,r=i;if(typeof t=="string"){var n=t.indexOf("-")===-1;for(var o in r={},i){var l=i[o];Bf&&o==="children"&&t==="noscript"||o==="value"&&"defaultValue"in i&&l==null||(o==="defaultValue"&&"value"in i&&i.value==null?o="value":o==="download"&&l===!0?l="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!Df(i.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():n&&jf.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():l===null&&(l=void 0),r[o]=l)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=pe(i.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=pe(i.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),e.props=r,i.class!=i.className&&(Zu.enumerable="className"in i,i.className!=null&&(r.class=i.className),Object.defineProperty(r,"className",Zu))}e.$$typeof=Yu,Ku&&Ku(e)},Ju=Te.__r,Te.__r=function(e){Ju&&Ju(e),Uf=e.__c},ec={ReactCurrentDispatcher:{current:{readContext:function(e){return Uf.__n[e.__c].props.value}}}},wo="17.0.2",tc=function(e,t){return e(t)},ic=function(e,t){return e(t)},Wf=Je,J={useState:ze,useReducer:ws,useEffect:fe,useLayoutEffect:Tt,useRef:ke,useImperativeHandle:Ef,useMemo:Ae,useCallback:Ue,useContext:Yt,useDebugValue:Cf,version:"17.0.2",Children:tn,render:Ss,hydrate:Of,unmountComponentAtNode:Ff,createPortal:Lf,createElement:$,createContext:Kt,createFactory:$f,cloneElement:bo,createRef:br,Fragment:Je,isValidElement:fa,findDOMNode:Mf,Component:Gt,PureComponent:yo,memo:Hu,forwardRef:li,flushSync:ic,unstable_batchedUpdates:tc,StrictMode:Je,Suspense:da,SuspenseList:_s,lazy:Rf,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ec}}),Mx=Ke(e=>{function t(ee,Pe){var Oe=ee.length;ee.push(Pe);e:for(;0<Oe;){var Ge=Oe-1>>>1,ut=ee[Ge];if(0<n(ut,Pe))ee[Ge]=Pe,ee[Oe]=ut,Oe=Ge;else break e}}function i(ee){return ee.length===0?null:ee[0]}function r(ee){if(ee.length===0)return null;var Pe=ee[0],Oe=ee.pop();if(Oe!==Pe){ee[0]=Oe;e:for(var Ge=0,ut=ee.length,K=ut>>>1;Ge<K;){var Ce=2*(Ge+1)-1,dt=ee[Ce],pt=Ce+1,Et=ee[pt];if(0>n(dt,Oe))pt<ut&&0>n(Et,dt)?(ee[Ge]=Et,ee[pt]=Oe,Ge=pt):(ee[Ge]=dt,ee[Ce]=Oe,Ge=Ce);else if(pt<ut&&0>n(Et,Oe))ee[Ge]=Et,ee[pt]=Oe,Ge=pt;else break e}}return Pe}function n(ee,Pe){var Oe=ee.sortIndex-Pe.sortIndex;return Oe!==0?Oe:ee.id-Pe.id}typeof performance=="object"&&typeof performance.now=="function"?(o=performance,e.unstable_now=function(){return o.now()}):(l=Date,u=l.now(),e.unstable_now=function(){return l.now()-u});var o,l,u,h=[],g=[],f=1,y=null,S=3,C=!1,_=!1,T=!1,R=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ee){for(var Pe=i(g);Pe!==null;){if(Pe.callback===null)r(g);else if(Pe.startTime<=ee)r(g),Pe.sortIndex=Pe.expirationTime,t(h,Pe);else break;Pe=i(g)}}function z(ee){if(T=!1,F(ee),!_)if(i(h)!==null)_=!0,ce(U);else{var Pe=i(g);Pe!==null&&We(z,Pe.startTime-ee)}}function U(ee,Pe){_=!1,T&&(T=!1,O(V),V=-1),C=!0;var Oe=S;try{for(F(Pe),y=i(h);y!==null&&(!(y.expirationTime>Pe)||ee&&!ne());){var Ge=y.callback;if(typeof Ge=="function"){y.callback=null,S=y.priorityLevel;var ut=Ge(y.expirationTime<=Pe);Pe=e.unstable_now(),typeof ut=="function"?y.callback=ut:y===i(h)&&r(h),F(Pe)}else r(h);y=i(h)}if(y!==null)var K=!0;else{var Ce=i(g);Ce!==null&&We(z,Ce.startTime-Pe),K=!1}return K}finally{y=null,S=Oe,C=!1}}var H=!1,G=null,V=-1,le=5,q=-1;function ne(){return!(e.unstable_now()-q<le)}function ge(){if(G!==null){var ee=e.unstable_now();q=ee;var Pe=!0;try{Pe=G(!0,ee)}finally{Pe?de():(H=!1,G=null)}}else H=!1}var de;typeof E=="function"?de=function(){E(ge)}:typeof MessageChannel<"u"?(we=new MessageChannel,me=we.port2,we.port1.onmessage=ge,de=function(){me.postMessage(null)}):de=function(){R(ge,0)};var we,me;function ce(ee){G=ee,H||(H=!0,de())}function We(ee,Pe){V=R(function(){ee(e.unstable_now())},Pe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){_||C||(_=!0,ce(U))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return i(h)},e.unstable_next=function(ee){switch(S){case 1:case 2:case 3:var Pe=3;break;default:Pe=S}var Oe=S;S=Pe;try{return ee()}finally{S=Oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,Pe){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Oe=S;S=ee;try{return Pe()}finally{S=Oe}},e.unstable_scheduleCallback=function(ee,Pe,Oe){var Ge=e.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?Ge+Oe:Ge):Oe=Ge,ee){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=Oe+ut,ee={id:f++,callback:Pe,priorityLevel:ee,startTime:Oe,expirationTime:ut,sortIndex:-1},Oe>Ge?(ee.sortIndex=Oe,t(g,ee),i(h)===null&&ee===i(g)&&(T?(O(V),V=-1):T=!0,We(z,Oe-Ge))):(ee.sortIndex=ut,t(h,ee),_||C||(_=!0,ce(U))),ee},e.unstable_shouldYield=ne,e.unstable_wrapCallback=function(ee){var Pe=S;return function(){var Oe=S;S=Pe;try{return ee.apply(this,arguments)}finally{S=Oe}}}}),zx=Ke((e,t)=>{t.exports=Mx()}),Nx=Ke((e,t)=>{t.exports=function(i){var r={},n=(Qe(),Qt(xs)),o=zx(),l=Object.assign;function u(s){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,g=Symbol.for("react.element"),f=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),U=Symbol.for("react.offscreen"),H=Symbol.iterator;function G(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}function V(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case y:return"Fragment";case f:return"Portal";case C:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case E:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case T:return(s.displayName||"Context")+".Consumer";case _:return(s._context.displayName||"Context")+".Provider";case R:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return a=s.displayName||null,a!==null?a:V(s.type)||"Memo";case z:a=s._payload,s=s._init;try{return V(s(a))}catch{}}return null}function le(s){var a=s.type;switch(s.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=a.render,s=s.displayName||s.name||"",a.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(a);case 8:return a===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function q(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function ne(s){if(q(s)!==s)throw Error(u(188))}function ge(s){var a=s.alternate;if(!a){if(a=q(s),a===null)throw Error(u(188));return a!==s?null:s}for(var c=s,d=a;;){var m=c.return;if(m===null)break;var b=m.alternate;if(b===null){if(d=m.return,d!==null){c=d;continue}break}if(m.child===b.child){for(b=m.child;b;){if(b===c)return ne(m),s;if(b===d)return ne(m),a;b=b.sibling}throw Error(u(188))}if(c.return!==d.return)c=m,d=b;else{for(var P=!1,N=m.child;N;){if(N===c){P=!0,c=m,d=b;break}if(N===d){P=!0,d=m,c=b;break}N=N.sibling}if(!P){for(N=b.child;N;){if(N===c){P=!0,c=b,d=m;break}if(N===d){P=!0,d=b,c=m;break}N=N.sibling}if(!P)throw Error(u(189))}}if(c.alternate!==d)throw Error(u(190))}if(c.tag!==3)throw Error(u(188));return c.stateNode.current===c?s:a}function de(s){return s=ge(s),s!==null?we(s):null}function we(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var a=we(s);if(a!==null)return a;s=s.sibling}return null}function me(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){if(s.tag!==4){var a=me(s);if(a!==null)return a}s=s.sibling}return null}var ce=Array.isArray,We=i.getPublicInstance,ee=i.getRootHostContext,Pe=i.getChildHostContext,Oe=i.prepareForCommit,Ge=i.resetAfterCommit,ut=i.createInstance,K=i.appendInitialChild,Ce=i.finalizeInitialChildren,dt=i.prepareUpdate,pt=i.shouldSetTextContent,Et=i.createTextInstance,Ri=i.scheduleTimeout,cr=i.cancelTimeout,hr=i.noTimeout,Li=i.isPrimaryRenderer,jt=i.supportsMutation,Zi=i.supportsPersistence,Wt=i.supportsHydration,Qr=i.getInstanceFromNode,Vr=i.preparePortalMount,ue=i.getCurrentEventPriority,xe=i.detachDeletedInstance,Fe=i.supportsMicrotasks,rt=i.scheduleMicrotask,Ct=i.supportsTestSelectors,ii=i.findFiberRoot,Oi=i.getBoundingRect,zh=i.getTextContent,ts=i.isHiddenSubtree,Ni=i.matchAccessibilityRole,Tl=i.setFocusIfFocusable,Nh=i.setupIntersectionObserver,jh=i.appendChild,za=i.appendChildToContainer,qs=i.commitTextUpdate,Na=i.commitMount,Il=i.commitUpdate,be=i.insertBefore,Ne=i.insertInContainerBefore,gt=i.removeChild,Bt=i.removeChildFromContainer,Ht=i.resetTextContent,ie=i.hideInstance,Ie=i.hideTextInstance,et=i.unhideInstance,xt=i.unhideTextInstance,lt=i.clearContainer,Pr=i.cloneInstance,ja=i.createContainerChildSet,a0=i.appendChildToContainerChildSet,UR=i.finalizeContainerChildren,Bh=i.replaceContainerChildren,o0=i.cloneHiddenInstance,l0=i.cloneHiddenTextInstance,WR=i.canHydrateInstance,HR=i.canHydrateTextInstance,qR=i.canHydrateSuspenseInstance,u0=i.isSuspenseInstancePending,Dh=i.isSuspenseInstanceFallback,QR=i.getSuspenseInstanceFallbackErrorDetails,VR=i.registerSuspenseInstanceRetry,Rl=i.getNextHydratableSibling,GR=i.getFirstHydratableChild,YR=i.getFirstHydratableChildWithinContainer,XR=i.getFirstHydratableChildWithinSuspenseInstance,ZR=i.hydrateInstance,KR=i.hydrateTextInstance,JR=i.hydrateSuspenseInstance,eL=i.getNextHydratableInstanceAfterSuspenseInstance,tL=i.commitHydratedContainer,iL=i.commitHydratedSuspenseInstance,rL=i.clearSuspenseBoundary,nL=i.clearSuspenseBoundaryFromContainer,sL=i.shouldDeleteUnhydratedTailInstances,aL=i.didNotMatchHydratedContainerTextInstance,oL=i.didNotMatchHydratedTextInstance,Uh;function Ba(s){if(Uh===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);Uh=a&&a[1]||""}return`
`+Uh+s}var Wh=!1;function Hh(s,a){if(!s||Wh)return"";Wh=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ae){var d=ae}Reflect.construct(s,[],a)}else{try{a.call()}catch(ae){d=ae}s.call(a.prototype)}else{try{throw Error()}catch(ae){d=ae}s()}}catch(ae){if(ae&&d&&typeof ae.stack=="string"){for(var m=ae.stack.split(`
`),b=d.stack.split(`
`),P=m.length-1,N=b.length-1;1<=P&&0<=N&&m[P]!==b[N];)N--;for(;1<=P&&0<=N;P--,N--)if(m[P]!==b[N]){if(P!==1||N!==1)do if(P--,N--,0>N||m[P]!==b[N]){var Q=`
`+m[P].replace(" at new "," at ");return s.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",s.displayName)),Q}while(1<=P&&0<=N);break}}}finally{Wh=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?Ba(s):""}var lL=Object.prototype.hasOwnProperty,qh=[],Qs=-1;function bn(s){return{current:s}}function _t(s){0>Qs||(s.current=qh[Qs],qh[Qs]=null,Qs--)}function bt(s,a){Qs++,qh[Qs]=s.current,s.current=a}var wn={},_i=bn(wn),ji=bn(!1),is=wn;function Vs(s,a){var c=s.type.contextTypes;if(!c)return wn;var d=s.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===a)return d.__reactInternalMemoizedMaskedChildContext;var m={},b;for(b in c)m[b]=a[b];return d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=a,s.__reactInternalMemoizedMaskedChildContext=m),m}function Bi(s){return s=s.childContextTypes,s!=null}function Ll(){_t(ji),_t(_i)}function c0(s,a,c){if(_i.current!==wn)throw Error(u(168));bt(_i,a),bt(ji,c)}function h0(s,a,c){var d=s.stateNode;if(a=a.childContextTypes,typeof d.getChildContext!="function")return c;d=d.getChildContext();for(var m in d)if(!(m in a))throw Error(u(108,le(s)||"Unknown",m));return l({},c,d)}function Ol(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||wn,is=_i.current,bt(_i,s),bt(ji,ji.current),!0}function d0(s,a,c){var d=s.stateNode;if(!d)throw Error(u(169));c?(s=h0(s,a,is),d.__reactInternalMemoizedMergedChildContext=s,_t(ji),_t(_i),bt(_i,s)):_t(ji),bt(ji,c)}var dr=Math.clz32?Math.clz32:hL,uL=Math.log,cL=Math.LN2;function hL(s){return s>>>=0,s===0?32:31-(uL(s)/cL|0)|0}var $l=64,Fl=4194304;function Da(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Ml(s,a){var c=s.pendingLanes;if(c===0)return 0;var d=0,m=s.suspendedLanes,b=s.pingedLanes,P=c&268435455;if(P!==0){var N=P&~m;N!==0?d=Da(N):(b&=P,b!==0&&(d=Da(b)))}else P=c&~m,P!==0?d=Da(P):b!==0&&(d=Da(b));if(d===0)return 0;if(a!==0&&a!==d&&(a&m)===0&&(m=d&-d,b=a&-a,m>=b||m===16&&(b&4194240)!==0))return a;if((d&4)!==0&&(d|=c&16),a=s.entangledLanes,a!==0)for(s=s.entanglements,a&=d;0<a;)c=31-dr(a),m=1<<c,d|=s[c],a&=~m;return d}function dL(s,a){switch(s){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fL(s,a){for(var c=s.suspendedLanes,d=s.pingedLanes,m=s.expirationTimes,b=s.pendingLanes;0<b;){var P=31-dr(b),N=1<<P,Q=m[P];Q===-1?((N&c)===0||(N&d)!==0)&&(m[P]=dL(N,a)):Q<=a&&(s.expiredLanes|=N),b&=~N}}function Qh(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function f0(){var s=$l;return $l<<=1,($l&4194240)===0&&($l=64),s}function Vh(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function Ua(s,a,c){s.pendingLanes|=a,a!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,a=31-dr(a),s[a]=c}function pL(s,a){var c=s.pendingLanes&~a;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=a,s.mutableReadLanes&=a,s.entangledLanes&=a,a=s.entanglements;var d=s.eventTimes;for(s=s.expirationTimes;0<c;){var m=31-dr(c),b=1<<m;a[m]=0,d[m]=-1,s[m]=-1,c&=~b}}function Gh(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var d=31-dr(c),m=1<<d;m&a|s[d]&a&&(s[d]|=a),c&=~m}}var nt=0;function p0(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Yh=o.unstable_scheduleCallback,g0=o.unstable_cancelCallback,gL=o.unstable_shouldYield,mL=o.unstable_requestPaint,ri=o.unstable_now,Xh=o.unstable_ImmediatePriority,vL=o.unstable_UserBlockingPriority,Zh=o.unstable_NormalPriority,yL=o.unstable_IdlePriority,zl=null,Tr=null;function bL(s){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(zl,s,void 0,(s.current.flags&128)===128)}catch{}}function wL(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var fr=typeof Object.is=="function"?Object.is:wL,Gr=null,Nl=!1,Kh=!1;function m0(s){Gr===null?Gr=[s]:Gr.push(s)}function xL(s){Nl=!0,m0(s)}function Ir(){if(!Kh&&Gr!==null){Kh=!0;var s=0,a=nt;try{var c=Gr;for(nt=1;s<c.length;s++){var d=c[s];do d=d(!0);while(d!==null)}Gr=null,Nl=!1}catch(m){throw Gr!==null&&(Gr=Gr.slice(s+1)),Yh(Xh,Ir),m}finally{nt=a,Kh=!1}}return null}var Gs=[],Ys=0,jl=null,Bl=0,Ki=[],Ji=0,rs=null,Yr=1,Xr="";function ns(s,a){Gs[Ys++]=Bl,Gs[Ys++]=jl,jl=s,Bl=a}function v0(s,a,c){Ki[Ji++]=Yr,Ki[Ji++]=Xr,Ki[Ji++]=rs,rs=s;var d=Yr;s=Xr;var m=32-dr(d)-1;d&=~(1<<m),c+=1;var b=32-dr(a)+m;if(30<b){var P=m-m%5;b=(d&(1<<P)-1).toString(32),d>>=P,m-=P,Yr=1<<32-dr(a)+m|c<<m|d,Xr=b+s}else Yr=1<<b|c<<m|d,Xr=s}function Jh(s){s.return!==null&&(ns(s,1),v0(s,1,0))}function ed(s){for(;s===jl;)jl=Gs[--Ys],Gs[Ys]=null,Bl=Gs[--Ys],Gs[Ys]=null;for(;s===rs;)rs=Ki[--Ji],Ki[Ji]=null,Xr=Ki[--Ji],Ki[Ji]=null,Yr=Ki[--Ji],Ki[Ji]=null}var Vi=null,er=null,kt=!1,Wa=!1,pr=null;function y0(s,a){var c=sr(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=s,a=s.deletions,a===null?(s.deletions=[c],s.flags|=16):a.push(c)}function b0(s,a){switch(s.tag){case 5:return a=WR(a,s.type,s.pendingProps),a!==null?(s.stateNode=a,Vi=s,er=GR(a),!0):!1;case 6:return a=HR(a,s.pendingProps),a!==null?(s.stateNode=a,Vi=s,er=null,!0):!1;case 13:if(a=qR(a),a!==null){var c=rs!==null?{id:Yr,overflow:Xr}:null;return s.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=sr(18,null,null,0),c.stateNode=a,c.return=s,s.child=c,Vi=s,er=null,!0}return!1;default:return!1}}function td(s){return(s.mode&1)!==0&&(s.flags&128)===0}function id(s){if(kt){var a=er;if(a){var c=a;if(!b0(s,a)){if(td(s))throw Error(u(418));a=Rl(c);var d=Vi;a&&b0(s,a)?y0(d,c):(s.flags=s.flags&-4097|2,kt=!1,Vi=s)}}else{if(td(s))throw Error(u(418));s.flags=s.flags&-4097|2,kt=!1,Vi=s}}}function w0(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Vi=s}function Dl(s){if(!Wt||s!==Vi)return!1;if(!kt)return w0(s),kt=!0,!1;if(s.tag!==3&&(s.tag!==5||sL(s.type)&&!pt(s.type,s.memoizedProps))){var a=er;if(a){if(td(s))throw x0(),Error(u(418));for(;a;)y0(s,a),a=Rl(a)}}if(w0(s),s.tag===13){if(!Wt)throw Error(u(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(u(317));er=eL(s)}else er=Vi?Rl(s.stateNode):null;return!0}function x0(){for(var s=er;s;)s=Rl(s)}function Xs(){Wt&&(er=Vi=null,Wa=kt=!1)}function rd(s){pr===null?pr=[s]:pr.push(s)}var _L=h.ReactCurrentBatchConfig;function Ul(s,a){if(fr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var m=c[d];if(!lL.call(a,m)||!fr(s[m],a[m]))return!1}return!0}function SL(s){switch(s.tag){case 5:return Ba(s.type);case 16:return Ba("Lazy");case 13:return Ba("Suspense");case 19:return Ba("SuspenseList");case 0:case 2:case 15:return s=Hh(s.type,!1),s;case 11:return s=Hh(s.type.render,!1),s;case 1:return s=Hh(s.type,!0),s;default:return""}}function gr(s,a){if(s&&s.defaultProps){a=l({},a),s=s.defaultProps;for(var c in s)a[c]===void 0&&(a[c]=s[c]);return a}return a}var Wl=bn(null),Hl=null,Zs=null,nd=null;function sd(){nd=Zs=Hl=null}function _0(s,a,c){Li?(bt(Wl,a._currentValue),a._currentValue=c):(bt(Wl,a._currentValue2),a._currentValue2=c)}function ad(s){var a=Wl.current;_t(Wl),Li?s._currentValue=a:s._currentValue2=a}function od(s,a,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),s===c)break;s=s.return}}function Ks(s,a){Hl=s,nd=Zs=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&a)!==0&&(Di=!0),s.firstContext=null)}function tr(s){var a=Li?s._currentValue:s._currentValue2;if(nd!==s)if(s={context:s,memoizedValue:a,next:null},Zs===null){if(Hl===null)throw Error(u(308));Zs=s,Hl.dependencies={lanes:0,firstContext:s}}else Zs=Zs.next=s;return a}var ss=null;function ld(s){ss===null?ss=[s]:ss.push(s)}function S0(s,a,c,d){var m=a.interleaved;return m===null?(c.next=c,ld(a)):(c.next=m.next,m.next=c),a.interleaved=c,Rr(s,d)}function Rr(s,a){s.lanes|=a;var c=s.alternate;for(c!==null&&(c.lanes|=a),c=s,s=s.return;s!==null;)s.childLanes|=a,c=s.alternate,c!==null&&(c.childLanes|=a),c=s,s=s.return;return c.tag===3?c.stateNode:null}var xn=!1;function ud(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function E0(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Zr(s,a){return{eventTime:s,lane:a,tag:0,payload:null,callback:null,next:null}}function _n(s,a,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Ze&2)!==0){var m=d.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),d.pending=a,Rr(s,c)}return m=d.interleaved,m===null?(a.next=a,ld(d)):(a.next=m.next,m.next=a),d.interleaved=a,Rr(s,c)}function ql(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,Gh(s,c)}}function C0(s,a){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var m=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var P={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};b===null?m=b=P:b=b.next=P,c=c.next}while(c!==null);b===null?m=b=a:b=b.next=a}else m=b=a;c={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:b,shared:d.shared,effects:d.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}function Ql(s,a,c,d){var m=s.updateQueue;xn=!1;var b=m.firstBaseUpdate,P=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var Q=N,ae=Q.next;Q.next=null,P===null?b=ae:P.next=ae,P=Q;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,N=Ee.lastBaseUpdate,N!==P&&(N===null?Ee.firstBaseUpdate=ae:N.next=ae,Ee.lastBaseUpdate=Q))}if(b!==null){var He=m.baseState;P=0,Ee=ae=Q=null,N=b;do{var ve=N.lane,St=N.eventTime;if((d&ve)===ve){Ee!==null&&(Ee=Ee.next={eventTime:St,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var vt=s,Hi=N;switch(ve=a,St=c,Hi.tag){case 1:if(vt=Hi.payload,typeof vt=="function"){He=vt.call(St,He,ve);break e}He=vt;break e;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=Hi.payload,ve=typeof vt=="function"?vt.call(St,He,ve):vt,ve==null)break e;He=l({},He,ve);break e;case 2:xn=!0}}N.callback!==null&&N.lane!==0&&(s.flags|=64,ve=m.effects,ve===null?m.effects=[N]:ve.push(N))}else St={eventTime:St,lane:ve,tag:N.tag,payload:N.payload,callback:N.callback,next:null},Ee===null?(ae=Ee=St,Q=He):Ee=Ee.next=St,P|=ve;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;ve=N,N=ve.next,ve.next=null,m.lastBaseUpdate=ve,m.shared.pending=null}}while(!0);if(Ee===null&&(Q=He),m.baseState=Q,m.firstBaseUpdate=ae,m.lastBaseUpdate=Ee,a=m.shared.interleaved,a!==null){m=a;do P|=m.lane,m=m.next;while(m!==a)}else b===null&&(m.shared.lanes=0);os|=P,s.lanes=P,s.memoizedState=He}}function k0(s,a,c){if(s=a.effects,a.effects=null,s!==null)for(a=0;a<s.length;a++){var d=s[a],m=d.callback;if(m!==null){if(d.callback=null,d=c,typeof m!="function")throw Error(u(191,m));m.call(d)}}}var A0=new n.Component().refs;function cd(s,a,c,d){a=s.memoizedState,c=c(d,a),c=c==null?a:l({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Vl={isMounted:function(s){return(s=s._reactInternals)?q(s)===s:!1},enqueueSetState:function(s,a,c){s=s._reactInternals;var d=ki(),m=Cn(s),b=Zr(d,m);b.payload=a,c!=null&&(b.callback=c),a=_n(s,b,m),a!==null&&(nr(a,s,m,d),ql(a,s,m))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var d=ki(),m=Cn(s),b=Zr(d,m);b.tag=1,b.payload=a,c!=null&&(b.callback=c),a=_n(s,b,m),a!==null&&(nr(a,s,m,d),ql(a,s,m))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=ki(),d=Cn(s),m=Zr(c,d);m.tag=2,a!=null&&(m.callback=a),a=_n(s,m,d),a!==null&&(nr(a,s,d,c),ql(a,s,d))}};function P0(s,a,c,d,m,b,P){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,b,P):a.prototype&&a.prototype.isPureReactComponent?!Ul(c,d)||!Ul(m,b):!0}function T0(s,a,c){var d=!1,m=wn,b=a.contextType;return typeof b=="object"&&b!==null?b=tr(b):(m=Bi(a)?is:_i.current,d=a.contextTypes,b=(d=d!=null)?Vs(s,m):wn),a=new a(c,b),s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Vl,s.stateNode=a,a._reactInternals=s,d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=b),a}function I0(s,a,c,d){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==s&&Vl.enqueueReplaceState(a,a.state,null)}function hd(s,a,c,d){var m=s.stateNode;m.props=c,m.state=s.memoizedState,m.refs=A0,ud(s);var b=a.contextType;typeof b=="object"&&b!==null?m.context=tr(b):(b=Bi(a)?is:_i.current,m.context=Vs(s,b)),m.state=s.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(cd(s,a,b,c),m.state=s.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(a=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),a!==m.state&&Vl.enqueueReplaceState(m,m.state,null),Ql(s,c,m,d),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function Ha(s,a,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(u(309));var d=c.stateNode}if(!d)throw Error(u(147,s));var m=d,b=""+s;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===b?a.ref:(a=function(P){var N=m.refs;N===A0&&(N=m.refs={}),P===null?delete N[b]:N[b]=P},a._stringRef=b,a)}if(typeof s!="string")throw Error(u(284));if(!c._owner)throw Error(u(290,s))}return s}function Gl(s,a){throw s=Object.prototype.toString.call(a),Error(u(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s))}function R0(s){var a=s._init;return a(s._payload)}function L0(s){function a(W,B){if(s){var Y=W.deletions;Y===null?(W.deletions=[B],W.flags|=16):Y.push(B)}}function c(W,B){if(!s)return null;for(;B!==null;)a(W,B),B=B.sibling;return null}function d(W,B){for(W=new Map;B!==null;)B.key!==null?W.set(B.key,B):W.set(B.index,B),B=B.sibling;return W}function m(W,B){return W=An(W,B),W.index=0,W.sibling=null,W}function b(W,B,Y){return W.index=Y,s?(Y=W.alternate,Y!==null?(Y=Y.index,Y<B?(W.flags|=2,B):Y):(W.flags|=2,B)):(W.flags|=1048576,B)}function P(W){return s&&W.alternate===null&&(W.flags|=2),W}function N(W,B,Y,ye){return B===null||B.tag!==6?(B=Zd(Y,W.mode,ye),B.return=W,B):(B=m(B,Y),B.return=W,B)}function Q(W,B,Y,ye){var Me=Y.type;return Me===y?Ee(W,B,Y.props.children,ye,Y.key):B!==null&&(B.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===z&&R0(Me)===B.type)?(ye=m(B,Y.props),ye.ref=Ha(W,B,Y),ye.return=W,ye):(ye=wu(Y.type,Y.key,Y.props,null,W.mode,ye),ye.ref=Ha(W,B,Y),ye.return=W,ye)}function ae(W,B,Y,ye){return B===null||B.tag!==4||B.stateNode.containerInfo!==Y.containerInfo||B.stateNode.implementation!==Y.implementation?(B=Kd(Y,W.mode,ye),B.return=W,B):(B=m(B,Y.children||[]),B.return=W,B)}function Ee(W,B,Y,ye,Me){return B===null||B.tag!==7?(B=hs(Y,W.mode,ye,Me),B.return=W,B):(B=m(B,Y),B.return=W,B)}function He(W,B,Y){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Zd(""+B,W.mode,Y),B.return=W,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case g:return Y=wu(B.type,B.key,B.props,null,W.mode,Y),Y.ref=Ha(W,null,B),Y.return=W,Y;case f:return B=Kd(B,W.mode,Y),B.return=W,B;case z:var ye=B._init;return He(W,ye(B._payload),Y)}if(ce(B)||G(B))return B=hs(B,W.mode,Y,null),B.return=W,B;Gl(W,B)}return null}function ve(W,B,Y,ye){var Me=B!==null?B.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Me!==null?null:N(W,B,""+Y,ye);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case g:return Y.key===Me?Q(W,B,Y,ye):null;case f:return Y.key===Me?ae(W,B,Y,ye):null;case z:return Me=Y._init,ve(W,B,Me(Y._payload),ye)}if(ce(Y)||G(Y))return Me!==null?null:Ee(W,B,Y,ye,null);Gl(W,Y)}return null}function St(W,B,Y,ye,Me){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return W=W.get(Y)||null,N(B,W,""+ye,Me);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case g:return W=W.get(ye.key===null?Y:ye.key)||null,Q(B,W,ye,Me);case f:return W=W.get(ye.key===null?Y:ye.key)||null,ae(B,W,ye,Me);case z:var Ye=ye._init;return St(W,B,Y,Ye(ye._payload),Me)}if(ce(ye)||G(ye))return W=W.get(Y)||null,Ee(B,W,ye,Me,null);Gl(B,ye)}return null}function vt(W,B,Y,ye){for(var Me=null,Ye=null,qe=B,st=B=0,ai=null;qe!==null&&st<Y.length;st++){qe.index>st?(ai=qe,qe=null):ai=qe.sibling;var at=ve(W,qe,Y[st],ye);if(at===null){qe===null&&(qe=ai);break}s&&qe&&at.alternate===null&&a(W,qe),B=b(at,B,st),Ye===null?Me=at:Ye.sibling=at,Ye=at,qe=ai}if(st===Y.length)return c(W,qe),kt&&ns(W,st),Me;if(qe===null){for(;st<Y.length;st++)qe=He(W,Y[st],ye),qe!==null&&(B=b(qe,B,st),Ye===null?Me=qe:Ye.sibling=qe,Ye=qe);return kt&&ns(W,st),Me}for(qe=d(W,qe);st<Y.length;st++)ai=St(qe,W,st,Y[st],ye),ai!==null&&(s&&ai.alternate!==null&&qe.delete(ai.key===null?st:ai.key),B=b(ai,B,st),Ye===null?Me=ai:Ye.sibling=ai,Ye=ai);return s&&qe.forEach(function(Pn){return a(W,Pn)}),kt&&ns(W,st),Me}function Hi(W,B,Y,ye){var Me=G(Y);if(typeof Me!="function")throw Error(u(150));if(Y=Me.call(Y),Y==null)throw Error(u(151));for(var Ye=Me=null,qe=B,st=B=0,ai=null,at=Y.next();qe!==null&&!at.done;st++,at=Y.next()){qe.index>st?(ai=qe,qe=null):ai=qe.sibling;var Pn=ve(W,qe,at.value,ye);if(Pn===null){qe===null&&(qe=ai);break}s&&qe&&Pn.alternate===null&&a(W,qe),B=b(Pn,B,st),Ye===null?Me=Pn:Ye.sibling=Pn,Ye=Pn,qe=ai}if(at.done)return c(W,qe),kt&&ns(W,st),Me;if(qe===null){for(;!at.done;st++,at=Y.next())at=He(W,at.value,ye),at!==null&&(B=b(at,B,st),Ye===null?Me=at:Ye.sibling=at,Ye=at);return kt&&ns(W,st),Me}for(qe=d(W,qe);!at.done;st++,at=Y.next())at=St(qe,W,st,at.value,ye),at!==null&&(s&&at.alternate!==null&&qe.delete(at.key===null?st:at.key),B=b(at,B,st),Ye===null?Me=at:Ye.sibling=at,Ye=at);return s&&qe.forEach(function(JL){return a(W,JL)}),kt&&ns(W,st),Me}function en(W,B,Y,ye){if(typeof Y=="object"&&Y!==null&&Y.type===y&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case g:e:{for(var Me=Y.key,Ye=B;Ye!==null;){if(Ye.key===Me){if(Me=Y.type,Me===y){if(Ye.tag===7){c(W,Ye.sibling),B=m(Ye,Y.props.children),B.return=W,W=B;break e}}else if(Ye.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===z&&R0(Me)===Ye.type){c(W,Ye.sibling),B=m(Ye,Y.props),B.ref=Ha(W,Ye,Y),B.return=W,W=B;break e}c(W,Ye);break}else a(W,Ye);Ye=Ye.sibling}Y.type===y?(B=hs(Y.props.children,W.mode,ye,Y.key),B.return=W,W=B):(ye=wu(Y.type,Y.key,Y.props,null,W.mode,ye),ye.ref=Ha(W,B,Y),ye.return=W,W=ye)}return P(W);case f:e:{for(Ye=Y.key;B!==null;){if(B.key===Ye)if(B.tag===4&&B.stateNode.containerInfo===Y.containerInfo&&B.stateNode.implementation===Y.implementation){c(W,B.sibling),B=m(B,Y.children||[]),B.return=W,W=B;break e}else{c(W,B);break}else a(W,B);B=B.sibling}B=Kd(Y,W.mode,ye),B.return=W,W=B}return P(W);case z:return Ye=Y._init,en(W,B,Ye(Y._payload),ye)}if(ce(Y))return vt(W,B,Y,ye);if(G(Y))return Hi(W,B,Y,ye);Gl(W,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"?(Y=""+Y,B!==null&&B.tag===6?(c(W,B.sibling),B=m(B,Y),B.return=W,W=B):(c(W,B),B=Zd(Y,W.mode,ye),B.return=W,W=B),P(W)):c(W,B)}return en}var Js=L0(!0),O0=L0(!1),qa={},ir=bn(qa),Qa=bn(qa),ea=bn(qa);function Lr(s){if(s===qa)throw Error(u(174));return s}function dd(s,a){bt(ea,a),bt(Qa,s),bt(ir,qa),s=ee(a),_t(ir),bt(ir,s)}function ta(){_t(ir),_t(Qa),_t(ea)}function $0(s){var a=Lr(ea.current),c=Lr(ir.current);a=Pe(c,s.type,a),c!==a&&(bt(Qa,s),bt(ir,a))}function fd(s){Qa.current===s&&(_t(ir),_t(Qa))}var Lt=bn(0);function Yl(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||u0(c)||Dh(c)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var pd=[];function gd(){for(var s=0;s<pd.length;s++){var a=pd[s];Li?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}pd.length=0}var Xl=h.ReactCurrentDispatcher,md=h.ReactCurrentBatchConfig,as=0,Ot=null,Xt=null,ni=null,Zl=!1,Va=!1,Ga=0,EL=0;function Si(){throw Error(u(321))}function vd(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!fr(s[c],a[c]))return!1;return!0}function yd(s,a,c,d,m,b){if(as=b,Ot=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Xl.current=s===null||s.memoizedState===null?PL:TL,s=c(d,m),Va){b=0;do{if(Va=!1,Ga=0,25<=b)throw Error(u(301));b+=1,ni=Xt=null,a.updateQueue=null,Xl.current=IL,s=c(d,m)}while(Va)}if(Xl.current=eu,a=Xt!==null&&Xt.next!==null,as=0,ni=Xt=Ot=null,Zl=!1,a)throw Error(u(300));return s}function bd(){var s=Ga!==0;return Ga=0,s}function Or(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ni===null?Ot.memoizedState=ni=s:ni=ni.next=s,ni}function rr(){if(Xt===null){var s=Ot.alternate;s=s!==null?s.memoizedState:null}else s=Xt.next;var a=ni===null?Ot.memoizedState:ni.next;if(a!==null)ni=a,Xt=s;else{if(s===null)throw Error(u(310));Xt=s,s={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},ni===null?Ot.memoizedState=ni=s:ni=ni.next=s}return ni}function Ya(s,a){return typeof a=="function"?a(s):a}function wd(s){var a=rr(),c=a.queue;if(c===null)throw Error(u(311));c.lastRenderedReducer=s;var d=Xt,m=d.baseQueue,b=c.pending;if(b!==null){if(m!==null){var P=m.next;m.next=b.next,b.next=P}d.baseQueue=m=b,c.pending=null}if(m!==null){b=m.next,d=d.baseState;var N=P=null,Q=null,ae=b;do{var Ee=ae.lane;if((as&Ee)===Ee)Q!==null&&(Q=Q.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),d=ae.hasEagerState?ae.eagerState:s(d,ae.action);else{var He={lane:Ee,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};Q===null?(N=Q=He,P=d):Q=Q.next=He,Ot.lanes|=Ee,os|=Ee}ae=ae.next}while(ae!==null&&ae!==b);Q===null?P=d:Q.next=N,fr(d,a.memoizedState)||(Di=!0),a.memoizedState=d,a.baseState=P,a.baseQueue=Q,c.lastRenderedState=d}if(s=c.interleaved,s!==null){m=s;do b=m.lane,Ot.lanes|=b,os|=b,m=m.next;while(m!==s)}else m===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function xd(s){var a=rr(),c=a.queue;if(c===null)throw Error(u(311));c.lastRenderedReducer=s;var d=c.dispatch,m=c.pending,b=a.memoizedState;if(m!==null){c.pending=null;var P=m=m.next;do b=s(b,P.action),P=P.next;while(P!==m);fr(b,a.memoizedState)||(Di=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),c.lastRenderedState=b}return[b,d]}function F0(){}function M0(s,a){var c=Ot,d=rr(),m=a(),b=!fr(d.memoizedState,m);if(b&&(d.memoizedState=m,Di=!0),d=d.queue,_d(j0.bind(null,c,d,s),[s]),d.getSnapshot!==a||b||ni!==null&&ni.memoizedState.tag&1){if(c.flags|=2048,Xa(9,N0.bind(null,c,d,m,a),void 0,null),si===null)throw Error(u(349));(as&30)!==0||z0(c,a,m)}return m}function z0(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=Ot.updateQueue,a===null?(a={lastEffect:null,stores:null},Ot.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function N0(s,a,c,d){a.value=c,a.getSnapshot=d,B0(a)&&D0(s)}function j0(s,a,c){return c(function(){B0(a)&&D0(s)})}function B0(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!fr(s,c)}catch{return!0}}function D0(s){var a=Rr(s,1);a!==null&&nr(a,s,1,-1)}function U0(s){var a=Or();return typeof s=="function"&&(s=s()),a.memoizedState=a.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:s},a.queue=s,s=s.dispatch=AL.bind(null,Ot,s),[a.memoizedState,s]}function Xa(s,a,c,d){return s={tag:s,create:a,destroy:c,deps:d,next:null},a=Ot.updateQueue,a===null?(a={lastEffect:null,stores:null},Ot.updateQueue=a,a.lastEffect=s.next=s):(c=a.lastEffect,c===null?a.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,a.lastEffect=s)),s}function W0(){return rr().memoizedState}function Kl(s,a,c,d){var m=Or();Ot.flags|=s,m.memoizedState=Xa(1|a,c,void 0,d===void 0?null:d)}function Jl(s,a,c,d){var m=rr();d=d===void 0?null:d;var b=void 0;if(Xt!==null){var P=Xt.memoizedState;if(b=P.destroy,d!==null&&vd(d,P.deps)){m.memoizedState=Xa(a,c,b,d);return}}Ot.flags|=s,m.memoizedState=Xa(1|a,c,b,d)}function H0(s,a){return Kl(8390656,8,s,a)}function _d(s,a){return Jl(2048,8,s,a)}function q0(s,a){return Jl(4,2,s,a)}function Q0(s,a){return Jl(4,4,s,a)}function V0(s,a){if(typeof a=="function")return s=s(),a(s),function(){a(null)};if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function G0(s,a,c){return c=c!=null?c.concat([s]):null,Jl(4,4,V0.bind(null,a,s),c)}function Sd(){}function Y0(s,a){var c=rr();a=a===void 0?null:a;var d=c.memoizedState;return d!==null&&a!==null&&vd(a,d[1])?d[0]:(c.memoizedState=[s,a],s)}function X0(s,a){var c=rr();a=a===void 0?null:a;var d=c.memoizedState;return d!==null&&a!==null&&vd(a,d[1])?d[0]:(s=s(),c.memoizedState=[s,a],s)}function Z0(s,a,c){return(as&21)===0?(s.baseState&&(s.baseState=!1,Di=!0),s.memoizedState=c):(fr(c,a)||(c=f0(),Ot.lanes|=c,os|=c,s.baseState=!0),a)}function CL(s,a){var c=nt;nt=c!==0&&4>c?c:4,s(!0);var d=md.transition;md.transition={};try{s(!1),a()}finally{nt=c,md.transition=d}}function K0(){return rr().memoizedState}function kL(s,a,c){var d=Cn(s);if(c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null},J0(s))ew(a,c);else if(c=S0(s,a,c,d),c!==null){var m=ki();nr(c,s,d,m),tw(c,a,d)}}function AL(s,a,c){var d=Cn(s),m={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(J0(s))ew(a,m);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var P=a.lastRenderedState,N=b(P,c);if(m.hasEagerState=!0,m.eagerState=N,fr(N,P)){var Q=a.interleaved;Q===null?(m.next=m,ld(a)):(m.next=Q.next,Q.next=m),a.interleaved=m;return}}catch{}finally{}c=S0(s,a,m,d),c!==null&&(m=ki(),nr(c,s,d,m),tw(c,a,d))}}function J0(s){var a=s.alternate;return s===Ot||a!==null&&a===Ot}function ew(s,a){Va=Zl=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function tw(s,a,c){if((c&4194240)!==0){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,Gh(s,c)}}var eu={readContext:tr,useCallback:Si,useContext:Si,useEffect:Si,useImperativeHandle:Si,useInsertionEffect:Si,useLayoutEffect:Si,useMemo:Si,useReducer:Si,useRef:Si,useState:Si,useDebugValue:Si,useDeferredValue:Si,useTransition:Si,useMutableSource:Si,useSyncExternalStore:Si,useId:Si,unstable_isNewReconciler:!1},PL={readContext:tr,useCallback:function(s,a){return Or().memoizedState=[s,a===void 0?null:a],s},useContext:tr,useEffect:H0,useImperativeHandle:function(s,a,c){return c=c!=null?c.concat([s]):null,Kl(4194308,4,V0.bind(null,a,s),c)},useLayoutEffect:function(s,a){return Kl(4194308,4,s,a)},useInsertionEffect:function(s,a){return Kl(4,2,s,a)},useMemo:function(s,a){var c=Or();return a=a===void 0?null:a,s=s(),c.memoizedState=[s,a],s},useReducer:function(s,a,c){var d=Or();return a=c!==void 0?c(a):a,d.memoizedState=d.baseState=a,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:a},d.queue=s,s=s.dispatch=kL.bind(null,Ot,s),[d.memoizedState,s]},useRef:function(s){var a=Or();return s={current:s},a.memoizedState=s},useState:U0,useDebugValue:Sd,useDeferredValue:function(s){return Or().memoizedState=s},useTransition:function(){var s=U0(!1),a=s[0];return s=CL.bind(null,s[1]),Or().memoizedState=s,[a,s]},useMutableSource:function(){},useSyncExternalStore:function(s,a,c){var d=Ot,m=Or();if(kt){if(c===void 0)throw Error(u(407));c=c()}else{if(c=a(),si===null)throw Error(u(349));(as&30)!==0||z0(d,a,c)}m.memoizedState=c;var b={value:c,getSnapshot:a};return m.queue=b,H0(j0.bind(null,d,b,s),[s]),d.flags|=2048,Xa(9,N0.bind(null,d,b,c,a),void 0,null),c},useId:function(){var s=Or(),a=si.identifierPrefix;if(kt){var c=Xr,d=Yr;c=(d&~(1<<32-dr(d)-1)).toString(32)+c,a=":"+a+"R"+c,c=Ga++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=EL++,a=":"+a+"r"+c.toString(32)+":";return s.memoizedState=a},unstable_isNewReconciler:!1},TL={readContext:tr,useCallback:Y0,useContext:tr,useEffect:_d,useImperativeHandle:G0,useInsertionEffect:q0,useLayoutEffect:Q0,useMemo:X0,useReducer:wd,useRef:W0,useState:function(){return wd(Ya)},useDebugValue:Sd,useDeferredValue:function(s){var a=rr();return Z0(a,Xt.memoizedState,s)},useTransition:function(){var s=wd(Ya)[0],a=rr().memoizedState;return[s,a]},useMutableSource:F0,useSyncExternalStore:M0,useId:K0,unstable_isNewReconciler:!1},IL={readContext:tr,useCallback:Y0,useContext:tr,useEffect:_d,useImperativeHandle:G0,useInsertionEffect:q0,useLayoutEffect:Q0,useMemo:X0,useReducer:xd,useRef:W0,useState:function(){return xd(Ya)},useDebugValue:Sd,useDeferredValue:function(s){var a=rr();return Xt===null?a.memoizedState=s:Z0(a,Xt.memoizedState,s)},useTransition:function(){var s=xd(Ya)[0],a=rr().memoizedState;return[s,a]},useMutableSource:F0,useSyncExternalStore:M0,useId:K0,unstable_isNewReconciler:!1};function ia(s,a){try{var c="",d=a;do c+=SL(d),d=d.return;while(d);var m=c}catch(b){m=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:a,stack:m,digest:null}}function Ed(s,a,c){return{value:s,source:null,stack:c??null,digest:a??null}}function Cd(s,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var RL=typeof WeakMap=="function"?WeakMap:Map;function iw(s,a,c){c=Zr(-1,c),c.tag=3,c.payload={element:null};var d=a.value;return c.callback=function(){pu||(pu=!0,Hd=d),Cd(s,a)},c}function rw(s,a,c){c=Zr(-1,c),c.tag=3;var d=s.type.getDerivedStateFromError;if(typeof d=="function"){var m=a.value;c.payload=function(){return d(m)},c.callback=function(){Cd(s,a)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(c.callback=function(){Cd(s,a),typeof d!="function"&&(Sn===null?Sn=new Set([this]):Sn.add(this));var P=a.stack;this.componentDidCatch(a.value,{componentStack:P!==null?P:""})}),c}function nw(s,a,c){var d=s.pingCache;if(d===null){d=s.pingCache=new RL;var m=new Set;d.set(a,m)}else m=d.get(a),m===void 0&&(m=new Set,d.set(a,m));m.has(c)||(m.add(c),s=qL.bind(null,s,a,c),a.then(s,s))}function sw(s){do{var a;if((a=s.tag===13)&&(a=s.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return s;s=s.return}while(s!==null);return null}function aw(s,a,c,d,m){return(s.mode&1)===0?(s===a?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=Zr(-1,1),a.tag=2,_n(c,a,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=m,s)}var LL=h.ReactCurrentOwner,Di=!1;function $i(s,a,c,d){a.child=s===null?O0(a,null,c,d):Js(a,s.child,c,d)}function ow(s,a,c,d,m){c=c.render;var b=a.ref;return Ks(a,m),d=yd(s,a,c,d,b,m),c=bd(),s!==null&&!Di?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~m,Kr(s,a,m)):(kt&&c&&Jh(a),a.flags|=1,$i(s,a,d,m),a.child)}function lw(s,a,c,d,m){if(s===null){var b=c.type;return typeof b=="function"&&!Xd(b)&&b.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=b,uw(s,a,b,d,m)):(s=wu(c.type,null,d,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(b=s.child,(s.lanes&m)===0){var P=b.memoizedProps;if(c=c.compare,c=c!==null?c:Ul,c(P,d)&&s.ref===a.ref)return Kr(s,a,m)}return a.flags|=1,s=An(b,d),s.ref=a.ref,s.return=a,a.child=s}function uw(s,a,c,d,m){if(s!==null){var b=s.memoizedProps;if(Ul(b,d)&&s.ref===a.ref)if(Di=!1,a.pendingProps=d=b,(s.lanes&m)!==0)(s.flags&131072)!==0&&(Di=!0);else return a.lanes=s.lanes,Kr(s,a,m)}return kd(s,a,c,d,m)}function cw(s,a,c){var d=a.pendingProps,m=d.children,b=s!==null?s.memoizedState:null;if(d.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(na,Gi),Gi|=c;else{if((c&1073741824)===0)return s=b!==null?b.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:s,cachePool:null,transitions:null},a.updateQueue=null,bt(na,Gi),Gi|=s,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=b!==null?b.baseLanes:c,bt(na,Gi),Gi|=d}else b!==null?(d=b.baseLanes|c,a.memoizedState=null):d=c,bt(na,Gi),Gi|=d;return $i(s,a,m,c),a.child}function hw(s,a){var c=a.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function kd(s,a,c,d,m){var b=Bi(c)?is:_i.current;return b=Vs(a,b),Ks(a,m),c=yd(s,a,c,d,b,m),d=bd(),s!==null&&!Di?(a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~m,Kr(s,a,m)):(kt&&d&&Jh(a),a.flags|=1,$i(s,a,c,m),a.child)}function dw(s,a,c,d,m){if(Bi(c)){var b=!0;Ol(a)}else b=!1;if(Ks(a,m),a.stateNode===null)iu(s,a),T0(a,c,d),hd(a,c,d,m),d=!0;else if(s===null){var P=a.stateNode,N=a.memoizedProps;P.props=N;var Q=P.context,ae=c.contextType;typeof ae=="object"&&ae!==null?ae=tr(ae):(ae=Bi(c)?is:_i.current,ae=Vs(a,ae));var Ee=c.getDerivedStateFromProps,He=typeof Ee=="function"||typeof P.getSnapshotBeforeUpdate=="function";He||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(N!==d||Q!==ae)&&I0(a,P,d,ae),xn=!1;var ve=a.memoizedState;P.state=ve,Ql(a,d,P,m),Q=a.memoizedState,N!==d||ve!==Q||ji.current||xn?(typeof Ee=="function"&&(cd(a,c,Ee,d),Q=a.memoizedState),(N=xn||P0(a,c,N,d,ve,Q,ae))?(He||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(a.flags|=4194308)):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=Q),P.props=d,P.state=Q,P.context=ae,d=N):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{P=a.stateNode,E0(s,a),N=a.memoizedProps,ae=a.type===a.elementType?N:gr(a.type,N),P.props=ae,He=a.pendingProps,ve=P.context,Q=c.contextType,typeof Q=="object"&&Q!==null?Q=tr(Q):(Q=Bi(c)?is:_i.current,Q=Vs(a,Q));var St=c.getDerivedStateFromProps;(Ee=typeof St=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(N!==He||ve!==Q)&&I0(a,P,d,Q),xn=!1,ve=a.memoizedState,P.state=ve,Ql(a,d,P,m);var vt=a.memoizedState;N!==He||ve!==vt||ji.current||xn?(typeof St=="function"&&(cd(a,c,St,d),vt=a.memoizedState),(ae=xn||P0(a,c,ae,d,ve,vt,Q)||!1)?(Ee||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(d,vt,Q),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(d,vt,Q)),typeof P.componentDidUpdate=="function"&&(a.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof P.componentDidUpdate!="function"||N===s.memoizedProps&&ve===s.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ve===s.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=vt),P.props=d,P.state=vt,P.context=Q,d=ae):(typeof P.componentDidUpdate!="function"||N===s.memoizedProps&&ve===s.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ve===s.memoizedState||(a.flags|=1024),d=!1)}return Ad(s,a,c,d,b,m)}function Ad(s,a,c,d,m,b){hw(s,a);var P=(a.flags&128)!==0;if(!d&&!P)return m&&d0(a,c,!1),Kr(s,a,b);d=a.stateNode,LL.current=a;var N=P&&typeof c.getDerivedStateFromError!="function"?null:d.render();return a.flags|=1,s!==null&&P?(a.child=Js(a,s.child,null,b),a.child=Js(a,null,N,b)):$i(s,a,N,b),a.memoizedState=d.state,m&&d0(a,c,!0),a.child}function fw(s){var a=s.stateNode;a.pendingContext?c0(s,a.pendingContext,a.pendingContext!==a.context):a.context&&c0(s,a.context,!1),dd(s,a.containerInfo)}function pw(s,a,c,d,m){return Xs(),rd(m),a.flags|=256,$i(s,a,c,d),a.child}var Pd={dehydrated:null,treeContext:null,retryLane:0};function Td(s){return{baseLanes:s,cachePool:null,transitions:null}}function gw(s,a,c){var d=a.pendingProps,m=Lt.current,b=!1,P=(a.flags&128)!==0,N;if((N=P)||(N=s!==null&&s.memoizedState===null?!1:(m&2)!==0),N?(b=!0,a.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),bt(Lt,m&1),s===null)return id(a),s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((a.mode&1)===0?a.lanes=1:Dh(s)?a.lanes=8:a.lanes=1073741824,null):(P=d.children,s=d.fallback,b?(d=a.mode,b=a.child,P={mode:"hidden",children:P},(d&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=P):b=xu(P,d,0,null),s=hs(s,d,c,null),b.return=a,s.return=a,b.sibling=s,a.child=b,a.child.memoizedState=Td(c),a.memoizedState=Pd,s):Id(a,P));if(m=s.memoizedState,m!==null&&(N=m.dehydrated,N!==null))return OL(s,a,P,d,N,m,c);if(b){b=d.fallback,P=a.mode,m=s.child,N=m.sibling;var Q={mode:"hidden",children:d.children};return(P&1)===0&&a.child!==m?(d=a.child,d.childLanes=0,d.pendingProps=Q,a.deletions=null):(d=An(m,Q),d.subtreeFlags=m.subtreeFlags&14680064),N!==null?b=An(N,b):(b=hs(b,P,c,null),b.flags|=2),b.return=a,d.return=a,d.sibling=b,a.child=d,d=b,b=a.child,P=s.child.memoizedState,P=P===null?Td(c):{baseLanes:P.baseLanes|c,cachePool:null,transitions:P.transitions},b.memoizedState=P,b.childLanes=s.childLanes&~c,a.memoizedState=Pd,d}return b=s.child,s=b.sibling,d=An(b,{mode:"visible",children:d.children}),(a.mode&1)===0&&(d.lanes=c),d.return=a,d.sibling=null,s!==null&&(c=a.deletions,c===null?(a.deletions=[s],a.flags|=16):c.push(s)),a.child=d,a.memoizedState=null,d}function Id(s,a){return a=xu({mode:"visible",children:a},s.mode,0,null),a.return=s,s.child=a}function tu(s,a,c,d){return d!==null&&rd(d),Js(a,s.child,null,c),s=Id(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function OL(s,a,c,d,m,b,P){if(c)return a.flags&256?(a.flags&=-257,d=Ed(Error(u(422))),tu(s,a,P,d)):a.memoizedState!==null?(a.child=s.child,a.flags|=128,null):(b=d.fallback,m=a.mode,d=xu({mode:"visible",children:d.children},m,0,null),b=hs(b,m,P,null),b.flags|=2,d.return=a,b.return=a,d.sibling=b,a.child=d,(a.mode&1)!==0&&Js(a,s.child,null,P),a.child.memoizedState=Td(P),a.memoizedState=Pd,b);if((a.mode&1)===0)return tu(s,a,P,null);if(Dh(m))return d=QR(m).digest,b=Error(u(419)),d=Ed(b,d,void 0),tu(s,a,P,d);if(c=(P&s.childLanes)!==0,Di||c){if(d=si,d!==null){switch(P&-P){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|P))!==0?0:m,m!==0&&m!==b.retryLane&&(b.retryLane=m,Rr(s,m),nr(d,s,m,-1))}return Yd(),d=Ed(Error(u(421))),tu(s,a,P,d)}return u0(m)?(a.flags|=128,a.child=s.child,a=QL.bind(null,s),VR(m,a),null):(s=b.treeContext,Wt&&(er=XR(m),Vi=a,kt=!0,pr=null,Wa=!1,s!==null&&(Ki[Ji++]=Yr,Ki[Ji++]=Xr,Ki[Ji++]=rs,Yr=s.id,Xr=s.overflow,rs=a)),a=Id(a,d.children),a.flags|=4096,a)}function mw(s,a,c){s.lanes|=a;var d=s.alternate;d!==null&&(d.lanes|=a),od(s.return,a,c)}function Rd(s,a,c,d,m){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:m}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=c,b.tailMode=m)}function vw(s,a,c){var d=a.pendingProps,m=d.revealOrder,b=d.tail;if($i(s,a,d.children,c),d=Lt.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&mw(s,c,a);else if(s.tag===19)mw(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}if(bt(Lt,d),(a.mode&1)===0)a.memoizedState=null;else switch(m){case"forwards":for(c=a.child,m=null;c!==null;)s=c.alternate,s!==null&&Yl(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=a.child,a.child=null):(m=c.sibling,c.sibling=null),Rd(a,!1,m,c,b);break;case"backwards":for(c=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&Yl(s)===null){a.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}Rd(a,!0,c,null,b);break;case"together":Rd(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function iu(s,a){(a.mode&1)===0&&s!==null&&(s.alternate=null,a.alternate=null,a.flags|=2)}function Kr(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),os|=a.lanes,(c&a.childLanes)===0)return null;if(s!==null&&a.child!==s.child)throw Error(u(153));if(a.child!==null){for(s=a.child,c=An(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=An(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function $L(s,a,c){switch(a.tag){case 3:fw(a),Xs();break;case 5:$0(a);break;case 1:Bi(a.type)&&Ol(a);break;case 4:dd(a,a.stateNode.containerInfo);break;case 10:_0(a,a.type._context,a.memoizedProps.value);break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(bt(Lt,Lt.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?gw(s,a,c):(bt(Lt,Lt.current&1),s=Kr(s,a,c),s!==null?s.sibling:null);bt(Lt,Lt.current&1);break;case 19:if(d=(c&a.childLanes)!==0,(s.flags&128)!==0){if(d)return vw(s,a,c);a.flags|=128}var m=a.memoizedState;if(m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),bt(Lt,Lt.current),d)break;return null;case 22:case 23:return a.lanes=0,cw(s,a,c)}return Kr(s,a,c)}function $r(s){s.flags|=4}function yw(s,a){if(s!==null&&s.child===a.child)return!0;if((a.flags&16)!==0)return!1;for(s=a.child;s!==null;){if((s.flags&12854)!==0||(s.subtreeFlags&12854)!==0)return!1;s=s.sibling}return!0}var Za,Ka,ru,nu;if(jt)Za=function(s,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)K(s,c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Ka=function(){},ru=function(s,a,c,d,m){if(s=s.memoizedProps,s!==d){var b=a.stateNode,P=Lr(ir.current);c=dt(b,c,s,d,m,P),(a.updateQueue=c)&&$r(a)}},nu=function(s,a,c,d){c!==d&&$r(a)};else if(Zi){Za=function(s,a,c,d){for(var m=a.child;m!==null;){if(m.tag===5){var b=m.stateNode;c&&d&&(b=o0(b,m.type,m.memoizedProps,m)),K(s,b)}else if(m.tag===6)b=m.stateNode,c&&d&&(b=l0(b,m.memoizedProps,m)),K(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),Za(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===a)break;for(;m.sibling===null;){if(m.return===null||m.return===a)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};var bw=function(s,a,c,d){for(var m=a.child;m!==null;){if(m.tag===5){var b=m.stateNode;c&&d&&(b=o0(b,m.type,m.memoizedProps,m)),a0(s,b)}else if(m.tag===6)b=m.stateNode,c&&d&&(b=l0(b,m.memoizedProps,m)),a0(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),bw(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===a)break;for(;m.sibling===null;){if(m.return===null||m.return===a)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};Ka=function(s,a){var c=a.stateNode;if(!yw(s,a)){s=c.containerInfo;var d=ja(s);bw(d,a,!1,!1),c.pendingChildren=d,$r(a),UR(s,d)}},ru=function(s,a,c,d,m){var b=s.stateNode,P=s.memoizedProps;if((s=yw(s,a))&&P===d)a.stateNode=b;else{var N=a.stateNode,Q=Lr(ir.current),ae=null;P!==d&&(ae=dt(N,c,P,d,m,Q)),s&&ae===null?a.stateNode=b:(b=Pr(b,ae,c,P,d,a,s,N),Ce(b,c,d,m,Q)&&$r(a),a.stateNode=b,s?$r(a):Za(b,a,!1,!1))}},nu=function(s,a,c,d){c!==d?(s=Lr(ea.current),c=Lr(ir.current),a.stateNode=Et(d,s,c,a),$r(a)):a.stateNode=s.stateNode}}else Ka=function(){},ru=function(){},nu=function(){};function Ja(s,a){if(!kt)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Ei(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(a)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=d,s.childLanes=c,a}function FL(s,a,c){var d=a.pendingProps;switch(ed(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(a),null;case 1:return Bi(a.type)&&Ll(),Ei(a),null;case 3:return c=a.stateNode,ta(),_t(ji),_t(_i),gd(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Dl(a)?$r(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,pr!==null&&(Vd(pr),pr=null))),Ka(s,a),Ei(a),null;case 5:fd(a),c=Lr(ea.current);var m=a.type;if(s!==null&&a.stateNode!=null)ru(s,a,m,d,c),s.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!d){if(a.stateNode===null)throw Error(u(166));return Ei(a),null}if(s=Lr(ir.current),Dl(a)){if(!Wt)throw Error(u(175));s=ZR(a.stateNode,a.type,a.memoizedProps,c,s,a,!Wa),a.updateQueue=s,s!==null&&$r(a)}else{var b=ut(m,d,c,s,a);Za(b,a,!1,!1),a.stateNode=b,Ce(b,m,d,c,s)&&$r(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Ei(a),null;case 6:if(s&&a.stateNode!=null)nu(s,a,s.memoizedProps,d);else{if(typeof d!="string"&&a.stateNode===null)throw Error(u(166));if(s=Lr(ea.current),c=Lr(ir.current),Dl(a)){if(!Wt)throw Error(u(176));if(s=a.stateNode,c=a.memoizedProps,(d=KR(s,c,a,!Wa))&&(m=Vi,m!==null))switch(m.tag){case 3:aL(m.stateNode.containerInfo,s,c,(m.mode&1)!==0);break;case 5:oL(m.type,m.memoizedProps,m.stateNode,s,c,(m.mode&1)!==0)}d&&$r(a)}else a.stateNode=Et(d,s,c,a)}return Ei(a),null;case 13:if(_t(Lt),d=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(kt&&er!==null&&(a.mode&1)!==0&&(a.flags&128)===0)x0(),Xs(),a.flags|=98560,m=!1;else if(m=Dl(a),d!==null&&d.dehydrated!==null){if(s===null){if(!m)throw Error(u(318));if(!Wt)throw Error(u(344));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(u(317));JR(m,a)}else Xs(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ei(a),m=!1}else pr!==null&&(Vd(pr),pr=null),m=!0;if(!m)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(c=d!==null,c!==(s!==null&&s.memoizedState!==null)&&c&&(a.child.flags|=8192,(a.mode&1)!==0&&(s===null||(Lt.current&1)!==0?Zt===0&&(Zt=3):Yd())),a.updateQueue!==null&&(a.flags|=4),Ei(a),null);case 4:return ta(),Ka(s,a),s===null&&Vr(a.stateNode.containerInfo),Ei(a),null;case 10:return ad(a.type._context),Ei(a),null;case 17:return Bi(a.type)&&Ll(),Ei(a),null;case 19:if(_t(Lt),m=a.memoizedState,m===null)return Ei(a),null;if(d=(a.flags&128)!==0,b=m.rendering,b===null)if(d)Ja(m,!1);else{if(Zt!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(b=Yl(s),b!==null){for(a.flags|=128,Ja(m,!1),s=b.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),a.subtreeFlags=0,s=c,c=a.child;c!==null;)d=c,m=s,d.flags&=14680066,b=d.alternate,b===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=b.childLanes,d.lanes=b.lanes,d.child=b.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=b.memoizedProps,d.memoizedState=b.memoizedState,d.updateQueue=b.updateQueue,d.type=b.type,m=b.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),c=c.sibling;return bt(Lt,Lt.current&1|2),a.child}s=s.sibling}m.tail!==null&&ri()>Wd&&(a.flags|=128,d=!0,Ja(m,!1),a.lanes=4194304)}else{if(!d)if(s=Yl(b),s!==null){if(a.flags|=128,d=!0,s=s.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),Ja(m,!0),m.tail===null&&m.tailMode==="hidden"&&!b.alternate&&!kt)return Ei(a),null}else 2*ri()-m.renderingStartTime>Wd&&c!==1073741824&&(a.flags|=128,d=!0,Ja(m,!1),a.lanes=4194304);m.isBackwards?(b.sibling=a.child,a.child=b):(s=m.last,s!==null?s.sibling=b:a.child=b,m.last=b)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=ri(),a.sibling=null,s=Lt.current,bt(Lt,d?s&1|2:s&1),a):(Ei(a),null);case 22:case 23:return Gd(),c=a.memoizedState!==null,s!==null&&s.memoizedState!==null!==c&&(a.flags|=8192),c&&(a.mode&1)!==0?(Gi&1073741824)!==0&&(Ei(a),jt&&a.subtreeFlags&6&&(a.flags|=8192)):Ei(a),null;case 24:return null;case 25:return null}throw Error(u(156,a.tag))}function ML(s,a){switch(ed(a),a.tag){case 1:return Bi(a.type)&&Ll(),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return ta(),_t(ji),_t(_i),gd(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 5:return fd(a),null;case 13:if(_t(Lt),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(u(340));Xs()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return _t(Lt),null;case 4:return ta(),null;case 10:return ad(a.type._context),null;case 22:case 23:return Gd(),null;case 24:return null;default:return null}}var su=!1,Ci=!1,zL=typeof WeakSet=="function"?WeakSet:Set,_e=null;function ra(s,a){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(d){At(s,a,d)}else c.current=null}function ww(s,a,c){try{c()}catch(d){At(s,a,d)}}var xw=!1;function NL(s,a){for(Oe(s.containerInfo),_e=a;_e!==null;)if(s=_e,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,_e=a;else for(;_e!==null;){s=_e;try{var c=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(c!==null){var d=c.memoizedProps,m=c.memoizedState,b=s.stateNode,P=b.getSnapshotBeforeUpdate(s.elementType===s.type?d:gr(s.type,d),m);b.__reactInternalSnapshotBeforeUpdate=P}break;case 3:jt&&lt(s.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(N){At(s,s.return,N)}if(a=s.sibling,a!==null){a.return=s.return,_e=a;break}_e=s.return}return c=xw,xw=!1,c}function eo(s,a,c){var d=a.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&s)===s){var b=m.destroy;m.destroy=void 0,b!==void 0&&ww(a,c,b)}m=m.next}while(m!==d)}}function au(s,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&s)===s){var d=c.create;c.destroy=d()}c=c.next}while(c!==a)}}function Ld(s){var a=s.ref;if(a!==null){var c=s.stateNode;switch(s.tag){case 5:s=We(c);break;default:s=c}typeof a=="function"?a(s):a.current=s}}function _w(s){var a=s.alternate;a!==null&&(s.alternate=null,_w(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&xe(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Sw(s){return s.tag===5||s.tag===3||s.tag===4}function Ew(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Sw(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Od(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?Ne(c,s,a):za(c,s);else if(d!==4&&(s=s.child,s!==null))for(Od(s,a,c),s=s.sibling;s!==null;)Od(s,a,c),s=s.sibling}function $d(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?be(c,s,a):jh(c,s);else if(d!==4&&(s=s.child,s!==null))for($d(s,a,c),s=s.sibling;s!==null;)$d(s,a,c),s=s.sibling}var fi=null,mr=!1;function Fr(s,a,c){for(c=c.child;c!==null;)Fd(s,a,c),c=c.sibling}function Fd(s,a,c){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(zl,c)}catch{}switch(c.tag){case 5:Ci||ra(c,a);case 6:if(jt){var d=fi,m=mr;fi=null,Fr(s,a,c),fi=d,mr=m,fi!==null&&(mr?Bt(fi,c.stateNode):gt(fi,c.stateNode))}else Fr(s,a,c);break;case 18:jt&&fi!==null&&(mr?nL(fi,c.stateNode):rL(fi,c.stateNode));break;case 4:jt?(d=fi,m=mr,fi=c.stateNode.containerInfo,mr=!0,Fr(s,a,c),fi=d,mr=m):(Zi&&(d=c.stateNode.containerInfo,m=ja(d),Bh(d,m)),Fr(s,a,c));break;case 0:case 11:case 14:case 15:if(!Ci&&(d=c.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var b=m,P=b.destroy;b=b.tag,P!==void 0&&((b&2)!==0||(b&4)!==0)&&ww(c,a,P),m=m.next}while(m!==d)}Fr(s,a,c);break;case 1:if(!Ci&&(ra(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(N){At(c,a,N)}Fr(s,a,c);break;case 21:Fr(s,a,c);break;case 22:c.mode&1?(Ci=(d=Ci)||c.memoizedState!==null,Fr(s,a,c),Ci=d):Fr(s,a,c);break;default:Fr(s,a,c)}}function Cw(s){var a=s.updateQueue;if(a!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new zL),a.forEach(function(d){var m=VL.bind(null,s,d);c.has(d)||(c.add(d),d.then(m,m))})}}function vr(s,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var m=c[d];try{var b=s,P=a;if(jt){var N=P;e:for(;N!==null;){switch(N.tag){case 5:fi=N.stateNode,mr=!1;break e;case 3:fi=N.stateNode.containerInfo,mr=!0;break e;case 4:fi=N.stateNode.containerInfo,mr=!0;break e}N=N.return}if(fi===null)throw Error(u(160));Fd(b,P,m),fi=null,mr=!1}else Fd(b,P,m);var Q=m.alternate;Q!==null&&(Q.return=null),m.return=null}catch(ae){At(m,a,ae)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)kw(a,s),a=a.sibling}function kw(s,a){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(vr(a,s),Mr(s),d&4){try{eo(3,s,s.return),au(3,s)}catch(ve){At(s,s.return,ve)}try{eo(5,s,s.return)}catch(ve){At(s,s.return,ve)}}break;case 1:vr(a,s),Mr(s),d&512&&c!==null&&ra(c,c.return);break;case 5:if(vr(a,s),Mr(s),d&512&&c!==null&&ra(c,c.return),jt){if(s.flags&32){var m=s.stateNode;try{Ht(m)}catch(ve){At(s,s.return,ve)}}if(d&4&&(m=s.stateNode,m!=null)){var b=s.memoizedProps;if(c=c!==null?c.memoizedProps:b,d=s.type,a=s.updateQueue,s.updateQueue=null,a!==null)try{Il(m,a,d,c,b,s)}catch(ve){At(s,s.return,ve)}}}break;case 6:if(vr(a,s),Mr(s),d&4&&jt){if(s.stateNode===null)throw Error(u(162));m=s.stateNode,b=s.memoizedProps,c=c!==null?c.memoizedProps:b;try{qs(m,c,b)}catch(ve){At(s,s.return,ve)}}break;case 3:if(vr(a,s),Mr(s),d&4){if(jt&&Wt&&c!==null&&c.memoizedState.isDehydrated)try{tL(a.containerInfo)}catch(ve){At(s,s.return,ve)}if(Zi){m=a.containerInfo,b=a.pendingChildren;try{Bh(m,b)}catch(ve){At(s,s.return,ve)}}}break;case 4:if(vr(a,s),Mr(s),d&4&&Zi){b=s.stateNode,m=b.containerInfo,b=b.pendingChildren;try{Bh(m,b)}catch(ve){At(s,s.return,ve)}}break;case 13:vr(a,s),Mr(s),m=s.child,m.flags&8192&&(b=m.memoizedState!==null,m.stateNode.isHidden=b,!b||m.alternate!==null&&m.alternate.memoizedState!==null||(Ud=ri())),d&4&&Cw(s);break;case 22:var P=c!==null&&c.memoizedState!==null;if(s.mode&1?(Ci=(c=Ci)||P,vr(a,s),Ci=c):vr(a,s),Mr(s),d&8192){if(c=s.memoizedState!==null,(s.stateNode.isHidden=c)&&!P&&(s.mode&1)!==0)for(_e=s,d=s.child;d!==null;){for(a=_e=d;_e!==null;){P=_e;var N=P.child;switch(P.tag){case 0:case 11:case 14:case 15:eo(4,P,P.return);break;case 1:ra(P,P.return);var Q=P.stateNode;if(typeof Q.componentWillUnmount=="function"){var ae=P,Ee=P.return;try{var He=ae;Q.props=He.memoizedProps,Q.state=He.memoizedState,Q.componentWillUnmount()}catch(ve){At(ae,Ee,ve)}}break;case 5:ra(P,P.return);break;case 22:if(P.memoizedState!==null){Tw(a);continue}}N!==null?(N.return=P,_e=N):Tw(a)}d=d.sibling}if(jt){e:if(d=null,jt)for(a=s;;){if(a.tag===5){if(d===null){d=a;try{m=a.stateNode,c?ie(m):et(a.stateNode,a.memoizedProps)}catch(ve){At(s,s.return,ve)}}}else if(a.tag===6){if(d===null)try{b=a.stateNode,c?Ie(b):xt(b,a.memoizedProps)}catch(ve){At(s,s.return,ve)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;d===a&&(d=null),a=a.return}d===a&&(d=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:vr(a,s),Mr(s),d&4&&Cw(s);break;case 21:break;default:vr(a,s),Mr(s)}}function Mr(s){var a=s.flags;if(a&2){try{if(jt){e:{for(var c=s.return;c!==null;){if(Sw(c)){var d=c;break e}c=c.return}throw Error(u(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(Ht(m),d.flags&=-33);var b=Ew(s);$d(s,b,m);break;case 3:case 4:var P=d.stateNode.containerInfo,N=Ew(s);Od(s,N,P);break;default:throw Error(u(161))}}}catch(Q){At(s,s.return,Q)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function jL(s,a,c){_e=s,Aw(s)}function Aw(s,a,c){for(var d=(s.mode&1)!==0;_e!==null;){var m=_e,b=m.child;if(m.tag===22&&d){var P=m.memoizedState!==null||su;if(!P){var N=m.alternate,Q=N!==null&&N.memoizedState!==null||Ci;N=su;var ae=Ci;if(su=P,(Ci=Q)&&!ae)for(_e=m;_e!==null;)P=_e,Q=P.child,P.tag===22&&P.memoizedState!==null?Iw(m):Q!==null?(Q.return=P,_e=Q):Iw(m);for(;b!==null;)_e=b,Aw(b),b=b.sibling;_e=m,su=N,Ci=ae}Pw(s)}else(m.subtreeFlags&8772)!==0&&b!==null?(b.return=m,_e=b):Pw(s)}}function Pw(s){for(;_e!==null;){var a=_e;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Ci||au(5,a);break;case 1:var d=a.stateNode;if(a.flags&4&&!Ci)if(c===null)d.componentDidMount();else{var m=a.elementType===a.type?c.memoizedProps:gr(a.type,c.memoizedProps);d.componentDidUpdate(m,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var b=a.updateQueue;b!==null&&k0(a,b,d);break;case 3:var P=a.updateQueue;if(P!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=We(a.child.stateNode);break;case 1:c=a.child.stateNode}k0(a,P,c)}break;case 5:var N=a.stateNode;c===null&&a.flags&4&&Na(N,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(Wt&&a.memoizedState===null){var Q=a.alternate;if(Q!==null){var ae=Q.memoizedState;if(ae!==null){var Ee=ae.dehydrated;Ee!==null&&iL(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}Ci||a.flags&512&&Ld(a)}catch(He){At(a,a.return,He)}}if(a===s){_e=null;break}if(c=a.sibling,c!==null){c.return=a.return,_e=c;break}_e=a.return}}function Tw(s){for(;_e!==null;){var a=_e;if(a===s){_e=null;break}var c=a.sibling;if(c!==null){c.return=a.return,_e=c;break}_e=a.return}}function Iw(s){for(;_e!==null;){var a=_e;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{au(4,a)}catch(Q){At(a,c,Q)}break;case 1:var d=a.stateNode;if(typeof d.componentDidMount=="function"){var m=a.return;try{d.componentDidMount()}catch(Q){At(a,m,Q)}}var b=a.return;try{Ld(a)}catch(Q){At(a,b,Q)}break;case 5:var P=a.return;try{Ld(a)}catch(Q){At(a,P,Q)}}}catch(Q){At(a,a.return,Q)}if(a===s){_e=null;break}var N=a.sibling;if(N!==null){N.return=a.return,_e=N;break}_e=a.return}}var ou=0,lu=1,uu=2,cu=3,hu=4;if(typeof Symbol=="function"&&Symbol.for){var to=Symbol.for;ou=to("selector.component"),lu=to("selector.has_pseudo_class"),uu=to("selector.role"),cu=to("selector.test_id"),hu=to("selector.text")}function Md(s){var a=Qr(s);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(u(364));return a}if(s=ii(s),s===null)throw Error(u(362));return s.stateNode.current}function zd(s,a){switch(a.$$typeof){case ou:if(s.type===a.value)return!0;break;case lu:e:{a=a.value,s=[s,0];for(var c=0;c<s.length;){var d=s[c++],m=s[c++],b=a[m];if(d.tag!==5||!ts(d)){for(;b!=null&&zd(d,b);)m++,b=a[m];if(m===a.length){a=!0;break e}else for(d=d.child;d!==null;)s.push(d,m),d=d.sibling}}a=!1}return a;case uu:if(s.tag===5&&Ni(s.stateNode,a.value))return!0;break;case hu:if((s.tag===5||s.tag===6)&&(s=zh(s),s!==null&&0<=s.indexOf(a.value)))return!0;break;case cu:if(s.tag===5&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(u(365))}return!1}function Nd(s){switch(s.$$typeof){case ou:return"<"+(V(s.value)||"Unknown")+">";case lu:return":has("+(Nd(s)||"")+")";case uu:return'[role="'+s.value+'"]';case hu:return'"'+s.value+'"';case cu:return'[data-testname="'+s.value+'"]';default:throw Error(u(365))}}function Rw(s,a){var c=[];s=[s,0];for(var d=0;d<s.length;){var m=s[d++],b=s[d++],P=a[b];if(m.tag!==5||!ts(m)){for(;P!=null&&zd(m,P);)b++,P=a[b];if(b===a.length)c.push(m);else for(m=m.child;m!==null;)s.push(m,b),m=m.sibling}}return c}function jd(s,a){if(!Ct)throw Error(u(363));s=Md(s),s=Rw(s,a),a=[],s=Array.from(s);for(var c=0;c<s.length;){var d=s[c++];if(d.tag===5)ts(d)||a.push(d.stateNode);else for(d=d.child;d!==null;)s.push(d),d=d.sibling}return a}var BL=Math.ceil,du=h.ReactCurrentDispatcher,Bd=h.ReactCurrentOwner,qt=h.ReactCurrentBatchConfig,Ze=0,si=null,Vt=null,pi=0,Gi=0,na=bn(0),Zt=0,io=null,os=0,fu=0,Dd=0,ro=null,Ui=null,Ud=0,Wd=1/0,Jr=null;function sa(){Wd=ri()+500}var pu=!1,Hd=null,Sn=null,gu=!1,En=null,mu=0,no=0,qd=null,vu=-1,yu=0;function ki(){return(Ze&6)!==0?ri():vu!==-1?vu:vu=ri()}function Cn(s){return(s.mode&1)===0?1:(Ze&2)!==0&&pi!==0?pi&-pi:_L.transition!==null?(yu===0&&(yu=f0()),yu):(s=nt,s!==0?s:ue())}function nr(s,a,c,d){if(50<no)throw no=0,qd=null,Error(u(185));Ua(s,c,d),((Ze&2)===0||s!==si)&&(s===si&&((Ze&2)===0&&(fu|=c),Zt===4&&kn(s,pi)),Wi(s,d),c===1&&Ze===0&&(a.mode&1)===0&&(sa(),Nl&&Ir()))}function Wi(s,a){var c=s.callbackNode;fL(s,a);var d=Ml(s,s===si?pi:0);if(d===0)c!==null&&g0(c),s.callbackNode=null,s.callbackPriority=0;else if(a=d&-d,s.callbackPriority!==a){if(c!=null&&g0(c),a===1)s.tag===0?xL(Ow.bind(null,s)):m0(Ow.bind(null,s)),Fe?rt(function(){(Ze&6)===0&&Ir()}):Yh(Xh,Ir),c=null;else{switch(p0(d)){case 1:c=Xh;break;case 4:c=vL;break;case 16:c=Zh;break;case 536870912:c=yL;break;default:c=Zh}c=Uw(c,Lw.bind(null,s))}s.callbackPriority=a,s.callbackNode=c}}function Lw(s,a){if(vu=-1,yu=0,(Ze&6)!==0)throw Error(u(327));var c=s.callbackNode;if(cs()&&s.callbackNode!==c)return null;var d=Ml(s,s===si?pi:0);if(d===0)return null;if((d&30)!==0||(d&s.expiredLanes)!==0||a)a=bu(s,d);else{a=d;var m=Ze;Ze|=2;var b=Mw();(si!==s||pi!==a)&&(Jr=null,sa(),ls(s,a));do try{WL();break}catch(N){Fw(s,N)}while(!0);sd(),du.current=b,Ze=m,Vt!==null?a=0:(si=null,pi=0,a=Zt)}if(a!==0){if(a===2&&(m=Qh(s),m!==0&&(d=m,a=Qd(s,m))),a===1)throw c=io,ls(s,0),kn(s,d),Wi(s,ri()),c;if(a===6)kn(s,d);else{if(m=s.current.alternate,(d&30)===0&&!DL(m)&&(a=bu(s,d),a===2&&(b=Qh(s),b!==0&&(d=b,a=Qd(s,b))),a===1))throw c=io,ls(s,0),kn(s,d),Wi(s,ri()),c;switch(s.finishedWork=m,s.finishedLanes=d,a){case 0:case 1:throw Error(u(345));case 2:us(s,Ui,Jr);break;case 3:if(kn(s,d),(d&130023424)===d&&(a=Ud+500-ri(),10<a)){if(Ml(s,0)!==0)break;if(m=s.suspendedLanes,(m&d)!==d){ki(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Ri(us.bind(null,s,Ui,Jr),a);break}us(s,Ui,Jr);break;case 4:if(kn(s,d),(d&4194240)===d)break;for(a=s.eventTimes,m=-1;0<d;){var P=31-dr(d);b=1<<P,P=a[P],P>m&&(m=P),d&=~b}if(d=m,d=ri()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*BL(d/1960))-d,10<d){s.timeoutHandle=Ri(us.bind(null,s,Ui,Jr),d);break}us(s,Ui,Jr);break;case 5:us(s,Ui,Jr);break;default:throw Error(u(329))}}}return Wi(s,ri()),s.callbackNode===c?Lw.bind(null,s):null}function Qd(s,a){var c=ro;return s.current.memoizedState.isDehydrated&&(ls(s,a).flags|=256),s=bu(s,a),s!==2&&(a=Ui,Ui=c,a!==null&&Vd(a)),s}function Vd(s){Ui===null?Ui=s:Ui.push.apply(Ui,s)}function DL(s){for(var a=s;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var d=0;d<c.length;d++){var m=c[d],b=m.getSnapshot;m=m.value;try{if(!fr(b(),m))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function kn(s,a){for(a&=~Dd,a&=~fu,s.suspendedLanes|=a,s.pingedLanes&=~a,s=s.expirationTimes;0<a;){var c=31-dr(a),d=1<<c;s[c]=-1,a&=~d}}function Ow(s){if((Ze&6)!==0)throw Error(u(327));cs();var a=Ml(s,0);if((a&1)===0)return Wi(s,ri()),null;var c=bu(s,a);if(s.tag!==0&&c===2){var d=Qh(s);d!==0&&(a=d,c=Qd(s,d))}if(c===1)throw c=io,ls(s,0),kn(s,a),Wi(s,ri()),c;if(c===6)throw Error(u(345));return s.finishedWork=s.current.alternate,s.finishedLanes=a,us(s,Ui,Jr),Wi(s,ri()),null}function $w(s){En!==null&&En.tag===0&&(Ze&6)===0&&cs();var a=Ze;Ze|=1;var c=qt.transition,d=nt;try{if(qt.transition=null,nt=1,s)return s()}finally{nt=d,qt.transition=c,Ze=a,(Ze&6)===0&&Ir()}}function Gd(){Gi=na.current,_t(na)}function ls(s,a){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==hr&&(s.timeoutHandle=hr,cr(c)),Vt!==null)for(c=Vt.return;c!==null;){var d=c;switch(ed(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Ll();break;case 3:ta(),_t(ji),_t(_i),gd();break;case 5:fd(d);break;case 4:ta();break;case 13:_t(Lt);break;case 19:_t(Lt);break;case 10:ad(d.type._context);break;case 22:case 23:Gd()}c=c.return}if(si=s,Vt=s=An(s.current,null),pi=Gi=a,Zt=0,io=null,Dd=fu=os=0,Ui=ro=null,ss!==null){for(a=0;a<ss.length;a++)if(c=ss[a],d=c.interleaved,d!==null){c.interleaved=null;var m=d.next,b=c.pending;if(b!==null){var P=b.next;b.next=m,d.next=P}c.pending=d}ss=null}return s}function Fw(s,a){do{var c=Vt;try{if(sd(),Xl.current=eu,Zl){for(var d=Ot.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Zl=!1}if(as=0,ni=Xt=Ot=null,Va=!1,Ga=0,Bd.current=null,c===null||c.return===null){Zt=1,io=a,Vt=null;break}e:{var b=s,P=c.return,N=c,Q=a;if(a=pi,N.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ae=Q,Ee=N,He=Ee.tag;if((Ee.mode&1)===0&&(He===0||He===11||He===15)){var ve=Ee.alternate;ve?(Ee.updateQueue=ve.updateQueue,Ee.memoizedState=ve.memoizedState,Ee.lanes=ve.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var St=sw(P);if(St!==null){St.flags&=-257,aw(St,P,N,b,a),St.mode&1&&nw(b,ae,a),a=St,Q=ae;var vt=a.updateQueue;if(vt===null){var Hi=new Set;Hi.add(Q),a.updateQueue=Hi}else vt.add(Q);break e}else{if((a&1)===0){nw(b,ae,a),Yd();break e}Q=Error(u(426))}}else if(kt&&N.mode&1){var en=sw(P);if(en!==null){(en.flags&65536)===0&&(en.flags|=256),aw(en,P,N,b,a),rd(ia(Q,N));break e}}b=Q=ia(Q,N),Zt!==4&&(Zt=2),ro===null?ro=[b]:ro.push(b),b=P;do{switch(b.tag){case 3:b.flags|=65536,a&=-a,b.lanes|=a;var W=iw(b,Q,a);C0(b,W);break e;case 1:N=Q;var B=b.type,Y=b.stateNode;if((b.flags&128)===0&&(typeof B.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Sn===null||!Sn.has(Y)))){b.flags|=65536,a&=-a,b.lanes|=a;var ye=rw(b,N,a);C0(b,ye);break e}}b=b.return}while(b!==null)}Nw(c)}catch(Me){a=Me,Vt===c&&c!==null&&(Vt=c=c.return);continue}break}while(!0)}function Mw(){var s=du.current;return du.current=eu,s===null?eu:s}function Yd(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),si===null||(os&268435455)===0&&(fu&268435455)===0||kn(si,pi)}function bu(s,a){var c=Ze;Ze|=2;var d=Mw();(si!==s||pi!==a)&&(Jr=null,ls(s,a));do try{UL();break}catch(m){Fw(s,m)}while(!0);if(sd(),Ze=c,du.current=d,Vt!==null)throw Error(u(261));return si=null,pi=0,Zt}function UL(){for(;Vt!==null;)zw(Vt)}function WL(){for(;Vt!==null&&!gL();)zw(Vt)}function zw(s){var a=Dw(s.alternate,s,Gi);s.memoizedProps=s.pendingProps,a===null?Nw(s):Vt=a,Bd.current=null}function Nw(s){var a=s;do{var c=a.alternate;if(s=a.return,(a.flags&32768)===0){if(c=FL(c,a,Gi),c!==null){Vt=c;return}}else{if(c=ML(c,a),c!==null){c.flags&=32767,Vt=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Zt=6,Vt=null;return}}if(a=a.sibling,a!==null){Vt=a;return}Vt=a=s}while(a!==null);Zt===0&&(Zt=5)}function us(s,a,c){var d=nt,m=qt.transition;try{qt.transition=null,nt=1,HL(s,a,c,d)}finally{qt.transition=m,nt=d}return null}function HL(s,a,c,d){do cs();while(En!==null);if((Ze&6)!==0)throw Error(u(327));c=s.finishedWork;var m=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(u(177));s.callbackNode=null,s.callbackPriority=0;var b=c.lanes|c.childLanes;if(pL(s,b),s===si&&(Vt=si=null,pi=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||gu||(gu=!0,Uw(Zh,function(){return cs(),null})),b=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||b){b=qt.transition,qt.transition=null;var P=nt;nt=1;var N=Ze;Ze|=4,Bd.current=null,NL(s,c),kw(c,s),Ge(s.containerInfo),s.current=c,jL(c),mL(),Ze=N,nt=P,qt.transition=b}else s.current=c;if(gu&&(gu=!1,En=s,mu=m),b=s.pendingLanes,b===0&&(Sn=null),bL(c.stateNode),Wi(s,ri()),a!==null)for(d=s.onRecoverableError,c=0;c<a.length;c++)m=a[c],d(m.value,{componentStack:m.stack,digest:m.digest});if(pu)throw pu=!1,s=Hd,Hd=null,s;return(mu&1)!==0&&s.tag!==0&&cs(),b=s.pendingLanes,(b&1)!==0?s===qd?no++:(no=0,qd=s):no=0,Ir(),null}function cs(){if(En!==null){var s=p0(mu),a=qt.transition,c=nt;try{if(qt.transition=null,nt=16>s?16:s,En===null)var d=!1;else{if(s=En,En=null,mu=0,(Ze&6)!==0)throw Error(u(331));var m=Ze;for(Ze|=4,_e=s.current;_e!==null;){var b=_e,P=b.child;if((_e.flags&16)!==0){var N=b.deletions;if(N!==null){for(var Q=0;Q<N.length;Q++){var ae=N[Q];for(_e=ae;_e!==null;){var Ee=_e;switch(Ee.tag){case 0:case 11:case 15:eo(8,Ee,b)}var He=Ee.child;if(He!==null)He.return=Ee,_e=He;else for(;_e!==null;){Ee=_e;var ve=Ee.sibling,St=Ee.return;if(_w(Ee),Ee===ae){_e=null;break}if(ve!==null){ve.return=St,_e=ve;break}_e=St}}}var vt=b.alternate;if(vt!==null){var Hi=vt.child;if(Hi!==null){vt.child=null;do{var en=Hi.sibling;Hi.sibling=null,Hi=en}while(Hi!==null)}}_e=b}}if((b.subtreeFlags&2064)!==0&&P!==null)P.return=b,_e=P;else e:for(;_e!==null;){if(b=_e,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:eo(9,b,b.return)}var W=b.sibling;if(W!==null){W.return=b.return,_e=W;break e}_e=b.return}}var B=s.current;for(_e=B;_e!==null;){P=_e;var Y=P.child;if((P.subtreeFlags&2064)!==0&&Y!==null)Y.return=P,_e=Y;else e:for(P=B;_e!==null;){if(N=_e,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:au(9,N)}}catch(Me){At(N,N.return,Me)}if(N===P){_e=null;break e}var ye=N.sibling;if(ye!==null){ye.return=N.return,_e=ye;break e}_e=N.return}}if(Ze=m,Ir(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(zl,s)}catch{}d=!0}return d}finally{nt=c,qt.transition=a}}return!1}function jw(s,a,c){a=ia(c,a),a=iw(s,a,1),s=_n(s,a,1),a=ki(),s!==null&&(Ua(s,1,a),Wi(s,a))}function At(s,a,c){if(s.tag===3)jw(s,s,c);else for(;a!==null;){if(a.tag===3){jw(a,s,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Sn===null||!Sn.has(d))){s=ia(c,s),s=rw(a,s,1),a=_n(a,s,1),s=ki(),a!==null&&(Ua(a,1,s),Wi(a,s));break}}a=a.return}}function qL(s,a,c){var d=s.pingCache;d!==null&&d.delete(a),a=ki(),s.pingedLanes|=s.suspendedLanes&c,si===s&&(pi&c)===c&&(Zt===4||Zt===3&&(pi&130023424)===pi&&500>ri()-Ud?ls(s,0):Dd|=c),Wi(s,a)}function Bw(s,a){a===0&&((s.mode&1)===0?a=1:(a=Fl,Fl<<=1,(Fl&130023424)===0&&(Fl=4194304)));var c=ki();s=Rr(s,a),s!==null&&(Ua(s,a,c),Wi(s,c))}function QL(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),Bw(s,c)}function VL(s,a){var c=0;switch(s.tag){case 13:var d=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:d=s.stateNode;break;default:throw Error(u(314))}d!==null&&d.delete(a),Bw(s,c)}var Dw;Dw=function(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps||ji.current)Di=!0;else{if((s.lanes&c)===0&&(a.flags&128)===0)return Di=!1,$L(s,a,c);Di=(s.flags&131072)!==0}else Di=!1,kt&&(a.flags&1048576)!==0&&v0(a,Bl,a.index);switch(a.lanes=0,a.tag){case 2:var d=a.type;iu(s,a),s=a.pendingProps;var m=Vs(a,_i.current);Ks(a,c),m=yd(null,a,d,s,m,c);var b=bd();return a.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Bi(d)?(b=!0,Ol(a)):b=!1,a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,ud(a),m.updater=Vl,a.stateNode=m,m._reactInternals=a,hd(a,d,s,c),a=Ad(null,a,d,!0,b,c)):(a.tag=0,kt&&b&&Jh(a),$i(null,a,m,c),a=a.child),a;case 16:d=a.elementType;e:{switch(iu(s,a),s=a.pendingProps,m=d._init,d=m(d._payload),a.type=d,m=a.tag=YL(d),s=gr(d,s),m){case 0:a=kd(null,a,d,s,c);break e;case 1:a=dw(null,a,d,s,c);break e;case 11:a=ow(null,a,d,s,c);break e;case 14:a=lw(null,a,d,gr(d.type,s),c);break e}throw Error(u(306,d,""))}return a;case 0:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),kd(s,a,d,m,c);case 1:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),dw(s,a,d,m,c);case 3:e:{if(fw(a),s===null)throw Error(u(387));d=a.pendingProps,b=a.memoizedState,m=b.element,E0(s,a),Ql(a,d,null,c);var P=a.memoizedState;if(d=P.element,Wt&&b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){m=ia(Error(u(423)),a),a=pw(s,a,d,c,m);break e}else if(d!==m){m=ia(Error(u(424)),a),a=pw(s,a,d,c,m);break e}else for(Wt&&(er=YR(a.stateNode.containerInfo),Vi=a,kt=!0,pr=null,Wa=!1),c=O0(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Xs(),d===m){a=Kr(s,a,c);break e}$i(s,a,d,c)}a=a.child}return a;case 5:return $0(a),s===null&&id(a),d=a.type,m=a.pendingProps,b=s!==null?s.memoizedProps:null,P=m.children,pt(d,m)?P=null:b!==null&&pt(d,b)&&(a.flags|=32),hw(s,a),$i(s,a,P,c),a.child;case 6:return s===null&&id(a),null;case 13:return gw(s,a,c);case 4:return dd(a,a.stateNode.containerInfo),d=a.pendingProps,s===null?a.child=Js(a,null,d,c):$i(s,a,d,c),a.child;case 11:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),ow(s,a,d,m,c);case 7:return $i(s,a,a.pendingProps,c),a.child;case 8:return $i(s,a,a.pendingProps.children,c),a.child;case 12:return $i(s,a,a.pendingProps.children,c),a.child;case 10:e:{if(d=a.type._context,m=a.pendingProps,b=a.memoizedProps,P=m.value,_0(a,d,P),b!==null)if(fr(b.value,P)){if(b.children===m.children&&!ji.current){a=Kr(s,a,c);break e}}else for(b=a.child,b!==null&&(b.return=a);b!==null;){var N=b.dependencies;if(N!==null){P=b.child;for(var Q=N.firstContext;Q!==null;){if(Q.context===d){if(b.tag===1){Q=Zr(-1,c&-c),Q.tag=2;var ae=b.updateQueue;if(ae!==null){ae=ae.shared;var Ee=ae.pending;Ee===null?Q.next=Q:(Q.next=Ee.next,Ee.next=Q),ae.pending=Q}}b.lanes|=c,Q=b.alternate,Q!==null&&(Q.lanes|=c),od(b.return,c,a),N.lanes|=c;break}Q=Q.next}}else if(b.tag===10)P=b.type===a.type?null:b.child;else if(b.tag===18){if(P=b.return,P===null)throw Error(u(341));P.lanes|=c,N=P.alternate,N!==null&&(N.lanes|=c),od(P,c,a),P=b.sibling}else P=b.child;if(P!==null)P.return=b;else for(P=b;P!==null;){if(P===a){P=null;break}if(b=P.sibling,b!==null){b.return=P.return,P=b;break}P=P.return}b=P}$i(s,a,m.children,c),a=a.child}return a;case 9:return m=a.type,d=a.pendingProps.children,Ks(a,c),m=tr(m),d=d(m),a.flags|=1,$i(s,a,d,c),a.child;case 14:return d=a.type,m=gr(d,a.pendingProps),m=gr(d.type,m),lw(s,a,d,m,c);case 15:return uw(s,a,a.type,a.pendingProps,c);case 17:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:gr(d,m),iu(s,a),a.tag=1,Bi(d)?(s=!0,Ol(a)):s=!1,Ks(a,c),T0(a,d,m),hd(a,d,m,c),Ad(null,a,d,!0,s,c);case 19:return vw(s,a,c);case 22:return cw(s,a,c)}throw Error(u(156,a.tag))};function Uw(s,a){return Yh(s,a)}function GL(s,a,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(s,a,c,d){return new GL(s,a,c,d)}function Xd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function YL(s){if(typeof s=="function")return Xd(s)?1:0;if(s!=null){if(s=s.$$typeof,s===R)return 11;if(s===F)return 14}return 2}function An(s,a){var c=s.alternate;return c===null?(c=sr(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function wu(s,a,c,d,m,b){var P=2;if(d=s,typeof s=="function")Xd(s)&&(P=1);else if(typeof s=="string")P=5;else e:switch(s){case y:return hs(c.children,m,b,a);case S:P=8,m|=8;break;case C:return s=sr(12,c,a,m|2),s.elementType=C,s.lanes=b,s;case O:return s=sr(13,c,a,m),s.elementType=O,s.lanes=b,s;case E:return s=sr(19,c,a,m),s.elementType=E,s.lanes=b,s;case U:return xu(c,m,b,a);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:P=10;break e;case T:P=9;break e;case R:P=11;break e;case F:P=14;break e;case z:P=16,d=null;break e}throw Error(u(130,s==null?s:typeof s,""))}return a=sr(P,c,a,m),a.elementType=s,a.type=d,a.lanes=b,a}function hs(s,a,c,d){return s=sr(7,s,d,a),s.lanes=c,s}function xu(s,a,c,d){return s=sr(22,s,d,a),s.elementType=U,s.lanes=c,s.stateNode={isHidden:!1},s}function Zd(s,a,c){return s=sr(6,s,null,a),s.lanes=c,s}function Kd(s,a,c){return a=sr(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}function XL(s,a,c,d,m){this.tag=a,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=hr,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vh(0),this.expirationTimes=Vh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vh(0),this.identifierPrefix=d,this.onRecoverableError=m,Wt&&(this.mutableSourceEagerHydrationData=null)}function Ww(s,a,c,d,m,b,P,N,Q){return s=new XL(s,a,c,N,Q),a===1?(a=1,b===!0&&(a|=8)):a=0,b=sr(3,null,null,a),s.current=b,b.stateNode=s,b.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},ud(b),s}function Hw(s){if(!s)return wn;s=s._reactInternals;e:{if(q(s)!==s||s.tag!==1)throw Error(u(170));var a=s;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Bi(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(u(171))}if(s.tag===1){var c=s.type;if(Bi(c))return h0(s,c,a)}return a}function qw(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(u(188)):(s=Object.keys(s).join(","),Error(u(268,s)));return s=de(a),s===null?null:s.stateNode}function Qw(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function _u(s,a){Qw(s,a),(s=s.alternate)&&Qw(s,a)}function ZL(s){return s=de(s),s===null?null:s.stateNode}function KL(){return null}return r.attemptContinuousHydration=function(s){if(s.tag===13){var a=Rr(s,134217728);if(a!==null){var c=ki();nr(a,s,134217728,c)}_u(s,134217728)}},r.attemptDiscreteHydration=function(s){if(s.tag===13){var a=Rr(s,1);if(a!==null){var c=ki();nr(a,s,1,c)}_u(s,1)}},r.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var a=Cn(s),c=Rr(s,a);if(c!==null){var d=ki();nr(c,s,a,d)}_u(s,a)}},r.attemptSynchronousHydration=function(s){switch(s.tag){case 3:var a=s.stateNode;if(a.current.memoizedState.isDehydrated){var c=Da(a.pendingLanes);c!==0&&(Gh(a,c|1),Wi(a,ri()),(Ze&6)===0&&(sa(),Ir()))}break;case 13:$w(function(){var d=Rr(s,1);if(d!==null){var m=ki();nr(d,s,1,m)}}),_u(s,1)}},r.batchedUpdates=function(s,a){var c=Ze;Ze|=1;try{return s(a)}finally{Ze=c,Ze===0&&(sa(),Nl&&Ir())}},r.createComponentSelector=function(s){return{$$typeof:ou,value:s}},r.createContainer=function(s,a,c,d,m,b,P){return Ww(s,a,!1,null,c,d,m,b,P)},r.createHasPseudoClassSelector=function(s){return{$$typeof:lu,value:s}},r.createHydrationContainer=function(s,a,c,d,m,b,P,N,Q){return s=Ww(c,d,!0,s,m,b,P,N,Q),s.context=Hw(null),c=s.current,d=ki(),m=Cn(c),b=Zr(d,m),b.callback=a??null,_n(c,b,m),s.current.lanes=m,Ua(s,m,d),Wi(s,d),s},r.createPortal=function(s,a,c){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:d==null?null:""+d,children:s,containerInfo:a,implementation:c}},r.createRoleSelector=function(s){return{$$typeof:uu,value:s}},r.createTestNameSelector=function(s){return{$$typeof:cu,value:s}},r.createTextSelector=function(s){return{$$typeof:hu,value:s}},r.deferredUpdates=function(s){var a=nt,c=qt.transition;try{return qt.transition=null,nt=16,s()}finally{nt=a,qt.transition=c}},r.discreteUpdates=function(s,a,c,d,m){var b=nt,P=qt.transition;try{return qt.transition=null,nt=1,s(a,c,d,m)}finally{nt=b,qt.transition=P,Ze===0&&sa()}},r.findAllNodes=jd,r.findBoundingRects=function(s,a){if(!Ct)throw Error(u(363));a=jd(s,a),s=[];for(var c=0;c<a.length;c++)s.push(Oi(a[c]));for(a=s.length-1;0<a;a--){c=s[a];for(var d=c.x,m=d+c.width,b=c.y,P=b+c.height,N=a-1;0<=N;N--)if(a!==N){var Q=s[N],ae=Q.x,Ee=ae+Q.width,He=Q.y,ve=He+Q.height;if(d>=ae&&b>=He&&m<=Ee&&P<=ve){s.splice(a,1);break}else if(d!==ae||c.width!==Q.width||ve<b||He>P){if(!(b!==He||c.height!==Q.height||Ee<d||ae>m)){ae>d&&(Q.width+=ae-d,Q.x=d),Ee<m&&(Q.width=m-ae),s.splice(a,1);break}}else{He>b&&(Q.height+=He-b,Q.y=b),ve<P&&(Q.height=P-He),s.splice(a,1);break}}}return s},r.findHostInstance=qw,r.findHostInstanceWithNoPortals=function(s){return s=ge(s),s=s!==null?me(s):null,s===null?null:s.stateNode},r.findHostInstanceWithWarning=function(s){return qw(s)},r.flushControlled=function(s){var a=Ze;Ze|=1;var c=qt.transition,d=nt;try{qt.transition=null,nt=1,s()}finally{nt=d,qt.transition=c,Ze=a,Ze===0&&(sa(),Ir())}},r.flushPassiveEffects=cs,r.flushSync=$w,r.focusWithin=function(s,a){if(!Ct)throw Error(u(363));for(s=Md(s),a=Rw(s,a),a=Array.from(a),s=0;s<a.length;){var c=a[s++];if(!ts(c)){if(c.tag===5&&Tl(c.stateNode))return!0;for(c=c.child;c!==null;)a.push(c),c=c.sibling}}return!1},r.getCurrentUpdatePriority=function(){return nt},r.getFindAllNodesFailureDescription=function(s,a){if(!Ct)throw Error(u(363));var c=0,d=[];s=[Md(s),0];for(var m=0;m<s.length;){var b=s[m++],P=s[m++],N=a[P];if((b.tag!==5||!ts(b))&&(zd(b,N)&&(d.push(Nd(N)),P++,P>c&&(c=P)),P<a.length))for(b=b.child;b!==null;)s.push(b,P),b=b.sibling}if(c<a.length){for(s=[];c<a.length;c++)s.push(Nd(a[c]));return`findAllNodes was able to match part of the selector:
  `+(d.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},r.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return We(s.child.stateNode);default:return s.child.stateNode}},r.injectIntoDevTools=function(s){if(s={bundleType:s.bundleType,version:s.version,rendererPackageName:s.rendererPackageName,rendererConfig:s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:h.ReactCurrentDispatcher,findHostInstanceByFiber:ZL,findFiberByHostInstance:s.findFiberByHostInstance||KL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)s=!0;else{try{zl=a.inject(s),Tr=a}catch{}s=!!a.checkDCE}}return s},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(s,a,c,d){if(!Ct)throw Error(u(363));s=jd(s,a);var m=Nh(s,c,d).disconnect;return{disconnect:function(){m()}}},r.registerMutableSourceForHydration=function(s,a){var c=a._getVersion;c=c(a._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[a,c]:s.mutableSourceEagerHydrationData.push(a,c)},r.runWithPriority=function(s,a){var c=nt;try{return nt=s,a()}finally{nt=c}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(s,a,c,d){var m=a.current,b=ki(),P=Cn(m);return c=Hw(c),a.context===null?a.context=c:a.pendingContext=c,a=Zr(b,P),a.payload={element:s},d=d===void 0?null:d,d!==null&&(a.callback=d),s=_n(m,a,P),s!==null&&(nr(s,m,P,b),ql(s,m,P)),P},r}}),jx=Ke((e,t)=>{t.exports=Nx()}),Hf=Ke(e=>{var t=(Qe(),Qt(xs));e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot}),rc=Ke((e,t)=>{(function(i,r){r(typeof e=="object"&&typeof t<"u"?e:(i=i||self).TypesafeActions={})})(e,function(i){function r(E){return E==null}function n(E){throw new Error("Argument "+E+" is empty.")}function o(E){return typeof E=="function"&&"getType"in E}function l(E){throw new Error("Argument "+E+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function u(E,F){if(E==null)throw new Error("Argument contains array with empty element at index "+F);if(E.getType==null)throw new Error("Argument contains array with invalid element at index "+F+', it should be an action-creator instance from "typesafe-actions"')}function h(E){return typeof E=="string"||typeof E=="symbol"}function g(E){return!h(E)}function f(E){throw new Error("Argument "+E+" is invalid, it should be an action type of type: string | symbol")}function y(E,F){if(E==null)throw new Error("Argument contains array with empty element at index "+F);if(typeof E!="string"&&typeof E!="symbol")throw new Error("Argument contains array with invalid element at index "+F+", it should be of type: string | symbol")}function S(E,F,z,U){return r(E)&&n(1),g(E)&&l(1),{type:E,payload:F,meta:z,error:U}}function C(E,F){return r(E)&&n(1),g(E)&&f(1),Object.assign(function(){var z=F!=null?F.apply(void 0,arguments):void 0;return Object.assign({type:E},z)},{getType:function(){return E},toString:function(){return E}})}function _(E,F,z){return r(E)&&n(1),g(E)&&f(1),function(){return C(E,function(){var U=arguments.length<=0?void 0:arguments[0],H=arguments.length<=1?void 0:arguments[1];return F==null&&z==null||(U=F!=null?F.apply(void 0,arguments):void 0,H=z!=null?z.apply(void 0,arguments):void 0),Object.assign({},U!==void 0&&{payload:U},{},H!==void 0&&{meta:H})})}}function T(E){return r(E)&&n(1),o(E)||l(1),E.getType()}function R(E,F){r(E)&&n(1),g(E)&&f(1);var z=F!=null?F(E):function(){return{type:E}};return Object.assign(z,{getType:function(){return E},toString:function(){return E}})}var O={createAction:function(E,F){var z=F==null?function(){return S(E)}:F(S.bind(null,E));return Object.assign(z,{getType:function(){return E},toString:function(){return E}})},createCustomAction:R,createStandardAction:function(E){return r(E)&&n(1),g(E)&&f(1),Object.assign(function(){return R(E,function(F){return function(z,U){return{type:F,payload:z,meta:U}}})},{map:function(F){return R(E,function(z){return function(U,H){return Object.assign(F(U,H),{type:z})}})}})}};i.action=S,i.createAction=_,i.createAsyncAction=function(E,F,z,U){return function(){var H=[E,F,z,U].map(function(G,V){return Array.isArray(G)?_(G[0],G[1],G[2])():typeof G=="string"||typeof G=="symbol"?_(G)():void(V<3&&(function(le){throw new Error("Argument "+le+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')})(V))});return{request:H[0],success:H[1],failure:H[2],cancel:H[3]}}},i.createCustomAction=C,i.createReducer=function E(F,z){z===void 0&&(z={});var U=Object.assign({},z),H=function(G,V){var le=Array.isArray(G)?G:[G],q={};return le.map(function(ne,ge){return o(ne)?T(ne):h(ne)?ne:(function(de){throw new Error("Argument "+de+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')})(ge+1)}).forEach(function(ne){return q[ne]=V}),E(F,Object.assign({},U,{},q))};return Object.assign(function(G,V){if(G===void 0&&(G=F),U.hasOwnProperty(V.type)){var le=U[V.type];if(typeof le!="function")throw Error('Reducer under "'+V.type+'" key is not a valid reducer');return le(G,V)}return G},{handlers:Object.assign({},U),handleAction:H,handleType:H})},i.deprecated=O,i.getType=T,i.isActionOf=function(E,F){r(E)&&n(1);var z=Array.isArray(E)?E:[E];z.forEach(u);var U=function(H){return z.some(function(G){return H.type===G.getType()})};return F===void 0?U:U(F)},i.isOfType=function(E,F){r(E)&&n(1);var z=Array.isArray(E)?E:[E];z.forEach(y);var U=function(H){return z.includes(H.type)};return F===void 0?U:U(F)}})}),qf=Ke((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?r(e,(Qe(),Qt(xs))):(i=typeof globalThis<"u"?globalThis:i||self,r(i.ReactErrorBoundary={},i.React))})(e,function(i,r){function n(C){if(C&&C.__esModule)return C;var _=Object.create(null);return C&&Object.keys(C).forEach(function(T){if(T!=="default"){var R=Object.getOwnPropertyDescriptor(C,T);Object.defineProperty(_,T,R.get?R:{enumerable:!0,get:function(){return C[T]}})}}),_.default=C,Object.freeze(_)}var o=n(r);function l(C,_){return l=Object.setPrototypeOf||function(T,R){return T.__proto__=R,T},l(C,_)}function u(C,_){C.prototype=Object.create(_.prototype),C.prototype.constructor=C,l(C,_)}var h=function(C,_){return C===void 0&&(C=[]),_===void 0&&(_=[]),C.length!==_.length||C.some(function(T,R){return!Object.is(T,_[R])})},g={error:null},f=(function(C){u(_,C);function _(){for(var R,O=arguments.length,E=new Array(O),F=0;F<O;F++)E[F]=arguments[F];return R=C.call.apply(C,[this].concat(E))||this,R.state=g,R.resetErrorBoundary=function(){for(var z,U=arguments.length,H=new Array(U),G=0;G<U;G++)H[G]=arguments[G];R.props.onReset==null||(z=R.props).onReset.apply(z,H),R.reset()},R}_.getDerivedStateFromError=function(R){return{error:R}};var T=_.prototype;return T.reset=function(){this.setState(g)},T.componentDidCatch=function(R,O){var E,F;(E=(F=this.props).onError)==null||E.call(F,R,O)},T.componentDidUpdate=function(R,O){var E=this.state.error,F=this.props.resetKeys;if(E!==null&&O.error!==null&&h(R.resetKeys,F)){var z,U;(z=(U=this.props).onResetKeysChange)==null||z.call(U,R.resetKeys,F),this.reset()}},T.render=function(){var R=this.state.error,O=this.props,E=O.fallbackRender,F=O.FallbackComponent,z=O.fallback;if(R!==null){var U={error:R,resetErrorBoundary:this.resetErrorBoundary};if(o.isValidElement(z))return z;if(typeof E=="function")return E(U);if(F)return o.createElement(F,U);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},_})(o.Component);function y(C,_){var T=function(O){return o.createElement(f,_,o.createElement(C,O))},R=C.displayName||C.name||"Unknown";return T.displayName="withErrorBoundary("+R+")",T}function S(C){var _=o.useState(null),T=_[0],R=_[1];if(C!=null)throw C;if(T!=null)throw T;return R}i.ErrorBoundary=f,i.useErrorHandler=S,i.withErrorBoundary=y,Object.defineProperty(i,"__esModule",{value:!0})})});Xe();function On(e,t,i,r){function n(){let l=Reflect.construct(HTMLElement,[],n);return l._vdomComponent=e,l._shadowEnabled=r&&r.shadow,l._root=l._shadowEnabled?l.attachShadow({mode:"open"}):l,r.onConstruct&&r.onConstruct(l),l.ready=!1,l.whenReady=u=>{l.ready?u():l.addEventListener("ready",u)},l}n.prototype=Object.create(HTMLElement.prototype),n.prototype.constructor=n,n.prototype.connectedCallback=Dx,n.prototype.attributeChangedCallback=Ux,n.prototype.disconnectedCallback=Wx,i=i||e.observedAttributes||Object.keys(e.propTypes||{}),n.observedAttributes=i,i.forEach(l=>{Object.defineProperty(n.prototype,l,{get(){return this._vdom?this._vdom.props[l]:(this._props||(this._props={}),this._props[l])},set(u){this._vdom?(this._props[l]=u,this.attributeChangedCallback(l,null,u)):(this._props||(this._props={}),this._props[l]=u,this._props[nc(l)]=u);let h=typeof u;(u==null||h==="string"||h==="boolean"||h==="number")&&this.setAttribute(l,u)}})}),r.beforeCreate&&r.beforeCreate(n);let o=t||e.tagName||e.displayName||e.name;if(!customElements.get(o))return customElements.define(t||e.tagName||e.displayName||e.name,n)}function Bx(e){this.getChildContext=()=>e.context;let t=e,{context:i,children:r}=t,n=oe(t,["context","children"]);return Lu(r,n)}function Dx(){let e=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(e);let t=e.detail.context;this._vdom=$(Bx,D(A({},this._props),{context:t}),Vf(this,this._vdomComponent,this._shadowEnabled)),(this.hasAttribute("hydrate")?Ru:wr)(this._vdom,this._root),this.ready||(this.ready=!0,this.dispatchEvent(new CustomEvent("ready",{detail:{},bubbles:!1,cancelable:!1})))}function nc(e){return e.replace(/-(\w)/g,(t,i)=>i?i.toUpperCase():"")}function Ux(e,t,i){if(!this._vdom)return;i=i??void 0;let r={};r[e]=i,r[nc(e)]=i,this._vdom=Lu(this._vdom,r),wr(this._vdom,this._root)}function Wx(){wr(this._vdom=null,this._root)}function Qf(e,t){let i=e,{shadow:r,addContextListener:n,removeContextListener:o}=i,l=oe(i,["shadow","addContextListener","removeContextListener"]),u=h=>{h?(this.ref=h,this._listener||(this._listener=g=>{g.stopPropagation(),g.detail.context=t},n(this._listener,this.ref))):o(this._listener,this.ref)};return!r&&!this._listener&&(this._listener=h=>{h.stopPropagation(),h.detail.context=t},n(this._listener)),$(r?"slot":Je,D(A({},l),{ref:u}))}function Vf(e,t,i){if(e.nodeType===3)return e.data;if(e.nodeType!==1)return null;let r=[],n={},o=0,l=e.attributes,u=e.childNodes;for(o=l.length;o--;)l[o].name!=="slot"&&(n[l[o].name]=l[o].value,n[nc(l[o].name)]=l[o].value);for(o=u.length;o--;){let g=u[o],f=Vf(g,null,i),y=g.slot;y?n[y]=$(Qf,{name:y,shadow:i,addContextListener(S,C=g){C.addEventListener("_preact",S)},removeContextListener(S,C=g){C.removeEventListener("_preact",S)}},f):r[o]=f}let h=t?$(Qf,{shadow:i,addContextListener(g,f=e){f.addEventListener("_preact",g)},removeContextListener(g,f=e){f.removeEventListener("_preact",g)}},r):r;return!i&&t&&(e.innerHTML=""),$(t||e.nodeName.toLowerCase(),n,h)}Qe(),Qe(),Qe(),Qe(),Qe();var Hx=De(jx(),1),Gf,Yf,xo=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];function qx(){return xo.reduce((e,t)=>(e[t]=[],e),{})}var Es=xo.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),pa=(e,t,i)=>{let r=e.length,n=i||Le(r);for(let o=0;o<r;o++)n[o]=o%5===0?e[o+1]<t[3]&&e[o+3]>t[1]&&e[o+2]<t[4]&&e[o+4]>t[2]?1:0:e[o];return n};function Le(e,t,i){return new Float32Array(e,t,i)}var Qx=(e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||Le(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)},Vx=e=>e.length/5,Nr=(e,t,i)=>{let r=i||Le(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},it=class{constructor(e){this.index=0,this.length=e,this.points=Le(this.length)}static grid(e=1,t=1){return new it(5*e*t)}static point(e,t){let i=Le(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=Le(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return it.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=Le(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},xr=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},rn=e=>{let t=Le(9);return t[0]=e,t[4]=e,t[8]=1,t},Pi=(e,t)=>{let i=Le(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},ga=(e,t,i)=>Nr(Pi((1-e)*t,(1-e)*i),rn(e)),jr=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):Le(r);for(let o=0;o<r;o++)n[o]=o%5===0?t[6]*e[o+1]+t[7]*e[o+2]+t[8]*e[o]:o%5%2===1?t[0]*e[o]+t[1]*e[o+1]+t[2]:t[3]*e[o-1]+t[4]*e[o]+t[5];return n},_o=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,i)=>(i&=63,i<36?t+=i.toString(36):i<62?t+=(i-26).toString(36).toUpperCase():i>62?t+="-":t+="_",t),""),_r=class{constructor(){this.__revision=0,this.__owner={value:void 0},this.__state={},this.scale=1,this.layers=[],this.time=[],this.addEventListener=(e,t,i)=>{let r=Es[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(t)===-1&&this.eventHandlers[r].push(t)},this.removeEventListener=(e,t)=>{let i=Es[e];if(!this.eventHandlers[i]){console.warn(`Unknown event ${i}`);return}this.eventHandlers[i].indexOf(t)!==-1&&(this.eventHandlers[i]=this.eventHandlers[i].filter(r=>r!==t))},this.id=this.__id=_o(),this.eventHandlers=qx()}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let o=0;o<r;o++)try{i[o](t),n=!0}catch(l){console.error(e,l)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){xr(this.points,Pi(e,t))}atScale(e){xr(this.points,ga(e,this.x,this.y)),this.scale*=e}transform(e){xr(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},ur=class extends _r{constructor(e){if(super(),this.type="spacial-content",this.style={opacity:1},!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Le(5)},this.points=Le(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=it.singleBox(e.width,e.height,e.x,e.y),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:it.singleBox(e.width/t,e.height/t),rotation:e==null?void 0:e.rotation}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;if(this.id=e.id||e.uri,this.uri=e.uri,this.points.set(it.singleBox(e.target.width,e.target.height,e.target.x,e.target.y)),e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.crop){this.cropData=e.crop;let r=it.singleBox(e.crop.width,e.crop.height,e.crop.x,e.crop.y);xr(r,Pi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(r):this.crop=Le(r)}e.display?(this.display.scale=i,this.display.width=e.display.width,this.display.height=e.display.height,this.display.rotation=e.display.rotation,this.display.points=it.singleBox(e.display.width,e.display.height)):(this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.display.points=it.singleBox(e.target.width/i,e.target.height/i))}getAllPointsAt(e,t,i){return[[this,this.crop||this.points,t]]}static fromSvg(e,t,i,r){return ur.fromImage("data:image/svg+xml;base64,"+btoa(e),t,i,r)}static fromImage(e,t,i,r){let n=new ur;return n.applyProps({uri:e,id:r,display:i,target:t}),n}getImageUrl(){return this.uri}},So=class extends _r{constructor(e){if(super(),this.type="spacial-content",this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Le(5)},this.points=Le(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=it.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:t!==1?it.singleBox(e.width/t,e.height/t):this.points}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(it.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=i!==1?it.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function Gx(e,t,i=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let n=0;for(let o=0;o<r&&!(!t[o]||!t[o].display);o++)n=Math.abs(t[o].display.scale-e)*i<Math.abs(t[n].display.scale-e)?o:n;return n}function Xf(e,t){return Math.abs(e-t)}function Eo(e,t){let i=Xf(e.x,t.x),r=Xf(e.y,t.y);return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}function Yx(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function Zf(...e){return t=>e.forEach(i=>(function(r,n){typeof r=="function"?r(n):r!=null&&(r.current=n)})(i,t))}function Co(...e){return Ue(Zf(...e),e)}function vi(){return vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},vi.apply(this,arguments)}var Kf=li((e,t)=>{let i=e,{children:r}=i,n=oe(i,["children"]);return tn.toArray(r).some(ep)?$(Je,null,tn.map(r,o=>ep(o)?$(sc,vi({},n,{ref:t}),o.props.children):o)):$(sc,vi({},n,{ref:t}),r)});Kf.displayName="Slot";var sc=li((e,t)=>{let i=e,{children:r}=i,n=oe(i,["children"]);return fa(r)?bo(r,D(A({},Xx(n,r.props)),{ref:Zf(t,r.ref)})):tn.count(r)>1?tn.only(null):null});sc.displayName="SlotClone";var Jf=({children:e})=>$(Je,null,e);function ep(e){return fa(e)&&e.type===Jf}function Xx(e,t){let i=A({},t);for(let r in t){let n=e[r],o=t[r];/^on[A-Z]/.test(r)?i[r]=(...l)=>{o==null||o(...l),n==null||n(...l)}:r==="style"?i[r]=A(A({},n),o):r==="className"&&(i[r]=[n,o].filter(Boolean).join(" "))}return A(A({},e),i)}var ko=globalThis!=null&&globalThis.document?Tt:()=>{},Ao=function(e,t,i,r){this.name=e,this.fn=t,this.args=i,this.modifiers=r};Ao.prototype._test=function(e){var t=this.fn;try{Cs(this.modifiers.slice(),t,this)(e)}catch{t=function(){return!1}}try{return Cs(this.modifiers.slice(),t,this)(e)}catch{return!1}},Ao.prototype._check=function(e){try{Cs(this.modifiers.slice(),this.fn,this)(e)}catch{if(Cs(this.modifiers.slice(),function(i){return i},this)(!1))return}if(!Cs(this.modifiers.slice(),this.fn,this)(e))throw null},Ao.prototype._testAsync=function(e){var t=this;return new Promise(function(i,r){ip(t.modifiers.slice(),t.fn,t)(e).then(function(n){n?i(e):r(null)}).catch(function(n){return r(n)})})};function tp(e,t){return t===void 0&&(t="simple"),typeof e=="object"?e[t]:e}function Cs(e,t,i){if(e.length){var r=e.shift(),n=Cs(e,t,i);return r.perform(n,i)}else return tp(t)}function ip(e,t,i){if(e.length){var r=e.shift(),n=ip(e,t,i);return r.performAsync(n,i)}else return function(o){return Promise.resolve(tp(t,"async")(o))}}var Zx=function(e,t,i){this.name=e,this.perform=t,this.performAsync=i},ac=(function(e){function t(i,r,n,o){for(var l=[],u=arguments.length-4;u-- >0;)l[u]=arguments[u+4];e.call(this,l),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=i,this.value=r,this.cause=n,this.target=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t})(Error),Sr=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]),this.chain=e,this.nextRuleModifiers=t};Sr.prototype._applyRule=function(e,t){var i=this;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return i.chain.push(new Ao(t,e.apply(i,r),r,i.nextRuleModifiers)),i.nextRuleModifiers=[],i}},Sr.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new Zx(t,e.simple,e.async)),this},Sr.prototype._clone=function(){return new Sr(this.chain.slice(),this.nextRuleModifiers.slice())},Sr.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})},Sr.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(i){try{i._check(e)}catch(r){t.push(new ac(i,e,r))}}),t},Sr.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(i){throw new ac(t,e,i)}})},Sr.prototype.testAsync=function(e){var t=this;return new Promise(function(i,r){rp(e,t.chain.slice(),i,r)})};function rp(e,t,i,r){if(t.length){var n=t.shift();n._testAsync(e).then(function(){rp(e,t,i,r)},function(o){r(new ac(n,e,o))})}else i(e)}var np=function(e,t){return t&&typeof e=="string"&&e.trim().length===0?!0:e==null};function Kx(e,t){return t===void 0&&(t=!1),{simple:function(i){return np(i,t)||e.check(i)===void 0},async:function(i){return np(i,t)||e.testAsync(i)}}}function nn(){return typeof Proxy<"u"?sp(new Sr):oc(new Sr)}var ma={};nn.extend=function(e){Object.assign(ma,e)},nn.clearCustomRules=function(){ma={}};function sp(e){return new Proxy(e,{get:function(t,i){if(i in t)return t[i];var r=sp(e._clone());if(i in Po)return r._applyModifier(Po[i],i);if(i in ma)return r._applyRule(ma[i],i);if(i in lc)return r._applyRule(lc[i],i)}})}function oc(e){var t=function(n,o){return Object.keys(n).forEach(function(l){o[l]=function(){for(var u=[],h=arguments.length;h--;)u[h]=arguments[h];var g=oc(o._clone()),f=g._applyRule(n[l],l).apply(void 0,u);return f}}),o},i=t(lc,e),r=t(ma,i);return Object.keys(Po).forEach(function(n){Object.defineProperty(r,n,{get:function(){var o=oc(r._clone());return o._applyModifier(Po[n],n)}})}),r}var Po={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then(function(i){return!i}).catch(function(){return!0})}}},some:{simple:function(e){return function(t){return To(t).some(function(i){try{return e(i)}catch{return!1}})}},async:function(e){return function(t){return Promise.all(To(t).map(function(i){try{return e(i).catch(function(){return!1})}catch{return!1}})).then(function(i){return i.some(Boolean)})}}},every:{simple:function(e){return function(t){return t!==!1&&To(t).every(e)}},async:function(e){return function(t){return Promise.all(To(t).map(e)).then(function(i){return i.every(Boolean)})}}},strict:{simple:function(e,t){return function(i){return ap(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&e(i):e(i)}},async:function(e,t){return function(i){return Promise.resolve(e(i)).then(function(r){return ap(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&r:r}).catch(function(){return!1})}}}};function ap(e){return e&&e.name==="schema"&&e.args.length>0&&typeof e.args[0]=="object"}function To(e){return typeof e=="string"?e.split(""):e}var lc={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return e===void 0&&(e=!0),function(t){return typeof t=="number"&&(e||isFinite(t))}},integer:function(){return function(e){var t=Number.isInteger||Jx;return t(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return ks("string")},boolean:function(){return ks("boolean")},undefined:function(){return ks("undefined")},null:function(){return ks("null")},array:function(){return ks("array")},object:function(){return ks("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return typeof e=="boolean"||e===e.toLowerCase()&&e.trim()!==""}},uppercase:function(){return function(e){return e===e.toUpperCase()&&e.trim()!==""}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return e.length===0}},length:function(e,t){return function(i){return i.length>=e&&i.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(i){return i>=e&&i<=t}},range:function(e,t){return function(i){return i>=e&&i<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2===0}},odd:function(){return function(e){return e%2!==0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return e1(e)},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(i){return e.some(function(r){return r.test(i)})}},optional:Kx};function ks(e){return function(t){return Array.isArray(t)&&e==="array"||t===null&&e==="null"||typeof t===e}}function Jx(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function e1(e){return{simple:function(t){var i=[];if(Object.keys(e).forEach(function(r){var n=e[r];try{n.check((t||{})[r])}catch(o){o.target=r,i.push(o)}}),i.length>0)throw i;return!0},async:function(t){var i=[],r=Object.keys(e).map(function(n){var o=e[n];return o.testAsync((t||{})[n]).catch(function(l){l.target=n,i.push(l)})});return Promise.all(r).then(function(){if(i.length>0)throw i;return!0})}}}var ft="colors",Ti="sizes",Se="space",t1={gap:Se,gridGap:Se,columnGap:Se,gridColumnGap:Se,rowGap:Se,gridRowGap:Se,inset:Se,insetBlock:Se,insetBlockEnd:Se,insetBlockStart:Se,insetInline:Se,insetInlineEnd:Se,insetInlineStart:Se,margin:Se,marginTop:Se,marginRight:Se,marginBottom:Se,marginLeft:Se,marginBlock:Se,marginBlockEnd:Se,marginBlockStart:Se,marginInline:Se,marginInlineEnd:Se,marginInlineStart:Se,padding:Se,paddingTop:Se,paddingRight:Se,paddingBottom:Se,paddingLeft:Se,paddingBlock:Se,paddingBlockEnd:Se,paddingBlockStart:Se,paddingInline:Se,paddingInlineEnd:Se,paddingInlineStart:Se,top:Se,right:Se,bottom:Se,left:Se,scrollMargin:Se,scrollMarginTop:Se,scrollMarginRight:Se,scrollMarginBottom:Se,scrollMarginLeft:Se,scrollMarginX:Se,scrollMarginY:Se,scrollMarginBlock:Se,scrollMarginBlockEnd:Se,scrollMarginBlockStart:Se,scrollMarginInline:Se,scrollMarginInlineEnd:Se,scrollMarginInlineStart:Se,scrollPadding:Se,scrollPaddingTop:Se,scrollPaddingRight:Se,scrollPaddingBottom:Se,scrollPaddingLeft:Se,scrollPaddingX:Se,scrollPaddingY:Se,scrollPaddingBlock:Se,scrollPaddingBlockEnd:Se,scrollPaddingBlockStart:Se,scrollPaddingInline:Se,scrollPaddingInlineEnd:Se,scrollPaddingInlineStart:Se,fontSize:"fontSizes",background:ft,backgroundColor:ft,backgroundImage:ft,borderImage:ft,border:ft,borderBlock:ft,borderBlockEnd:ft,borderBlockStart:ft,borderBottom:ft,borderBottomColor:ft,borderColor:ft,borderInline:ft,borderInlineEnd:ft,borderInlineStart:ft,borderLeft:ft,borderLeftColor:ft,borderRight:ft,borderRightColor:ft,borderTop:ft,borderTopColor:ft,caretColor:ft,color:ft,columnRuleColor:ft,fill:ft,outline:ft,outlineColor:ft,stroke:ft,textDecorationColor:ft,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ti,minBlockSize:Ti,maxBlockSize:Ti,inlineSize:Ti,minInlineSize:Ti,maxInlineSize:Ti,width:Ti,minWidth:Ti,maxWidth:Ti,height:Ti,minHeight:Ti,maxHeight:Ti,flexBasis:Ti,gridTemplateColumns:Ti,gridTemplateRows:Ti,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i1=(e,t)=>typeof t=="function"?{"()":Function.prototype.toString.call(t)}:t,As=()=>{let e=Object.create(null);return(t,i,...r)=>{let n=(o=>JSON.stringify(o,i1))(t);return n in e?e[n]:e[n]=i(t,...r)}},$n=Symbol.for("sxs.internal"),uc=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),op=e=>{for(let t in e)return!0;return!1},{hasOwnProperty:r1}=Object.prototype,cc=e=>e.includes("-")?e:e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),n1=/\s+(?![^()]*\))/,Ps=e=>t=>e(...typeof t=="string"?String(t).split(n1):[t]),lp={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:Ps((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:Ps((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:Ps((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:Ps((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:Ps((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:Ps((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},hc=/([\d.]+)([^]*)/,s1=(e,t)=>e.length?e.reduce((i,r)=>(i.push(...t.map(n=>n.includes("&")?n.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(n)?`:is(${r})`:r):r+" "+n)),i),[]):t,a1=(e,t)=>e in o1&&typeof t=="string"?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(i,r,n,o)=>r+(n==="stretch"?`-moz-available${o};${cc(e)}:${r}-webkit-fill-available`:`-moz-fit-content${o};${cc(e)}:${r}fit-content`)+o):String(t),o1={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},Br=e=>e?e+"-":"",up=(e,t,i)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,n,o,l,u)=>l=="$"==!!o?r:(n||l=="--"?"calc(":"")+"var(--"+(l==="$"?Br(t)+(u.includes("$")?"":Br(i))+u.replace(/\$/g,"-"):u)+")"+(n||l=="--"?"*"+(n||"")+(o||"1")+")":"")),l1=/\s*,\s*(?![^()]*\))/,u1=Object.prototype.toString,Ts=(e,t,i,r,n)=>{let o,l,u,h=(g,f,y)=>{let S,C,_=T=>{for(S in T){let E=S.charCodeAt(0)===64,F=E&&Array.isArray(T[S])?T[S]:[T[S]];for(C of F){let z=/[A-Z]/.test(O=S)?O:O.replace(/-[^]/g,H=>H[1].toUpperCase()),U=typeof C=="object"&&C&&C.toString===u1&&(!r.utils[z]||!f.length);if(z in r.utils&&!U){let H=r.utils[z];if(H!==l){l=H,_(H(C)),l=null;continue}}else if(z in lp){let H=lp[z];if(H!==u){u=H,_(H(C)),u=null;continue}}if(E&&(R=S.slice(1)in r.media?"@media "+r.media[S.slice(1)]:S,S=R.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(H,G,V,le,q,ne)=>{let ge=hc.test(G),de=.0625*(ge?-1:1),[we,me]=ge?[le,G]:[G,le];return"("+(V[0]==="="?"":V[0]===">"===ge?"max-":"min-")+we+":"+(V[0]!=="="&&V.length===1?me.replace(hc,(ce,We,ee)=>Number(We)+de*(V===">"?1:-1)+ee):me)+(q?") and ("+(q[0]===">"?"min-":"max-")+we+":"+(q.length===1?ne.replace(hc,(ce,We,ee)=>Number(We)+de*(q===">"?-1:1)+ee):ne):"")+")"})),U){let H=E?y.concat(S):[...y],G=E?[...f]:s1(f,S.split(l1));o!==void 0&&n(cp(...o)),o=void 0,h(C,G,H)}else o===void 0&&(o=[[],f,y]),S=E||S.charCodeAt(0)!==36?S:`--${Br(r.prefix)}${S.slice(1).replace(/\$/g,"-")}`,C=U?C:typeof C=="number"?C&&z in c1?String(C)+"px":String(C):up(a1(z,C??""),r.prefix,r.themeMap[z]),o[0].push(`${E?`${S} `:`${cc(S)}:`}${C}`)}}var R,O};_(g),o!==void 0&&n(cp(...o)),o=void 0};h(e,t,i)},cp=(e,t,i)=>`${i.map(r=>`${r}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(i.length?i.length+1:0).join("}")}`,c1={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},hp=e=>String.fromCharCode(e+(e>25?39:97)),Fn=e=>(t=>{let i,r="";for(i=Math.abs(t);i>52;i=i/52|0)r=hp(i%52)+r;return hp(i%52)+r})(((t,i)=>{let r=i.length;for(;r;)t=33*t^i.charCodeAt(--r);return t})(5381,JSON.stringify(e))>>>0),va=["themed","global","styled","onevar","resonevar","allvar","inline"],h1=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch{return!1}},d1=e=>{let t,i=()=>{let{cssRules:n}=t.sheet;return[].map.call(n,(o,l)=>{let{cssText:u}=o,h="";if(u.startsWith("--sxs"))return"";if(n[l-1]&&(h=n[l-1].cssText).startsWith("--sxs")){if(!o.cssRules.length)return"";for(let g in t.rules)if(t.rules[g].group===o)return`--sxs{--sxs:${[...t.rules[g].cache].join(" ")}}${u}`;return o.cssRules.length?`${h}${u}`:""}return u}).join("")},r=()=>{if(t){let{rules:u,sheet:h}=t;if(!h.deleteRule){for(;Object(Object(h.cssRules)[0]).type===3;)h.cssRules.splice(0,1);h.cssRules=[]}for(let g in u)delete u[g]}let n=Object(e).styleSheets||[];for(let u of n)if(h1(u)){for(let h=0,g=u.cssRules;g[h];++h){let f=Object(g[h]);if(f.type!==1)continue;let y=Object(g[h+1]);if(y.type!==4)continue;++h;let{cssText:S}=f;if(!S.startsWith("--sxs"))continue;let C=S.slice(14,-3).trim().split(/\s+/),_=va[C[0]];_&&(t||(t={sheet:u,reset:r,rules:{},toString:i}),t.rules[_]={group:y,index:h,cache:new Set(C)})}if(t)break}if(!t){let u=(h,g)=>({type:g,cssRules:[],insertRule(f,y){this.cssRules.splice(y,0,u(f,{import:3,undefined:1}[(f.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return h==="@media{}"?`@media{${[].map.call(this.cssRules,f=>f.cssText).join("")}}`:h}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:u("","text/css"),rules:{},reset:r,toString:i}}let{sheet:o,rules:l}=t;for(let u=va.length-1;u>=0;--u){let h=va[u];if(!l[h]){let g=va[u+1],f=l[g]?l[g].index:o.cssRules.length;o.insertRule("@media{}",f),o.insertRule(`--sxs{--sxs:${u}}`,f),l[h]={group:o.cssRules[f+1],index:f,cache:new Set([u])}}f1(l[h])}};return r(),t},f1=e=>{let t=e.group,i=t.cssRules.length;e.apply=r=>{try{t.insertRule(r,i),++i}catch{}}},ya=Symbol(),p1=As(),dp=(e,t)=>p1(e,()=>(...i)=>{let r={type:null,composers:new Set};for(let n of i)if(n!=null)if(n[$n]){r.type==null&&(r.type=n[$n].type);for(let o of n[$n].composers)r.composers.add(o)}else n.constructor!==Object||n.$$typeof?r.type==null&&(r.type=n):r.composers.add(g1(n,e));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),m1(e,r,t)}),g1=(e,t)=>{var i=e,{variants:r,compoundVariants:n,defaultVariants:o}=i,l=oe(i,["variants","compoundVariants","defaultVariants"]);let u=`${Br(t.prefix)}c-${Fn(l)}`,h=[],g=[],f=Object.create(null),y=[];for(let _ in o)f[_]=String(o[_]);if(typeof r=="object"&&r)for(let _ in r){S=f,C=_,r1.call(S,C)||(f[_]="undefined");let T=r[_];for(let R in T){let O={[_]:String(R)};String(R)==="undefined"&&y.push(_);let E=T[R],F=[O,E,!op(E)];h.push(F)}}var S,C;if(typeof n=="object"&&n)for(let _ of n){let T=_,{css:R}=T,O=oe(T,["css"]);R=typeof R=="object"&&R||{};for(let F in O)O[F]=String(O[F]);let E=[O,R,!op(R)];g.push(E)}return[u,l,h,g,f,y]},m1=(e,t,i)=>{let[r,n,o,l]=v1(t.composers),u=typeof t.type=="function"||t.type.$$typeof?(y=>{function S(){for(let C=0;C<S[ya].length;C++){let[_,T]=S[ya][C];y.rules[_].apply(T)}return S[ya]=[],null}return S[ya]=[],S.rules={},va.forEach(C=>S.rules[C]={apply:_=>S[ya].push([C,_])}),S})(i):null,h=(u||i).rules,g=`.${r}${n.length>1?`:where(.${n.slice(1).join(".")})`:""}`,f=y=>{y=typeof y=="object"&&y||y1;let S=y,{css:C}=S,_=oe(S,["css"]),T={};for(let E in o)if(delete _[E],E in y){let F=y[E];typeof F=="object"&&F?T[E]=A({"@initial":o[E]},F):(F=String(F),T[E]=F!=="undefined"||l.has(E)?F:o[E])}else T[E]=o[E];let R=new Set([...n]);for(let[E,F,z,U]of t.composers){i.rules.styled.cache.has(E)||(i.rules.styled.cache.add(E),Ts(F,[`.${E}`],[],e,V=>{h.styled.apply(V)}));let H=fp(z,T,e.media),G=fp(U,T,e.media,!0);for(let V of H)if(V!==void 0)for(let[le,q,ne]of V){let ge=`${E}-${Fn(q)}-${le}`;R.add(ge);let de=(ne?i.rules.resonevar:i.rules.onevar).cache,we=ne?h.resonevar:h.onevar;de.has(ge)||(de.add(ge),Ts(q,[`.${ge}`],[],e,me=>{we.apply(me)}))}for(let V of G)if(V!==void 0)for(let[le,q]of V){let ne=`${E}-${Fn(q)}-${le}`;R.add(ne),i.rules.allvar.cache.has(ne)||(i.rules.allvar.cache.add(ne),Ts(q,[`.${ne}`],[],e,ge=>{h.allvar.apply(ge)}))}}if(typeof C=="object"&&C){let E=`${r}-i${Fn(C)}-css`;R.add(E),i.rules.inline.cache.has(E)||(i.rules.inline.cache.add(E),Ts(C,[`.${E}`],[],e,F=>{h.inline.apply(F)}))}for(let E of String(y.className||"").trim().split(/\s+/))E&&R.add(E);let O=_.className=[...R].join(" ");return{type:t.type,className:O,selector:g,props:_,toString:()=>O,deferredInjector:u}};return uc(f,{className:r,selector:g,[$n]:t,toString:()=>(i.rules.styled.cache.has(r)||f(),r)})},v1=e=>{let t="",i=[],r={},n=[];for(let[o,,,,l,u]of e){t===""&&(t=o),i.push(o),n.push(...u);for(let h in l){let g=l[h];(r[h]===void 0||g!=="undefined"||u.includes(g))&&(r[h]=g)}}return[t,i,r,new Set(n)]},fp=(e,t,i,r)=>{let n=[];e:for(let[o,l,u]of e){if(u)continue;let h,g=0,f=!1;for(h in o){let y=o[h],S=t[h];if(S!==y){if(typeof S!="object"||!S)continue e;{let C,_,T=0;for(let R in S){if(y===String(S[R])){if(R!=="@initial"){let O=R.slice(1);(_=_||[]).push(O in i?i[O]:R.replace(/^@media ?/,"")),f=!0}g+=T,C=!0}++T}if(_&&_.length&&(l={["@media "+_.join(", ")]:l}),!C)continue e}}}(n[g]=n[g]||[]).push([r?"cv":`${h}-${o[h]}`,l,f])}return n},y1={},b1=As(),w1=(e,t)=>b1(e,()=>(...i)=>{let r=()=>{for(let n of i){n=typeof n=="object"&&n||{};let o=Fn(n);if(!t.rules.global.cache.has(o)){if(t.rules.global.cache.add(o),"@import"in n){let l=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let u of[].concat(n["@import"]))u=u.includes('"')||u.includes("'")?u:`"${u}"`,t.sheet.insertRule(`@import ${u};`,l++);delete n["@import"]}Ts(n,[],[],e,l=>{t.rules.global.apply(l)})}}return""};return uc(r,{toString:r})}),x1=As(),_1=(e,t)=>x1(e,()=>i=>{let r=`${Br(e.prefix)}k-${Fn(i)}`,n=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);let o=[];Ts(i,[],[],e,u=>o.push(u));let l=`@keyframes ${r}{${o.join("")}}`;t.rules.global.apply(l)}return r};return uc(n,{get name(){return n()},toString:n})}),S1=class{constructor(e,t,i,r){this.token=e==null?"":String(e),this.value=t==null?"":String(t),this.scale=i==null?"":String(i),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+Br(this.prefix)+Br(this.scale)+this.token}toString(){return this.computedValue}},E1=As(),C1=(e,t)=>E1(e,()=>(i,r)=>{r=typeof i=="object"&&i||Object(r);let n=`.${i=(i=typeof i=="string"?i:"")||`${Br(e.prefix)}t-${Fn(r)}`}`,o={},l=[];for(let h in r){o[h]={};for(let g in r[h]){let f=`--${Br(e.prefix)}${h}-${g}`,y=up(String(r[h][g]),e.prefix,h);o[h][g]=new S1(g,y,h,e.prefix),l.push(`${f}:${y}`)}}let u=()=>{if(l.length&&!t.rules.themed.cache.has(i)){t.rules.themed.cache.add(i);let h=`${r===e.theme?":root,":""}.${i}{${l.join(";")}}`;t.rules.themed.apply(h)}return i};return D(A({},o),{get className(){return u()},selector:n,toString:u})}),k1=As(),A1=As(),P1=e=>{let t=(i=>{let r=!1,n=k1(i,o=>{r=!0;let l="prefix"in(o=typeof o=="object"&&o||{})?String(o.prefix):"",u=typeof o.media=="object"&&o.media||{},h=typeof o.root=="object"?o.root||null:globalThis.document||null,g=typeof o.theme=="object"&&o.theme||{},f={prefix:l,media:u,theme:g,themeMap:typeof o.themeMap=="object"&&o.themeMap||A({},t1),utils:typeof o.utils=="object"&&o.utils||{}},y=d1(h),S={css:dp(f,y),globalCss:w1(f,y),keyframes:_1(f,y),createTheme:C1(f,y),reset(){y.reset(),S.theme.toString()},theme:{},sheet:y,config:f,prefix:l,getCssText:y.toString,toString:y.toString};return String(S.theme=S.createTheme(g)),S});return r||n.reset(),n})(e);return t.styled=(({config:i,sheet:r})=>A1(i,()=>{let n=dp(i,r);return(...o)=>{let l=n(...o),u=l[$n].type,h=J.forwardRef((g,f)=>{let y=g&&g.as||u,{props:S,deferredInjector:C}=l(g);return delete S.as,S.ref=f,C?J.createElement(J.Fragment,null,J.createElement(y,S),J.createElement(C,null)):J.createElement(y,S)});return h.className=l.className,h.displayName=`Styled.${u.displayName||u.name||u}`,h.selector=l.selector,h.toString=()=>l.selector,h[$n]=l[$n],h}}))(t),t};function T1(e,t,i){return Math.max(t,Math.min(e,i))}var yi={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function pp(e,t,i){return t===0||Math.abs(t)===1/0?Math.pow(e,i*5):e*t*i/(t+i*e)}function gp(e,t,i,r=.15){return r===0?T1(e,t,i):e<t?-pp(t-e,i-t,r)+t:e>i?+pp(e-i,i-t,r)+i:e}function I1(e,[t,i],[r,n]){let[[o,l],[u,h]]=e;return[gp(t,o,l,r),gp(i,u,h,n)]}function R1(e,t){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L1(e){var t=R1(e,"string");return typeof t=="symbol"?t:String(t)}function Mi(e,t,i){return t=L1(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function mp(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function It(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?mp(Object(i),!0).forEach(function(r){Mi(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mp(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var vp={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function yp(e){return e?e[0].toUpperCase()+e.slice(1):""}var O1=["enter","leave"];function $1(e=!1,t){return e&&!O1.includes(t)}function F1(e,t="",i=!1){let r=vp[e],n=r&&r[t]||t;return"on"+yp(e)+yp(n)+($1(i,n)?"Capture":"")}var M1=["gotpointercapture","lostpointercapture"];function z1(e){let t=e.substring(2).toLowerCase(),i=!!~t.indexOf("passive");i&&(t=t.replace("passive",""));let r=M1.includes(t)?"capturecapture":"capture",n=!!~t.indexOf(r);return n&&(t=t.replace("capture","")),{device:t,capture:n,passive:i}}function N1(e,t=""){let i=vp[e],r=i&&i[t]||t;return e+r}function Io(e){return"touches"in e}function bp(e){return Io(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function j1(e){return Array.from(e.touches).filter(t=>{var i,r;return t.target===e.currentTarget||((i=e.currentTarget)===null||i===void 0||(r=i.contains)===null||r===void 0?void 0:r.call(i,t.target))})}function B1(e){return e.type==="touchend"||e.type==="touchcancel"?e.changedTouches:e.targetTouches}function wp(e){return Io(e)?B1(e)[0]:e}function D1(e){return j1(e).map(t=>t.identifier)}function dc(e){let t=wp(e);return Io(e)?t.identifier:t.pointerId}function xp(e){let t=wp(e);return[t.clientX,t.clientY]}function U1(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:i,altKey:r,metaKey:n,ctrlKey:o}=e;Object.assign(t,{shiftKey:i,altKey:r,metaKey:n,ctrlKey:o})}return t}function Ro(e,...t){return typeof e=="function"?e(...t):e}function W1(){}function H1(...e){return e.length===0?W1:e.length===1?e[0]:function(){let t;for(let i of e)t=i.apply(this,arguments)||t;return t}}function _p(e,t){return Object.assign({},t,e||{})}var q1=32,Q1=class{constructor(e,t,i){this.ctrl=e,this.args=t,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:i,args:r}=this;t[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,i=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=i.from?Ro(i.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:i,shared:r}=this;t.args=this.args;let n=0;if(e&&(t.event=e,i.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,U1(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,n=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let U=t._delta.map(Math.abs);yi.addTo(t._distance,U)}this.axisIntent&&this.axisIntent(e);let[o,l]=t._movement,[u,h]=i.threshold,{_step:g,values:f}=t;if(i.hasCustomTransform?(g[0]===!1&&(g[0]=Math.abs(o)>=u&&f[0]),g[1]===!1&&(g[1]=Math.abs(l)>=h&&f[1])):(g[0]===!1&&(g[0]=Math.abs(o)>=u&&Math.sign(o)*u),g[1]===!1&&(g[1]=Math.abs(l)>=h&&Math.sign(l)*h)),t.intentional=g[0]!==!1||g[1]!==!1,!t.intentional)return;let y=[0,0];if(i.hasCustomTransform){let[U,H]=f;y[0]=g[0]!==!1?U-g[0]:0,y[1]=g[1]!==!1?H-g[1]:0}else y[0]=g[0]!==!1?o-g[0]:0,y[1]=g[1]!==!1?l-g[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(y);let S=t.offset,C=t._active&&!t._blocked||t.active;C&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in i&&(t._bounds=Ro(i.bounds,t)),this.setup&&this.setup()),t.movement=y,this.computeOffset()));let[_,T]=t.offset,[[R,O],[E,F]]=t._bounds;t.overflow=[_<R?-1:_>O?1:0,T<E?-1:T>F?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;let z=t._active?i.rubberband||[0,0]:[0,0];if(t.offset=I1(t._bounds,t.offset,z),t.delta=yi.sub(t.offset,S),this.computeMovement(),C&&(!t.last||n>q1)){t.delta=yi.sub(t.offset,S);let U=t.delta.map(Math.abs);yi.addTo(t.distance,U),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&n>0&&(t.velocity=[U[0]/n,U[1]/n])}}emit(){let e=this.state,t=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;let r=this.handler(It(It(It({},t),e),{},{[this.aliasKey]:e.values}));r!==void 0&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function V1([e,t],i){let r=Math.abs(e),n=Math.abs(t);if(r>n&&r>i)return"x";if(n>r&&n>i)return"y"}var G1=class extends Q1{constructor(...e){super(...e),Mi(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=yi.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=yi.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,i=this.config;if(!t.axis&&e){let r=typeof i.axisThreshold=="object"?i.axisThreshold[bp(e)]:i.axisThreshold;t.axis=V1(t._movement,r)}t._blocked=(i.lockDirection||!!i.axis)&&!t.axis||!!i.axis&&i.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}},Y1=e=>e,Sp=.15,Ep={enabled(e=!0){return e},eventOptions(e,t,i){return It(It({},i.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[Sp,Sp];case!1:return[0,0];default:return yi.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return yi.toVector(e)},transform(e,t,i){let r=e||i.shared.transform;return this.hasCustomTransform=!!r,r||Y1},threshold(e){return yi.toVector(e,0)}},X1=0,ba=It(It({},Ep),{},{axis(e,t,{axis:i}){if(this.lockDirection=i==="lock",!this.lockDirection)return i},axisThreshold(e=X1){return e},bounds(e={}){if(typeof e=="function")return o=>ba.bounds(e(o));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:i=1/0,top:r=-1/0,bottom:n=1/0}=e;return[[t,i],[r,n]]}}),Cp={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]},Z1=class extends G1{constructor(...e){super(...e),Mi(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:t.left-i.left+e.offset[0],right:t.right-i.right+e.offset[0],top:t.top-i.top+e.offset[1],bottom:t.bottom-i.bottom+e.offset[1]};e._bounds=ba.bounds(r)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,i=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;let r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&i._pointerActive)&&(this.start(e),this.setupPointer(e),i._pointerId=dc(e),i._pointerActive=!0,this.computeValues(xp(e)),this.computeInitial(),t.preventScrollAxis&&bp(e)!=="mouse"?(i._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,i=this.config;if(!t._pointerActive||t.type===e.type&&e.timeStamp===t.timeStamp)return;let r=dc(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;let n=xp(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=yi.sub(n,t._values),this.computeValues(n)),yi.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(i.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===i.preventScrollAxis||i.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}let t=this.state,i=this.config;if(!t._active||!t._pointerActive)return;let r=dc(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[n,o]=t._distance;if(t.tap=n<=i.tapsThreshold&&o<=i.tapsThreshold,t.tap&&i.filterTaps)t._force=!0;else{let[l,u]=t.direction,[h,g]=t.velocity,[f,y]=t.movement,[S,C]=i.swipe.velocity,[_,T]=i.swipe.distance,R=i.swipe.duration;t.elapsedTime<R&&(Math.abs(h)>S&&Math.abs(f)>_&&(t.swipe[0]=l),Math.abs(g)>C&&Math.abs(y)>T&&(t.swipe[1]=u))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,i=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,K1(e);let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=Cp[e.key];if(t){let i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=t(this.config.keyboardDisplacement,r),i._keyboardActive=!0,yi.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Cp&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}};function K1(e){"persist"in e&&typeof e.persist=="function"&&e.persist()}var wa=typeof window<"u"&&window.document&&window.document.createElement;function J1(){return wa&&"ontouchstart"in window}function kp(){return J1()||wa&&window.navigator.maxTouchPoints>1}function e_(){return wa&&"onpointerdown"in window}function t_(){return wa&&"exitPointerLock"in window.document}function i_(){try{return"constructor"in GestureEvent}catch{return!1}}var Xi={isBrowser:wa,gesture:i_(),touch:kp(),touchscreen:kp(),pointer:e_(),pointerLock:t_()},r_=250,n_=180,s_=.5,a_=50,o_=250,l_=10,Ap={mouse:0,touch:0,pen:8},u_=It(It({},ba),{},{device(e,t,{pointer:{touch:i=!1,lock:r=!1,mouse:n=!1}={}}){return this.pointerLock=r&&Xi.pointerLock,Xi.touch&&i?"touch":this.pointerLock?"mouse":Xi.pointer&&!n?"pointer":Xi.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:i}){if(this.preventScrollDelay=typeof i=="number"?i:i||i===void 0&&e?r_:void 0,!(!Xi.touchscreen||i===!1))return e||(i!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:i=!0,buttons:r=1,keys:n=!0}={}}){return this.pointerButtons=r,this.keys=n,!this.pointerLock&&this.device==="pointer"&&i},threshold(e,t,{filterTaps:i=!1,tapsThreshold:r=3,axis:n=void 0}){let o=yi.toVector(e,i?r:n?1:0);return this.filterTaps=i,this.tapsThreshold=r,o},swipe({velocity:e=s_,distance:t=a_,duration:i=o_}={}){return{velocity:this.transform(yi.toVector(e)),distance:this.transform(yi.toVector(t)),duration:i}},delay(e=0){switch(e){case!0:return n_;case!1:return 0;default:return e}},axisThreshold(e){return e?It(It({},Ap),e):Ap},keyboardDisplacement(e=l_){return e}});It(It({},Ep),{},{device(e,t,{shared:i,pointer:{touch:r=!1}={}}){if(i.target&&!Xi.touch&&Xi.gesture)return"gesture";if(Xi.touch&&r)return"touch";if(Xi.touchscreen){if(Xi.pointer)return"pointer";if(Xi.touch)return"touch"}},bounds(e,t,{scaleBounds:i={},angleBounds:r={}}){let n=l=>{let u=_p(Ro(i,l),{min:-1/0,max:1/0});return[u.min,u.max]},o=l=>{let u=_p(Ro(r,l),{min:-1/0,max:1/0});return[u.min,u.max]};return typeof i!="function"&&typeof r!="function"?[n(),o()]:l=>[n(l),o(l)]},threshold(e,t,i){return this.lockDirection=i.axis==="lock",yi.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}}),It(It({},ba),{},{mouseOnly:(e=!0)=>e}),It(It({},ba),{},{mouseOnly:(e=!0)=>e});var Pp=new Map,fc=new Map;function c_(e){Pp.set(e.key,e.engine),fc.set(e.key,e.resolver)}var h_={key:"drag",engine:Z1,resolver:u_};function d_(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function f_(e,t){if(e==null)return{};var i=d_(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var p_={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Xi.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},g_=["target","eventOptions","window","enabled","transform"];function Lo(e={},t){let i={};for(let[r,n]of Object.entries(t))switch(typeof n){case"function":i[r]=n.call(i,e[r],r,e);break;case"object":i[r]=Lo(e[r],n);break;case"boolean":n&&(i[r]=e[r]);break}return i}function m_(e,t,i={}){let r=e,{target:n,eventOptions:o,window:l,enabled:u,transform:h}=r,g=f_(r,g_);if(i.shared=Lo({target:n,eventOptions:o,window:l,enabled:u,transform:h},p_),t){let f=fc.get(t);i[t]=Lo(It({shared:i.shared},g),f)}else for(let f in g){let y=fc.get(f);y&&(i[f]=Lo(It({shared:i.shared},g[f]),y))}return i}var Tp=class{constructor(e,t){Mi(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,i,r,n){let o=this._listeners,l=N1(t,i),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},h=It(It({},u),n);e.addEventListener(l,r,h);let g=()=>{e.removeEventListener(l,r,h),o.delete(g)};return o.add(g),g}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}},v_=class{constructor(){Mi(this,"_timeouts",new Map)}add(e,t,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,i,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}},y_=class{constructor(e){Mi(this,"gestures",new Set),Mi(this,"_targetEventStore",new Tp(this)),Mi(this,"gestureEventStores",{}),Mi(this,"gestureTimeoutStores",{}),Mi(this,"handlers",{}),Mi(this,"config",{}),Mi(this,"pointerIds",new Set),Mi(this,"touchIds",new Set),Mi(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),b_(this,e)}setEventIds(e){if(Io(e))return this.touchIds=new Set(D1(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=m_(e,t,this.config)}clean(){this._targetEventStore.clean();for(let e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t=this.config.shared,i={},r;if(!(t.target&&(r=t.target(),!r))){if(t.enabled){for(let o of this.gestures){let l=this.config[o],u=Ip(i,l.eventOptions,!!r);if(l.enabled){let h=Pp.get(o);new h(this,e,o).bind(u)}}let n=Ip(i,t.eventOptions,!!r);for(let o in this.nativeHandlers)n(o,"",l=>this.nativeHandlers[o](It(It({},this.state.shared),{},{event:l,args:e})),void 0,!0)}for(let n in i)i[n]=H1(...i[n]);if(!r)return i;for(let n in i){let{device:o,capture:l,passive:u}=z1(n);this._targetEventStore.add(r,o,"",i[n],{capture:l,passive:u})}}}};function Is(e,t){e.gestures.add(t),e.gestureEventStores[t]=new Tp(e,t),e.gestureTimeoutStores[t]=new v_}function b_(e,t){t.drag&&Is(e,"drag"),t.wheel&&Is(e,"wheel"),t.scroll&&Is(e,"scroll"),t.move&&Is(e,"move"),t.pinch&&Is(e,"pinch"),t.hover&&Is(e,"hover")}var Ip=(e,t,i)=>(r,n,o,l={},u=!1)=>{var h,g;let f=(h=l.capture)!==null&&h!==void 0?h:t.capture,y=(g=l.passive)!==null&&g!==void 0?g:t.passive,S=u?r:F1(r,n,f);i&&y&&(S+="Passive"),e[S]=e[S]||[],e[S].push(o)};function w_(e,t={},i,r){let n=J.useMemo(()=>new y_(e),[]);if(n.applyHandlers(e,r),n.applyConfig(t,i),J.useEffect(n.effect.bind(n)),J.useEffect(()=>n.clean.bind(n),[]),t.target===void 0)return n.bind.bind(n)}function x_(e,t){return c_(h_),w_({drag:e},{},"drag")}var __=xs.useId||(()=>{}),S_=0;function E_(e){let[t,i]=ze(__());return ko(()=>{i(r=>r??String(S_++))},[e]),t?`radix-${t}`:""}var Rs=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((e,t)=>D(A({},e),{[t]:li((i,r)=>{let n=i,{asChild:o}=n,l=oe(n,["asChild"]),u=o?Kf:t;return fe(()=>{window[Symbol.for("radix-ui")]=!0},[]),i.as&&console.error(C_),$(u,vi({},l,{ref:r}))})}),{}),C_="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",k_=li((e,t)=>$(Rs.span,vi({},e,{ref:t,style:D(A({},e.style),{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"})}))),A_=k_,P_=li((e,t)=>{var i,r;let n=e,{containerRef:o,style:l}=n,u=oe(n,["containerRef","style"]),h=(i=o==null?void 0:o.current)!==null&&i!==void 0?i:globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,[,g]=ze({});return ko(()=>{g({})},[]),h?J.createPortal($(Rs.div,vi({"data-radix-portal":""},u,{ref:t,style:h===document.body?A({position:"absolute",top:0,left:0,zIndex:2147483647},l):void 0})),h):null}),T_=li((e,t)=>{let i=e,{children:r,width:n=10,height:o=5}=i,l=oe(i,["children","width","height"]);return $(Rs.svg,vi({},l,{ref:t,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:$("polygon",{points:"0,0 30,0 15,10"}))}),I_=T_;function Rp(e){let[t,i]=ze(void 0);return fe(()=>{if(e){let r=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;let o=n[0],l,u;if("borderBoxSize"in o){let h=o.borderBoxSize,g=Array.isArray(h)?h[0]:h;l=g.inlineSize,u=g.blockSize}else{let h=e.getBoundingClientRect();l=h.width,u=h.height}i({width:l,height:u})});return r.observe(e,{box:"border-box"}),()=>{i(void 0),r.unobserve(e)}}},[e]),t}function R_(e,t){let i=Mn.get(e);return i===void 0?(Mn.set(e,{rect:{},callbacks:[t]}),Mn.size===1&&(pc=requestAnimationFrame(Lp))):(i.callbacks.push(t),t(e.getBoundingClientRect())),()=>{let r=Mn.get(e);if(r===void 0)return;let n=r.callbacks.indexOf(t);n>-1&&r.callbacks.splice(n,1),r.callbacks.length===0&&(Mn.delete(e),Mn.size===0&&cancelAnimationFrame(pc))}}var pc,Mn=new Map;function Lp(){let e=[];Mn.forEach((t,i)=>{let r=i.getBoundingClientRect();var n,o;n=t.rect,o=r,(n.width!==o.width||n.height!==o.height||n.top!==o.top||n.right!==o.right||n.bottom!==o.bottom||n.left!==o.left)&&(t.rect=r,e.push(t))}),e.forEach(t=>{t.callbacks.forEach(i=>i(t.rect))}),pc=requestAnimationFrame(Lp)}function Op(e){let[t,i]=ze();return fe(()=>{if(e){let r=R_(e,i);return()=>{i(void 0),r()}}},[e]),t}function $p(e,t=[]){let i=[],r=()=>{let n=i.map(o=>Kt(o));return function(o){let l=(o==null?void 0:o[e])||n;return Ae(()=>({[`__scope${e}`]:D(A({},o),{[e]:l})}),[o,l])}};return r.scopeName=e,[function(n,o){let l=Kt(o),u=i.length;function h(g){let f=g,{scope:y,children:S}=f,C=oe(f,["scope","children"]),_=(y==null?void 0:y[e][u])||l,T=Ae(()=>C,Object.values(C));return $(_.Provider,{value:T},S)}return i=[...i,o],h.displayName=n+"Provider",[h,function(g,f){let y=(f==null?void 0:f[e][u])||l,S=Yt(y);if(S)return S;if(o!==void 0)return o;throw new Error(`\`${g}\` must be used within \`${n}\``)}]},L_(r,...t)]}function L_(...e){let t=e[0];if(e.length===1)return t;let i=()=>{let r=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(n){let o=r.reduce((l,{useScope:u,scopeName:h})=>A(A({},l),u(n)[`__scope${h}`]),{});return Ae(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return i.scopeName=t.scopeName,i}function O_({anchorRect:e,popperSize:t,arrowSize:i,arrowOffset:r=0,side:n,sideOffset:o=0,align:l,alignOffset:u=0,shouldAvoidCollisions:h=!0,collisionBoundariesRect:g,collisionTolerance:f=0}){if(!e||!t||!g)return{popperStyles:$_,arrowStyles:gc};let y=(function(G,V,le=0,q=0,ne){let ge=ne?ne.height:0,de=Fp(V,G,"x"),we=Fp(V,G,"y"),me=we.before-le-ge,ce=we.after+le+ge,We=de.before-le-ge,ee=de.after+le+ge;return{top:{start:{x:de.start+q,y:me},center:{x:de.center,y:me},end:{x:de.end-q,y:me}},right:{start:{x:ee,y:we.start+q},center:{x:ee,y:we.center},end:{x:ee,y:we.end-q}},bottom:{start:{x:de.start+q,y:ce},center:{x:de.center,y:ce},end:{x:de.end-q,y:ce}},left:{start:{x:We,y:we.start+q},center:{x:We,y:we.center},end:{x:We,y:we.end-q}}}})(t,e,o,u,i),S=y[n][l];if(h===!1){let G=Mp(S),V=gc;return i&&(V=Np({popperSize:t,arrowSize:i,arrowOffset:r,side:n,align:l})),{popperStyles:D(A({},G),{"--radix-popper-transform-origin":zp(t,n,l,r,i)}),arrowStyles:V,placedSide:n,placedAlign:l}}let C=DOMRect.fromRect(A(A({},t),S)),_=(T=g,R=f,DOMRect.fromRect({width:T.width-2*R,height:T.height-2*R,x:T.left+R,y:T.top+R}));var T,R;let O=Bp(C,_),E=y[jp(n)][l],F=(function(G,V,le){let q=jp(G);return V[G]&&!le[q]?q:G})(n,O,Bp(DOMRect.fromRect(A(A({},t),E)),_)),z=(function(G,V,le,q,ne){let ge=le==="top"||le==="bottom",de=ge?"left":"top",we=ge?"right":"bottom",me=ge?"width":"height",ce=V[me]>G[me];return(q==="start"||q==="center")&&(ne[de]&&ce||ne[we]&&!ce)?"end":(q==="end"||q==="center")&&(ne[we]&&ce||ne[de]&&!ce)?"start":q})(t,e,n,l,O),U=Mp(y[F][z]),H=gc;return i&&(H=Np({popperSize:t,arrowSize:i,arrowOffset:r,side:F,align:z})),{popperStyles:D(A({},U),{"--radix-popper-transform-origin":zp(t,F,z,r,i)}),arrowStyles:H,placedSide:F,placedAlign:z}}function Fp(e,t,i){let r=e[i==="x"?"left":"top"],n=i==="x"?"width":"height",o=e[n],l=t[n];return{before:r-l,start:r,center:r+(o-l)/2,end:r+o-l,after:r+o}}function Mp(e){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(e.x+window.scrollX)}px, ${Math.round(e.y+window.scrollY)}px, 0)`}}function zp(e,t,i,r,n){let o=t==="top"||t==="bottom",l=n?n.width:0,u=n?n.height:0,h=l/2+r,g="",f="";return o?(g={start:`${h}px`,center:"center",end:e.width-h+"px"}[i],f=t==="top"?`${e.height+u}px`:-u+"px"):(g=t==="left"?`${e.width+u}px`:-u+"px",f={start:`${h}px`,center:"center",end:e.height-h+"px"}[i]),`${g} ${f}`}var $_={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},gc={position:"absolute",opacity:0};function Np({popperSize:e,arrowSize:t,arrowOffset:i,side:r,align:n}){let o=(e.width-t.width)/2,l=(e.height-t.width)/2,u={top:0,right:90,bottom:180,left:-90}[r],h=Math.max(t.width,t.height),g={width:`${h}px`,height:`${h}px`,transform:`rotate(${u}deg)`,willChange:"transform",position:"absolute",[r]:"100%",direction:F_(r,n)};return r!=="top"&&r!=="bottom"||(n==="start"&&(g.left=`${i}px`),n==="center"&&(g.left=`${o}px`),n==="end"&&(g.right=`${i}px`)),r!=="left"&&r!=="right"||(n==="start"&&(g.top=`${i}px`),n==="center"&&(g.top=`${l}px`),n==="end"&&(g.bottom=`${i}px`)),g}function F_(e,t){return(e!=="top"&&e!=="right"||t!=="end")&&(e!=="bottom"&&e!=="left"||t==="end")?"ltr":"rtl"}function jp(e){return{top:"bottom",right:"left",bottom:"top",left:"right"}[e]}function Bp(e,t){return{top:e.top<t.top,right:e.right>t.right,bottom:e.bottom>t.bottom,left:e.left<t.left}}var[Dp,Up]=$p("Popper"),[M_,Wp]=Dp("Popper"),z_=e=>{let{__scopePopper:t,children:i}=e,[r,n]=ze(null);return $(M_,{scope:t,anchor:r,onAnchorChange:n},i)},N_=li((e,t)=>{let i=e,{__scopePopper:r,virtualRef:n}=i,o=oe(i,["__scopePopper","virtualRef"]),l=Wp("PopperAnchor",r),u=ke(null),h=Co(t,u);return fe(()=>{l.onAnchorChange((n==null?void 0:n.current)||u.current)}),n?null:$(Rs.div,vi({},o,{ref:h}))}),[j_,B_]=Dp("PopperContent"),D_=li((e,t)=>{let i=e,{__scopePopper:r,side:n="bottom",sideOffset:o,align:l="center",alignOffset:u,collisionTolerance:h,avoidCollisions:g=!0}=i,f=oe(i,["__scopePopper","side","sideOffset","align","alignOffset","collisionTolerance","avoidCollisions"]),y=Wp("PopperContent",r),[S,C]=ze(),_=Op(y.anchor),[T,R]=ze(null),O=Rp(T),[E,F]=ze(null),z=Rp(E),U=Co(t,de=>R(de)),H=(function(){let[de,we]=ze(void 0);return fe(()=>{let me;function ce(){we({width:window.innerWidth,height:window.innerHeight})}function We(){window.clearTimeout(me),me=window.setTimeout(ce,100)}return ce(),window.addEventListener("resize",We),()=>window.removeEventListener("resize",We)},[]),de})(),G=H?DOMRect.fromRect(D(A({},H),{x:0,y:0})):void 0,{popperStyles:V,arrowStyles:le,placedSide:q,placedAlign:ne}=O_({anchorRect:_,popperSize:O,arrowSize:z,arrowOffset:S,side:n,sideOffset:o,align:l,alignOffset:u,shouldAvoidCollisions:g,collisionBoundariesRect:G,collisionTolerance:h}),ge=q!==void 0;return $("div",{style:V,"data-radix-popper-content-wrapper":""},$(j_,{scope:r,arrowStyles:le,onArrowChange:F,onArrowOffsetChange:C},$(Rs.div,vi({"data-side":q,"data-align":ne},f,{style:D(A({},f.style),{animation:ge?void 0:"none"}),ref:U}))))}),U_=li(function(e,t){let i=e,{__scopePopper:r,offset:n}=i,o=oe(i,["__scopePopper","offset"]),l=B_("PopperArrow",r),{onArrowOffsetChange:u}=l;return fe(()=>u(n),[u,n]),$("span",{style:D(A({},l.arrowStyles),{pointerEvents:"none"})},$("span",{ref:l.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},$(I_,vi({},o,{ref:t,style:D(A({},o.style),{display:"block"})}))))}),W_=z_,H_=N_,q_=D_,Q_=U_,Hp=e=>{let{present:t,children:i}=e,r=(function(l){let[u,h]=ze(),g=ke({}),f=ke(l),y=ke("none"),S=l?"mounted":"unmounted",[C,_]=(function(T,R){return ws((O,E)=>{let F=R[O][E];return F??O},T)})(S,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return fe(()=>{let T=Oo(g.current);y.current=C==="mounted"?T:"none"},[C]),ko(()=>{let T=g.current,R=f.current;if(R!==l){let O=y.current,E=Oo(T);l?_("MOUNT"):E==="none"||(T==null?void 0:T.display)==="none"?_("UNMOUNT"):_(R&&O!==E?"ANIMATION_OUT":"UNMOUNT"),f.current=l}},[l,_]),ko(()=>{if(u){let T=O=>{let E=Oo(g.current).includes(O.animationName);O.target===u&&E&&_("ANIMATION_END")},R=O=>{O.target===u&&(y.current=Oo(g.current))};return u.addEventListener("animationstart",R),u.addEventListener("animationcancel",T),u.addEventListener("animationend",T),()=>{u.removeEventListener("animationstart",R),u.removeEventListener("animationcancel",T),u.removeEventListener("animationend",T)}}},[u,_]),{isPresent:["mounted","unmountSuspended"].includes(C),ref:Ue(T=>{T&&(g.current=getComputedStyle(T)),h(T)},[])}})(t),n=typeof i=="function"?i({present:r.isPresent}):tn.only(i),o=Co(r.ref,n.ref);return typeof i=="function"||r.isPresent?bo(n,{ref:o}):null};function Oo(e){return(e==null?void 0:e.animationName)||"none"}Hp.displayName="Presence";function qp(e){let t=ke(e);return fe(()=>{t.current=e},[e]),t.current}function mc(e){let t=ke(e);return fe(()=>{t.current=e}),Ae(()=>(...i)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...i)},[])}function V_(e){let t=mc(e);fe(()=>{let i=r=>{r.key==="Escape"&&t(r)};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[t])}function G_({prop:e,defaultProp:t,onChange:i=()=>{}}){let[r,n]=(function({defaultProp:h,onChange:g}){let f=ze(h),[y]=f,S=ke(y),C=mc(g);return fe(()=>{S.current!==y&&(C(y),S.current=y)},[y,S,C]),f})({defaultProp:t,onChange:i}),o=e!==void 0,l=o?e:r,u=mc(i);return[l,Ue(h=>{if(o){let g=h,f=typeof h=="function"?g(e):h;f!==e&&u(f)}else n(h)},[o,e,n,u])]}function Ls(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(e==null||e(r),i===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}var[Qp]=$p("Tooltip",[Up]),$o=Up(),Y_=700,[JO,X_]=Qp("TooltipProvider",{isOpenDelayed:!0,delayDuration:Y_,onOpen:()=>{},onClose:()=>{}}),[Z_,Fo]=Qp("Tooltip"),K_=e=>{let{__scopeTooltip:t,children:i,open:r,defaultOpen:n=!1,onOpenChange:o,delayDuration:l}=e,u=X_("Tooltip",t),h=$o(t),[g,f]=ze(null),y=E_(),S=ke(0),C=l??u.delayDuration,_=ke(!1),{onOpen:T,onClose:R}=u,[O=!1,E]=G_({prop:r,defaultProp:n,onChange:H=>{H&&(document.dispatchEvent(new CustomEvent("tooltip.open")),T()),o==null||o(H)}}),F=Ae(()=>O?_.current?"delayed-open":"instant-open":"closed",[O]),z=Ue(()=>{window.clearTimeout(S.current),_.current=!1,E(!0)},[E]),U=Ue(()=>{window.clearTimeout(S.current),S.current=window.setTimeout(()=>{_.current=!0,E(!0)},C)},[C,E]);return fe(()=>()=>window.clearTimeout(S.current),[]),$(W_,h,$(Z_,{scope:t,contentId:y,open:O,stateAttribute:F,trigger:g,onTriggerChange:f,onTriggerEnter:Ue(()=>{u.isOpenDelayed?U():z()},[u.isOpenDelayed,U,z]),onOpen:Ue(z,[z]),onClose:Ue(()=>{window.clearTimeout(S.current),E(!1),R()},[E,R])},i))},J_=li((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=oe(i,["__scopeTooltip"]),o=Fo("TooltipTrigger",r),l=$o(r),u=Co(t,o.onTriggerChange),h=ke(!1),g=Ue(()=>h.current=!1,[]);return fe(()=>()=>document.removeEventListener("mouseup",g),[g]),$(H_,vi({asChild:!0},l),$(Rs.button,vi({"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute},n,{ref:u,onMouseEnter:Ls(e.onMouseEnter,o.onTriggerEnter),onMouseLeave:Ls(e.onMouseLeave,o.onClose),onMouseDown:Ls(e.onMouseDown,()=>{o.onClose(),h.current=!0,document.addEventListener("mouseup",g,{once:!0})}),onFocus:Ls(e.onFocus,()=>{h.current||o.onOpen()}),onBlur:Ls(e.onBlur,o.onClose),onClick:Ls(e.onClick,o.onClose)})))}),eS=li((e,t)=>{let i=e,{forceMount:r}=i,n=oe(i,["forceMount"]),o=Fo("TooltipContent",e.__scopeTooltip);return $(Hp,{present:r||o.open},$(tS,vi({ref:t},n)))}),tS=li((e,t)=>{let i=e,{__scopeTooltip:r,children:n,"aria-label":o,portalled:l=!0}=i,u=oe(i,["__scopeTooltip","children","aria-label","portalled"]),h=Fo("TooltipContent",r),g=$o(r),f=l?P_:Je,{onClose:y}=h;return V_(()=>y()),fe(()=>(document.addEventListener("tooltip.open",y),()=>document.removeEventListener("tooltip.open",y)),[y]),$(f,null,$(rS,{__scopeTooltip:r}),$(q_,vi({"data-state":h.stateAttribute},g,u,{ref:t,style:D(A({},u.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"})}),$(Jf,null,n),$(A_,{id:h.contentId,role:"tooltip"},o||n)))}),iS=li((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=oe(i,["__scopeTooltip"]),o=$o(r);return $(Q_,vi({},o,n,{ref:t}))});function rS(e){let{__scopeTooltip:t}=e,i=Fo("CheckTriggerMoved",t),r=Op(i.trigger),n=r==null?void 0:r.left,o=qp(n),l=r==null?void 0:r.top,u=qp(l),h=i.onClose;return fe(()=>{(o!==void 0&&o!==n||u!==void 0&&u!==l)&&h()},[h,o,u,n,l]),null}var nS=K_,sS=J_,aS=eS,oS=iS;function lS(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,o;for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function Dr(e,t){if(e==null)return{};var i=lS(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var Ii;(function(e){e[e.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",e[e.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",e[e.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",e[e.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",e[e.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",e[e.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",e[e.THEME_ERROR=6]="THEME_ERROR",e[e.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",e[e.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",e[e.EMPTY_KEY=9]="EMPTY_KEY"})(Ii||(Ii={}));var uS={[Ii.UNSUPPORTED_INPUT]:(e,t)=>[`An input with type \`${e}\` input was found at path \`${t}\` but it's not supported yet.`],[Ii.NO_COMPONENT_FOR_TYPE]:(e,t)=>[`Type \`${e}\` found at path \`${t}\` can't be displayed in panel because no component supports it yet.`],[Ii.UNKNOWN_INPUT]:(e,t)=>[`input at path \`${e}\` is not recognized.`,t],[Ii.DUPLICATE_KEYS]:(e,t,i)=>[`Key \`${e}\` of path \`${t}\` already exists at path \`${i}\`. Even nested keys need to be unique. Rename one of the keys.`],[Ii.ALREADY_REGISTERED_TYPE]:e=>[`Type ${e} has already been registered. You can't register a component with the same type.`],[Ii.CLIPBOARD_ERROR]:e=>["Error copying the value",e],[Ii.THEME_ERROR]:(e,t)=>[`Error accessing the theme \`${e}.${t}\` value.`],[Ii.PATH_DOESNT_EXIST]:e=>[`Error getting the value at path \`${e}\`. There is probably an error in your \`render\` function.`],[Ii.PATH_DOESNT_EXIST]:e=>[`Error accessing the value at path \`${e}\``],[Ii.INPUT_TYPE_OVERRIDE]:(e,t,i)=>[`Input at path \`${e}\` already exists with type: \`${t}\`. Its type cannot be overridden with type \`${i}\`.`],[Ii.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function Vp(e,t,...i){let[r,...n]=uS[t](...i);console[e]("LEVA: "+r,...n)}var Gp=Vp.bind(null,"warn");Vp.bind(null,"log");function cS(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Yp(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function zn(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Yp(Object(i),!0).forEach(function(r){cS(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yp(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var sn=(e,t,i)=>e>i?i:e<t?t:e,hS=e=>{if(e===""||typeof e=="number")return e;try{let t=an(e);if(!isNaN(t))return t}catch{}return parseFloat(e)},dS=Math.log(10);function Xp(e){let t=Math.abs(+String(e).replace(".",""));if(t===0)return .01;for(;t!==0&&t%10===0;)t/=10;let i=Math.floor(Math.log(t)/dS)+1,r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,r-i);return Math.max(n,.001)}var fS=(e,t,i)=>i===t?0:(sn(e,t,i)-t)/(i-t),Zp=(e,t,i)=>e*(i-t)+t,Kp=/\(([0-9+\-*/^ .]+)\)/,Jp=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,eg=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,tg=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,ig=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,rg=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function an(e){if(isNaN(Number(e)))if(Kp.test(e)){let t=e.replace(Kp,(i,r)=>String(an(r)));return an(t)}else if(Jp.test(e)){let t=e.replace(Jp,(i,r,n)=>String(Math.pow(Number(r),Number(n))));return an(t)}else if(eg.test(e)){let t=e.replace(eg,(i,r,n)=>String(Number(r)*Number(n)));return an(t)}else if(tg.test(e)){let t=e.replace(tg,(i,r,n)=>{if(n!=0)return String(Number(r)/Number(n));throw new Error("Division by zero")});return an(t)}else if(ig.test(e)){let t=e.replace(ig,(i,r,n)=>String(Number(r)+Number(n)));return an(t)}else if(rg.test(e)){let t=e.replace(rg,(i,r,n)=>String(Number(r)-Number(n)));return an(t)}else return Number(e);return Number(e)}var ng;(function(e){e.BUTTON="BUTTON",e.BUTTON_GROUP="BUTTON_GROUP",e.MONITOR="MONITOR",e.FOLDER="FOLDER"})(ng||(ng={}));var sg;(function(e){e.SELECT="SELECT",e.IMAGE="IMAGE",e.NUMBER="NUMBER",e.COLOR="COLOR",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.INTERVAL="INTERVAL",e.VECTOR3D="VECTOR3D",e.VECTOR2D="VECTOR2D"})(sg||(sg={}));var pS=e=>e.shiftKey?5:e.altKey?1/5:1,gS=["value"],mS=["min","max"],vS=e=>{if(typeof e=="number")return!0;if(typeof e=="string"){let t=parseFloat(e);return isNaN(t)?!1:e.substring((""+t).length).trim().length<4}return!1},yS=(e,{min:t=-1/0,max:i=1/0,suffix:r})=>{let n=parseFloat(e);if(e===""||isNaN(n))throw Error("Invalid number");let o=sn(n,t,i);return r?o+r:o},bS=(e,{pad:t=0,suffix:i})=>{let r=parseFloat(e).toFixed(t);return i?r+i:r},wS=e=>{let{value:t}=e,i=Dr(e,gS),{min:r=-1/0,max:n=1/0}=i,o=Dr(i,mS),l=parseFloat(t),u=typeof t=="string"?t.substring((""+l).length):void 0;l=sn(l,r,n);let h=i.step;h||(Number.isFinite(r)?Number.isFinite(n)?h=+(Math.abs(n-r)/100).toPrecision(1):h=+(Math.abs(l-r)/100).toPrecision(1):Number.isFinite(n)&&(h=+(Math.abs(n-l)/100).toPrecision(1)));let g=h?Xp(h)*10:Xp(l);h=h||g/10;let f=Math.round(sn(Math.log10(1/g),0,2));return{value:u?l+u:l,settings:zn({initialValue:l,step:h,pad:f,min:r,max:n,suffix:u},o)}},ag=(e,{step:t,initialValue:i})=>{let r=Math.round((e-i)/t);return i+r*t},xS=Object.freeze({__proto__:null,schema:vS,sanitize:yS,format:bS,normalize:wS,sanitizeStep:ag});function Qi(){return Qi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Qi.apply(this,arguments)}var _S=Kt({});function Ur(){return Yt(_S)}var SS=Kt(null);Kt(null);var ES=Kt(null);function CS(){return Yt(ES)}var kS=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function Mo(e,t){let[i,r]=e.split(" "),n={};return i!=="none"&&(n.boxShadow=`${t.inset?"inset ":""}0 0 0 $borderWidths${[t.key]} $colors${i!=="default"&&i||t.borderColor}`),r&&(n.backgroundColor=r),n}var xa={$inputStyle:()=>e=>Mo(e,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>e=>Mo(e,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>e=>Mo(e,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>e=>Mo(e,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:ht,css:e$,createTheme:t$,globalCss:AS,keyframes:i$}=P1({prefix:"leva",theme:kS(),utils:zn(zn({},xa),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:e=>({"&:focus":xa.$focusStyle()(e)}),$focusWithin:e=>({"&:focus-within":xa.$focusStyle()(e)}),$hover:e=>({"&:hover":xa.$hoverStyle()(e)}),$active:e=>({"&:active":xa.$activeStyle()(e)})})});AS({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function PS(e,t){let{theme:i}=Yt(SS);if(!(e in i)||!(t in i[e]))return Gp(Ii.THEME_ERROR,e,t),"";let r=t;for(;;){let n=i[e][r];if(typeof n=="string"&&n.charAt(0)==="$")r=n.substr(1);else return n}}var og=ht("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),lg=ht("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${og}`]:{paddingLeft:0}}),TS=ht(lg,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),IS=ht("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),RS=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],LS=["onUpdate"];function ug(e){let{innerLabel:t,value:i,onUpdate:r,onChange:n,onKeyDown:o,type:l,id:u,inputType:h="text",rows:g=0}=e,f=Dr(e,RS),{id:y,emitOnEditStart:S,emitOnEditEnd:C,disabled:_}=Ur(),T=u||y,R=ke(null),O=g>0,E=O?"textarea":"input",F=Ue(H=>G=>{let V=G.currentTarget.value;H(V)},[]);J.useEffect(()=>{let H=R.current,G=F(V=>{r(V),C()});return H==null||H.addEventListener("blur",G),()=>H==null?void 0:H.removeEventListener("blur",G)},[F,r,C]);let z=Ue(H=>{H.key==="Enter"&&F(r)(H)},[F,r]),U=Object.assign({as:E},O?{rows:g}:{},f);return J.createElement(IS,{textArea:O},t&&typeof t=="string"?J.createElement(lg,null,t):t,J.createElement(og,Qi({levaType:l,ref:R,id:T,type:h,autoComplete:"off",spellCheck:"false",value:i,onChange:F(n),onFocus:()=>S(),onKeyPress:z,onKeyDown:o,disabled:_},U)))}function OS(e){let{onUpdate:t}=e,i=Dr(e,LS),r=Ue(o=>t(hS(o)),[t]),n=Ue(o=>{let l=o.key==="ArrowUp"?1:o.key==="ArrowDown"?-1:0;if(l){o.preventDefault();let u=o.altKey?.1:o.shiftKey?10:1;t(h=>parseFloat(h)+l*u)}},[t]);return J.createElement(ug,Qi({},i,{onUpdate:r,onKeyDown:n,type:"number"}))}var vc=ht("div",{}),cg=ht("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]});ht("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${cg}::after`]:{opacity:.6},[`${vc}:hover > & + ${cg}::after`]:{opacity:.6},[`${vc}:hover > & > svg`]:{opacity:1}});var $S=ht("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${vc}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),hg=ht("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${$S} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),FS=ht(hg,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),MS=ht("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),zS=ht("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),yc=ht("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}});ht("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${yc}`]:{pointerEvents:"auto"}}}}}),ht("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"});var NS=ht("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),jS=ht(oS,{fill:"$toolTipBackground"}),BS=["align"];function DS(){let{id:e,disable:t,disabled:i}=Ur();return J.createElement(J.Fragment,null,J.createElement(zS,{id:e+"__disable",type:"checkbox",checked:!i,onChange:()=>t(!i)}),J.createElement("label",{htmlFor:e+"__disable"}))}function US(e){let{id:t,optional:i,hint:r}=Ur(),n=e.htmlFor||(t?{htmlFor:t}:null),o=!r&&typeof e.children=="string"?{title:e.children}:null;return J.createElement(J.Fragment,null,i&&J.createElement(DS,null),r!==void 0?J.createElement(nS,null,J.createElement(sS,{asChild:!0},J.createElement(yc,Qi({},n,e))),J.createElement(aS,{side:"top",sideOffset:2},J.createElement(NS,null,r,J.createElement(jS,null)))):J.createElement(yc,Qi({},n,o,e)))}function zo(e){let{align:t}=e,i=Dr(e,BS),{value:r,label:n,key:o,disabled:l}=Ur(),{hideCopyButton:u}=CS(),h=!u&&o!==void 0,[g,f]=ze(!1),y=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[o]:r??""})),f(!0)}catch{Gp(Ii.CLIPBOARD_ERROR,{[o]:r})}};return J.createElement(MS,{align:t,onPointerLeave:()=>f(!1)},J.createElement(US,i),h&&!l&&J.createElement("div",{title:`Click to copy ${typeof n=="string"?n:o} value`},g?J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},J.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),J.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):J.createElement("svg",{onClick:y,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},J.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),J.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}var WS=["toggled"],HS=ht("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function qS(e){let{toggled:t}=e,i=Dr(e,WS);return J.createElement(HS,Qi({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${t?0:-90}deg)`}},i),J.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}var QS=["input"];function No(e){let{input:t}=e,i=Dr(e,QS);return t?J.createElement(FS,i):J.createElement(hg,i)}function dg(e,t){let{emitOnEditStart:i,emitOnEditEnd:r}=Ur();return x_(n=>{n.first&&(document.body.classList.add("leva__panel__dragged"),i==null||i());let o=e(n);return n.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),o})}var VS=ht("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),GS=ht("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),YS=ht("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),XS=ht("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),ZS=ht("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function KS({value:e,min:t,max:i,onDrag:r,step:n,initialValue:o}){let l=ke(null),u=ke(null),h=ke(0),g=PS("sizes","scrubberWidth"),f=dg(({event:S,first:C,xy:[_],movement:[T],memo:R})=>{if(C){let{width:E,left:F}=l.current.getBoundingClientRect();h.current=E-parseFloat(g),R=(S==null?void 0:S.target)===u.current?e:Zp((_-F)/E,t,i)}let O=R+Zp(T/h.current,0,i-t);return r(ag(O,{step:n,initialValue:o})),R}),y=fS(e,t,i);return J.createElement(XS,Qi({ref:l},f()),J.createElement(GS,null,J.createElement(ZS,{style:{left:0,right:`${(1-y)*100}%`}})),J.createElement(YS,{ref:u,style:{left:`calc(${y} * (100% - ${g}))`}}))}var JS=J.memo(({label:e,onUpdate:t,step:i,innerLabelTrim:r})=>{let[n,o]=ze(!1),l=dg(({active:u,delta:[h],event:g,memo:f=0})=>(o(u),f+=h/2,Math.abs(f)>=1&&(t(y=>parseFloat(y)+Math.floor(f)*i*pS(g)),f=0),f));return J.createElement(TS,Qi({dragging:n,title:e.length>1?e:""},l()),e.slice(0,r))});function eE({label:e,id:t,displayValue:i,onUpdate:r,onChange:n,settings:o,innerLabelTrim:l=1}){let u=l>0&&J.createElement(JS,{label:e,step:o.step,onUpdate:r,innerLabelTrim:l});return J.createElement(OS,{id:t,value:String(i),onUpdate:r,onChange:n,innerLabel:u})}function tE(){let e=Ur(),{label:t,value:i,onUpdate:r,settings:n,id:o}=e,{min:l,max:u}=n,h=u!==1/0&&l!==-1/0;return J.createElement(No,{input:!0},J.createElement(zo,null,t),J.createElement(VS,{hasRange:h},h&&J.createElement(KS,Qi({value:parseFloat(i),onDrag:r},n)),J.createElement(eE,Qi({},e,{id:o,label:"value",innerLabelTrim:h?0:1}))))}var iE=Dr(xS,["sanitizeStep"]);zn({component:tE},iE);var rE=(e,t)=>nn().schema({options:nn().passesAnyOf(nn().object(),nn().array())}).test(t),nE=(e,{values:t})=>{if(t.indexOf(e)<0)throw Error("Selected value doesn't match Select options");return e},sE=(e,{values:t})=>t.indexOf(e),aE=e=>{let{value:t,options:i}=e,r,n;return Array.isArray(i)?(n=i,r=i.map(o=>String(o))):(n=Object.values(i),r=Object.keys(i)),"value"in e?n.includes(t)||(r.unshift(String(t)),n.unshift(t)):t=n[0],Object.values(i).includes(t)||(i[String(t)]=t),{value:t,settings:{keys:r,values:n}}},oE=Object.freeze({__proto__:null,schema:rE,sanitize:nE,format:sE,normalize:aE}),lE=ht("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),bc=ht("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),uE=ht("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${bc}:focus + &`]:{$focusStyle:""},[`${bc}:hover + &`]:{$hoverStyle:""}});function cE({displayValue:e,value:t,onUpdate:i,id:r,settings:n,disabled:o}){let{keys:l,values:u}=n,h=ke();return t===u[e]&&(h.current=l[e]),J.createElement(lE,null,J.createElement(bc,{id:r,value:e,onChange:g=>i(u[Number(g.currentTarget.value)]),disabled:o},l.map((g,f)=>J.createElement("option",{key:g,value:f},g))),J.createElement(uE,null,h.current),J.createElement(qS,{toggled:!0}))}function hE(){let{label:e,value:t,displayValue:i,onUpdate:r,id:n,disabled:o,settings:l}=Ur();return J.createElement(No,{input:!0},J.createElement(zo,null,e),J.createElement(cE,{id:n,value:t,displayValue:i,onUpdate:r,settings:l,disabled:o}))}zn({component:hE},oE);var dE=e=>nn().string().test(e),fE=e=>{if(typeof e!="string")throw Error("Invalid string");return e},pE=({value:e,editable:t=!0,rows:i=!1})=>({value:e,settings:{editable:t,rows:typeof i=="number"?i:i?5:0}}),gE=Object.freeze({__proto__:null,schema:dE,sanitize:fE,normalize:pE}),mE=["displayValue","onUpdate","onChange","editable"],vE=ht("div",{whiteSpace:"pre-wrap"});function yE(e){let{displayValue:t,onUpdate:i,onChange:r,editable:n=!0}=e,o=Dr(e,mE);return n?J.createElement(ug,Qi({value:t,onUpdate:i,onChange:r},o)):J.createElement(vE,null,t)}function bE(){let{label:e,settings:t,displayValue:i,onUpdate:r,onChange:n}=Ur();return J.createElement(No,{input:!0},J.createElement(zo,null,e),J.createElement(yE,Qi({displayValue:i,onUpdate:r,onChange:n},t)))}zn({component:bE},gE);var wE=e=>nn().boolean().test(e),xE=e=>{if(typeof e!="boolean")throw Error("Invalid boolean");return e},_E=Object.freeze({__proto__:null,schema:wE,sanitize:xE}),SE=ht("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function EE({value:e,onUpdate:t,id:i,disabled:r}){return J.createElement(SE,null,J.createElement("input",{id:i,type:"checkbox",checked:e,onChange:n=>t(n.currentTarget.checked),disabled:r}),J.createElement("label",{htmlFor:i},J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},J.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function CE(){let{label:e,value:t,onUpdate:i,disabled:r,id:n}=Ur();return J.createElement(No,{input:!0},J.createElement(zo,null,e),J.createElement(EE,{value:t,onUpdate:i,id:n,disabled:r}))}zn({component:CE},_E),ht("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});var on=class extends _r{constructor(e){super(),this.type="spacial-content",this.style={opacity:1},this.format="jpg",this.tileUrl=Yx(e.url),this.id=e.id||`${this.tileUrl}--${e.scaleFactor}`,this.points=e.displayPoints?e.displayPoints:jr(e.points,rn(e.scaleFactor)),this.tileWidth=e.tileWidth,this.display={x:0,y:0,width:e.width/e.scaleFactor,height:e.height/e.scaleFactor,points:e.points,scale:e.scaleFactor},e.format&&(this.format=e.format)}applyProps(e){if(e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.service!==this.service&&(this.service=e.service),e.format?this.format=e.format:this.format="jpg",e.crop){this.cropData=e.crop;let t=Le([...this.points]),i=t.length/5,r=e.crop.x||0,n=e.crop.y||0,o=e.crop.x+e.crop.width,l=e.crop.y+e.crop.height;for(let u=0;u<i;u++){let h=u*5;t[h+1]<o&&t[h+3]>r&&t[h+2]<l&&t[h+4]>n?(t[h+1]=sn(t[h+1],r,o),t[h+3]=sn(t[h+3],r,o),t[h+2]=sn(t[h+2],n,l),t[h+4]=sn(t[h+4],n,l)):t[h]=0}xr(t,Pi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(t):this.crop=t}}static fromTile(e,t,i,r,n,o,l){i.height=i.height?i.height:i.width;let u=l?Math.floor(t.width/r):Math.ceil(t.width/r),h=l?Math.floor(t.height/r):Math.ceil(t.height/r),g=Math.ceil(u/i.width),f=Math.ceil(h/i.height),y=it.grid(g,f),S=it.grid(g,f);for(let _=0;_<f;_++)for(let T=0;T<g;T++){let R=T*i.width,O=_*i.height;S.addPoints(R*r,O*r,T===g-1?t.width:(R+i.width)*r,_===f-1?t.height:(O+i.height)*r),y.addPoints(R,O,T===g-1?u:R+i.width,_===f-1?h:O+i.height)}let C=new on({url:e,scaleFactor:r,points:y.build(),displayPoints:S.build(),width:t.width,height:t.height,tileWidth:i.width,format:o});return C.applyProps({service:n}),C}getImageUrl(e){let t=this.points.slice(e*5,e*5+5),i=t[3]-t[1],r=t[4]-t[2],n=Math.ceil(i/this.display.scale);return`${this.tileUrl}/${t[1]},${t[2]},${i},${r}/${n>this.tileWidth?this.tileWidth:n},/0/default.${this.format||"jpg"}`}getAllPointsAt(e,t,i){let r=pa(this.crop||this.points,e);return[[this,r,t]]}transform(e){xr(this.points,e)}getScheduledUpdates(e,t){return[]}},kE=class extends _r{constructor(){super(...arguments),this.type="spacial-content"}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},wc=class extends kE{constructor(e){super(),this.images=[],this.allImages=[],this.scaleFactors=[],this.aggregateBuffer=Le(9),this.isFullyLoaded=!1,this.maxScaleFactor=0,this._scheduleSortByScales=!1,this._sortByScales=()=>{this._scheduleSortByScales=!1,this.allImages.sort((i,r)=>r.display.width-i.display.width),this.images=[];let t=.1;for(let i of this.allImages)if(!(i.display.width<this.renderOptions.minSize&&i.display.height<this.renderOptions.minSize&&!i.priority||i instanceof ur&&(i.display.width>this.renderOptions.maxImageSize||i.display.height>this.renderOptions.maxImageSize)&&!i.priority)){if(Math.abs(i.display.scale-t)<.25||i.priority){let r=this.images.pop();r&&(r instanceof ur||r.priority)?(i.priority&&this.images.push(i),this.images.push(r)):i&&this.images.push(i)}else i&&this.images.push(i);t=i.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(i=>i.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)},this.loadFullResource=async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let t=await this.lazyLoader();this.addImages(t)}},this.fallback=[this.loadFullResource],this.id=e.id,this.points=it.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:it.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=A({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(t=>t!==e),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(this.images.length===0)return[];let r=Gx(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,o=t?Nr(t,Pi(this.x,this.y)):Pi(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let l=[];for(let g=n-1;g>=r;g--)l.push(g);let u=l[0];this.renderOptions.renderLayers&&(l=l.slice(-Math.min(l.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&l.indexOf(u)===-1&&l.unshift(u);let h=[];for(let g=0;g<l.length;g++)h.push(...this.images[l[g]].getAllPointsAt(e,o,i));return h}return this.images[r].getAllPointsAt(e,o,i)}};function jo(e,t,i,r,n){let o=Math.PI/180*n,l=Math.cos(o),u=Math.sin(o),h=l*(i-e)+u*(r-t)+e,g=l*(r-t)-u*(i-e)+t;return[h,g]}var Os=class extends _r{constructor(e,t){super(),this.type="world-object",this.intersectionBuffer=Le(5),this.aggregateBuffer=Le(9),this.invertedBuffer=Le(9),this.rotation=0,this._updatedList=[];let{x:i=0,y:r=0}=t||{};e?(this.id=e.id||"",this.scale=1,this.layers=e.layers,this.points=Le([1,i,r,i+e.width,r+e.height]),this.worldPoints=Le([1,i,r,i+e.width,r+e.height]),this.filteredPointsBuffer=Le(e.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Le(5),this.worldPoints=Le(5),this.filteredPointsBuffer=Le(5))}static createWithProps(e){let t=new Os;return t.applyProps(e),t}applyProps(e){let t=e.x||0,i=e.y||0;this.id=e.id;let r=typeof e.scale<"u"?e.scale:this.scale;this.points[0]=1,this.points[1]=t,this.points[2]=i,this.points[3]=t+e.width,this.points[4]=i+e.height,this.rotation=e.rotation||0,this.worldPoints[3]=this.worldPoints[1]+e.width,this.worldPoints[4]=this.worldPoints[2]+e.height,e.scale&&e.scale!==1&&this.atScale(r),this.scale=r}appendChild(e){e.points[0]===0&&e.points.set(this.points),e.__owner.value=this,this.addLayers([e])}removeChild(e){this.layers=this.layers.filter(t=>t!==e),this.filteredPointsBuffer=Le(this.layers.length*5)}insertBefore(e,t){let i=this.layers.indexOf(t);if(i===-1||this.layers.indexOf(e)!==-1)return;let r=this.layers.slice(0,i),n=this.layers.slice(i);this.layers=[...r,e,...n]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(e,t){if(this.rotation&&(e=this.applyRotation(e)),pa(this.points,e,this.filteredPointsBuffer)[0]===0)return[];let i=this.layers.length,r=[];for(let n=0;n<i;n++){let o=this.layers[n];if(t&&o.isShape){let l=jr(o.points,Pi(this.x,this.y));if(!o.intersects([e[1]-l[1],e[2]-l[2]]))continue}if(pa(jr(o.points,Pi(this.x,this.y)),e,this.filteredPointsBuffer)[0]!==0&&r.push(o),t){let l=o;r.push(...l.getObjectsAt(e,t))}}return r}applyRotation(e){if(this.rotation){let t={x:e[1],y:e[2]},i={x:e[1],y:e[4]},r={x:e[3],y:e[2]},n={x:e[3],y:e[4]},o=this.points[1]+(this.points[3]-this.points[1])/2,l=this.points[2]+(this.points[4]-this.points[2])/2,[u,h]=jo(o,l,t.x,t.y,this.rotation),[g,f]=jo(o,l,i.x,i.y,this.rotation),[y,S]=jo(o,l,r.x,r.y,this.rotation),[C,_]=jo(o,l,n.x,n.y,this.rotation),T=Math.min(u,g,y,C),R=Math.max(u,g,y,C),O=Math.min(h,f,S,_),E=Math.max(h,f,S,_);return Le([e[0],T,O,R,E])}return e}getAllPointsAt(e,t,i){let r=Nr(Pi(this.x,this.y),rn(this.scale),this.aggregateBuffer);this.rotation&&(e=this.applyRotation(e));let n=Qx(e,this.points,this.intersectionBuffer),o=this.layers.length,l=[],u=jr(n,Nr(rn(1/this.scale),Pi(-this.x,-this.y),this.invertedBuffer)),h=t?Nr(t,r,this.aggregateBuffer):r,g=i*this.scale;for(let f=0;f<o;f++)l.push(...this.layers[f].getAllPointsAt(u,h,g));return l}addLayers(e){let t=[];for(let i of e)this.layers.indexOf(i)===-1&&(t.push(i),i.points.length===5&&(i.points[1]<this.worldPoints[1]/this.scale||i.points[2]<this.worldPoints[2]/this.scale||i.points[3]>this.worldPoints[3]/this.scale||i.points[4]>this.worldPoints[4]/this.scale)&&(i.crop=i.crop||Le([1,Math.max(this.worldPoints[1]/this.scale,i.points[1]),Math.max(this.worldPoints[2]/this.scale,i.points[2]),Math.min(this.worldPoints[3]/this.scale,i.points[3]),Math.min(this.worldPoints[4]/this.scale,i.points[4])])));this.layers=this.layers.concat(t),this.filteredPointsBuffer=Le(this.layers.length*5)}getScheduledUpdates(e,t){let i=this.layers.length;this._updatedList=[];let r=t*this.scale;for(let n=0;n<i;n++){let o=this.layers[n].getScheduledUpdates(e,r);o&&this._updatedList.push(...o)}return this._updatedList}},ln=class extends _r{constructor(e=0,t=0,i=100,r="left-to-right"){super(),this.id="world",this.aggregateBuffer=Le(9),this.isDirty=!1,this.zones=[],this.triggerQueue=[],this.activatedEvents=[],this._updatedList=[],this.translationBuffer=Le(9),this.needsRecalculate=!0,this.emptyPaintables=[],this.renderOrder=[],this.objects=[],this.subscriptions=[],this._propagateEventTargets=[],this._alreadyFlushed=[],this._width=e,this._height=t,this.aspectRatio=Number.isNaN(e/t)?1:e/t,this.viewingDirection=r,this.points=Le(i*5),this.filteredPointsBuffer=Le(i*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(e){let t=new ln;return t.applyProps(e),t}applyProps(e){typeof e.width<"u"&&typeof e.height<"u"&&(e.width!==this._width||e.height!==this._height)&&this.resize(e.width,e.height),e.viewingDirection!==this.viewingDirection&&(this.viewingDirection=e.viewingDirection,this.triggerRepaint())}propagateTouchEvent(e,t,i){let r=[];for(let n of i)if(n.x&&n.y){let o=it.singleBox(1,1,n.x,n.y);r.push(this.getObjectsAt(o,!0).reverse())}return r.map(n=>this.propagateEvent(e,t,n,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(e,t,i,r,n={}){let o=it.singleBox(1,1,i,r),l=this.getObjectsAt(o,!0).reverse();return this.propagateEvent(e,t,l,n)}propagateEvent(e,t,i,{bubbles:r=!1,cancelable:n=!1}={}){t.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let o=!1;t.stopPropagation=()=>{o=!0};let l=i.length;for(let g=l-1;g>=0;g--){this._propagateEventTargets.unshift(i[g][0]);let f=i[g][1].length;if(f)for(let y=0;y<f;y++)this._propagateEventTargets.unshift(i[g][1][y])}let u=this._propagateEventTargets.length,h=!1;for(let g=0;g<u&&(t.atlasTarget=this._propagateEventTargets[g],t.atlasWorld=this,h=this._propagateEventTargets[g].dispatchEvent(e,t)||h,!o);g++);return h&&this.triggerRepaint(),this._propagateEventTargets}appendChild(e){let t=this.appendWorldObject(e);this.renderOrder.push(t/5)}removeChild(e){let t=this.objects.indexOf(e);if(t===-1){for(let i of this.objects)if(i&&i.id===e.id){this.removeChild(i);return}return}this.objects[t]=null,this.renderOrder=this.renderOrder.filter(i=>i!==t),this.points[t*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(e,t){let i=this.objects.indexOf(t);if(i===-1)return;let r=this.appendWorldObject(e);this.renderOrder.splice(i-1,0,r/5)}hideInstance(){}asWorldObject(){return null}addZone(e){this.zones.push(e)}selectZone(e){if(typeof e=="string"){let t=this.zones.length;for(let i=0;i<t;i++)if(this.zones[i].id===e){this.selectedZone=i,this.trigger("zone-changed");return}}else this.zones[e]&&(this.selectedZone=e,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(Vx(this.points)===this.objects.length){let e=this.points,t=Le(this.points.length*2);t.set(e,0),this.points=t}}appendWorldObject(e){this.checkResizeInternalBuffer();let t=this.objects.length*5,i=e.points;return e.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),e.points[1]=i[1],e.points[2]=i[2],e.points[3]=i[3],e.points[4]=i[4],this.objects.push(e),this.filteredPointsBuffer=Le(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),t}recalculateWorldSize(){let e=!1;if(this.needsRecalculate){let t=new Int32Array(this.objects.length),i=new Int32Array(this.objects.length),r=this.renderOrder.length;for(let l=0;l<r;l++){let u=this.renderOrder[l];this.objects[u]&&(t[l]=this.points[u*5+3],i[l]=this.points[u*5+4])}let n=Math.max(...t);n!==this._width&&(this._width=n,e=!0);let o=Math.max(...i);o!==this._height&&(this._height=o,e=!0),e&&this.trigger("recalculate-world-size",{width:n,height:o}),this.needsRecalculate=!1}return e}addObjectAt(e,t){t.width&&!t.height?t.height=t.width/e.width*e.height:t.height&&!t.width&&(t.width=t.height/e.height*e.width),(!t||!t.width||!t.height)&&(t.width=e.width,t.height=e.height);let{width:i,x:r,y:n}=t,o=i/e.width;this.checkResizeInternalBuffer(),this.points.set(it.singleBox(e.width,e.height,0,0),this.objects.length*5);let l=new Os(e);return l.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(l),this.scaleWorldObject(this.objects.length-1,o),this.translateWorldObject(this.objects.length-1,r,n),this.filteredPointsBuffer=Le(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,l}scaleWorldObject(e,t){xr(this.points.subarray(e*5,e*5+5),ga(t,this.points[e*5+1],this.points[e*5+2]));let i=this.objects[e];i&&(i.atScale(t),this.triggerRepaint())}translateWorldObject(e,t,i){xr(this.points.subarray(e*5,e*5+5),Pi(t,i));let r=this.objects[e];r&&(r.translate(t,i),this.triggerRepaint())}resize(e,t){return this._width=e,this._height=t,this.aspectRatio=e/t,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(e,t){let i=it.singleBox(e.width,e.height,e.x,e.y);return this.getPointsAt(i,t,e.scale)}addLayoutSubscriber(e){return this.subscriptions.push(e),()=>{this.subscriptions.splice(this.subscriptions.indexOf(e),1)}}getScheduledUpdates(e,t){let i=pa(this.points,e,this.filteredPointsBuffer),r=this.objects.length;this._updatedList=[];for(let n=0;n<r;n++)if(i[n*5]!==0){if(!this.objects[n])continue;this._updatedList.push(...this.objects[n].getScheduledUpdates(e,t))}return this._updatedList}getObjectsAt(e,t=!1){let i=this.getActiveZone(),r=pa(this.points,e,this.filteredPointsBuffer),n=this.renderOrder.length,o=[];for(let l=0;l<n;l++){let u=this.renderOrder[l];if(r[u*5]!==0){let h=this.objects[u];if(!h||i&&i.objects.indexOf(h)===-1)continue;if(h.type!=="world-object"){o.push([h,[h]]);continue}t?o.push([h,h.getObjectsAt(e,t)]):o.push([h,this.emptyPaintables])}}return o}getPointsAt(e,t,i=1){let r=this.getObjectsAt(e),n=Nr(rn(i),Pi(-e[1],-e[2]),this.translationBuffer),o=t?Nr(t,n,this.aggregateBuffer):n,l=r.length,u=[];for(let h=0;h<l;h++)r[h]&&u.push(...r[h][0].getAllPointsAt(e,o,i));return u}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let e=this.triggerQueue.length;for(let t=0;t<e;t++){if(this._alreadyFlushed.indexOf(this.triggerQueue[t][0])!==-1)continue;typeof this.triggerQueue[t][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[t][0]);let i=this.subscriptions.length;for(let r=0;r<i;r++)this.subscriptions[r].apply(null,this.triggerQueue[t])}this.triggerQueue=[]}}trigger(e,t){this.triggerQueue.push([e,t])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(e){this.trigger("goto-region",e)}goHome(e=!1){this.trigger("go-home",{immediate:e})}zoomTo(e,t,i){this.trigger("zoom-to",{point:t,factor:e,stream:i})}zoomIn(e){this.trigger("zoom-to",{point:e,factor:.5})}zoomOut(e){this.trigger("zoom-to",{point:e,factor:2})}constraintBounds(e){this.trigger("constrain-bounds",{immediate:e})}},Bo=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Do={},AE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],$s=class extends _r{constructor(){super(),this.type="spacial-content",this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Le(5)},this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=_o(12),this.points=Le(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Do[i]||Bo.exec(i)||Bo.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Do[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Do[e.style.outline]||Bo.exec(e.style.outline)||Bo.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Do[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of AE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=it.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=it.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},Uo=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Wo={},PE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],fg=class extends _r{constructor(){super(),this.type="spacial-content",this.isShape=!0,this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Le(5)},this.boundingBox=null,this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.shape={type:"none"},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=_o(12),this.points=Le(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(o=>o[0])),i=Math.min(...e.map(o=>o[1])),r=Math.max(0,...e.map(o=>o[0])),n=Math.max(0,...e.map(o=>o[1]));this.boundingBox={x:t,y:i,width:r-t,height:n-i};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let o=!1;for(let l=0,u=r.length-1;l<r.length;u=l++)r[l][1]>i!=r[u][1]>i&&t<(r[u][0]-r[l][0])*(i-r[l][1])/(r[u][1]-r[l][1])+r[l][0]&&(o=!o);return o}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let i=!1,r=e.points.length;for(let n=0;n<r;n++)if(e.points[n][0]!==this.shape.points[n][0]||e.points[n][1]!==this.shape.points[n][1]){i=!0;break}i&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Wo[i]||Uo.exec(i)||Uo.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Wo[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Wo[e.style.outline]||Uo.exec(e.style.outline)||Uo.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Wo[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of PE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=it.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=it.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},_a=class extends _r{constructor(){super(),this.type="spacial-content",this.color="#000",this.text="",this.display={x:0,y:0,scale:1,width:100,height:100,points:Le(5)},this.interactive=!1,this.props={font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1},this.id="",this.points=Le(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:o,backgroundColor:l,fontSize:u=18,interactive:h,fontFamily:g="Arial, sans-serif"}=t,f=oe(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);f.font=`${u}px ${g}`,this.interactive=h||!1,typeof n<"u"&&(this.text=n||""),o&&(this.color=o),l&&(this.backgroundColor=l),i&&(this.id=i),r&&(this.points=it.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=A(A({},this.props),f),this.__revision++}},Rt=Math.pow,Ho=Math.sqrt,Sa=Math.sin,pg=Math.cos,Ea=Math.PI,qo=1.70158,Qo=qo*1.525,gg=qo+1,mg=2*Ea/3,vg=2*Ea/4.5,Vo=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},Er={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Rt(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Rt(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Rt(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Rt(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Rt(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Rt(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Rt(-2*e+2,5)/2},easeInSine:function(e){return 1-pg(e*Ea/2)},easeOutSine:function(e){return Sa(e*Ea/2)},easeInOutSine:function(e){return-(pg(Ea*e)-1)/2},easeInExpo:function(e){return e===0?0:Rt(2,10*e-10)},easeOutExpo:function(e){return e===1?1:1-Rt(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?Rt(2,20*e-10)/2:(2-Rt(2,-20*e+10))/2},easeInCirc:function(e){return 1-Ho(1-Rt(e,2))},easeOutCirc:function(e){return Ho(1-Rt(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-Ho(1-Rt(2*e,2)))/2:(Ho(1-Rt(-2*e+2,2))+1)/2},easeInBack:function(e){return gg*e*e*e-qo*e*e},easeOutBack:function(e){return 1+gg*Rt(e-1,3)+qo*Rt(e-1,2)},easeInOutBack:function(e){return e<.5?Rt(2*e,2)*((Qo+1)*2*e-Qo)/2:(Rt(2*e-2,2)*((Qo+1)*(e*2-2)+Qo)+2)/2},easeInElastic:function(e){return e===0?0:e===1?1:-Rt(2,10*e-10)*Sa((e*10-10.75)*mg)},easeOutElastic:function(e){return e===0?0:e===1?1:Rt(2,-10*e)*Sa((e*10-.75)*mg)+1},easeInOutElastic:function(e){return e===0?0:e===1?1:e<.5?-(Rt(2,20*e-10)*Sa((20*e-11.125)*vg))/2:Rt(2,-20*e+10)*Sa((20*e-11.125)*vg)/2+1},easeInBounce:function(e){return 1-Vo(1-e)},easeOutBounce:Vo,easeInOutBounce:function(e){return e<.5?(1-Vo(1-2*e))/2:(1+Vo(2*e-1))/2}},TE=class{constructor(e){this.runtime=e,this.pendingTransition={from:Le(5),to:Le(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Er.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Le(this.runtime.target),this.pendingTransition.to=Le(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,n=i.total_time===0?1:r===0?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Er.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),o=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*o,easing:Er.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:Er.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=Le(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(i==null?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(i==null?void 0:i.constrain)<"u"?i.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(i==null?void 0:i.easing)||Er.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(it.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:Er.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}},Go=class{constructor(e,t,i,r=[],n){this.id=_o(),this.ready=!1,this.transformBuffer=Le(500),this.lastTarget=Le(5),this.zoomBuffer=Le(5),this.logNextRender=!1,this.pendingUpdate=!0,this.isCommitting=!1,this.firstRender=!0,this.mode="explore",this.controllers=[],this.controllersRunning=!1,this.controllerStopFunctions=[],this.maxScaleFactor=1,this._viewerToWorld={x:0,y:0},this._lastGoodScale=1,this.hooks={useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]},this.hookOptions={filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}},this._viewport={x:0,y:0,width:0,height:0},this.setViewport=o=>{let l=Math.round(typeof o.x>"u"?this.target[1]:o.x),u=Math.round(typeof o.y>"u"?this.target[2]:o.y);o.width?this.target[3]=l+o.width:this.target[3]=this.target[3]-this.target[1]+l,o.height?this.target[4]=u+o.height:this.target[4]=this.target[4]-this.target[2]+u,Math.abs(this.target[1]-l)>.01&&(this.target[1]=l),Math.abs(this.target[2]-u)>.01&&(this.target[2]=u),this.pendingUpdate=!0},this.render=o=>{let l=o-this.lastTime;if(this.isCommitting||this.fpsLimit&&l<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=o,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",l);let u=this.pendingUpdate,h=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,l),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!u&&!h&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",l),this.renderer.beforeFrame(this.world,l,this.target,this.hookOptions);let g=this.getScaleFactor(),f=this.renderer.getPointsAt(this.world,this.target,this.aggregate,g),y=f.length;for(let _=0;_<y;_++){let T=f[_][0],R=f[_][1],O=f[_][2],E=O?jr(R,O,this.transformBuffer):R;this.renderer.prepareLayer(T,T.__parent&&O?jr(T.__parent.crop||T.__parent.points,O):E);let F=E.length/5;for(let z=0;z<F;z++){let U=z*5;E[U]!==0&&(this.renderer.paint(T,z,E[U+1],E[U+2],E[U+3]-E[U+1],E[U+4]-E[U+2]),this.hook("useAfterPaint",T))}this.renderer.finishLayer(T,R)}this.renderer.afterFrame(this.world,l,this.target,this.hookOptions),this.hook("useAfterFrame",l),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let S=this.world.getScheduledUpdates(this.target,g),C=S.length;if(C>0)for(let _=0;_<C;_++){let T=S[C-_-1]();T?T.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}},this.renderer=e,this.world=t,this.options=A({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=it.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=it.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new TE(this),this.aggregate=rn(1),this.world.addLayoutSubscriber(o=>{o==="repaint"&&(this.pendingUpdate=!0),o==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(it.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=A(A({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,o=i.width/r,l=i.height/n,u=r/n;if(e.cover?o>l:o<l){let h=u*i.height,g=(h-i.width)/2;this.target[1]=Math.round(-g+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(h-g+i.x),this.target[4]=Math.round(i.height+i.y)}else{let h=i.width/u,g=(h-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-g),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+h-g)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,o=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*o,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let i=this.width,r=this.height,n=Math.min(i,r),o=0,l=0,u=this.x+o,h=this.y+l;if(i<r){let g=this.height-this.width;this.focalPosition=it.projection({x:u,y:h+g/2,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}else{let g=this.width-this.height;this.focalPosition=it.projection({x:u+g/2,y:h,width:n-o*2,height:n-l*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:o,maxY:l}=this.getBounds({target:e,padding:t}),u=!1,h=i?e:Le(e),g=Math.round(e[3]-e[1]),f=Math.round(e[4]-e[2]);return r>e[1]&&(u=!0,h[1]=r,h[3]=r+g),o>e[2]&&(u=!0,h[2]=o,h[4]=o+f),n<e[1]&&(u=!0,h[1]=n,h[3]=n+g),l<e[2]&&(u=!0,h[2]=l,h[4]=l+f),[u,h]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let O=this.world.getActiveZone();if(O){let E=t[3]-t[1]<O.points[3]-O.points[1],F=t[4]-t[2]<O.points[4]-O.points[2];return{minX:E?O.points[1]-i:O.points[1]+(O.points[3]-O.points[1])/2-(t[3]-t[1])/2,maxX:F?O.points[2]-i:O.points[2]+(O.points[4]-O.points[2])/2-(t[4]-t[2])/2,minY:E?O.points[3]+i:O.points[1]+(O.points[3]-O.points[1])/2-(t[3]-t[1])/2,maxY:F?O.points[4]+i:O.points[2]+(O.points[4]-O.points[2])/2-(t[4]-t[2])/2}}}let o=t[3]-t[1],l=this.world.width,u=-o*n,h=l-o-u,g=t[4]-t[2],f=this.world.height,y=-g*n,S=f-g-y,C=Math.round(Math.max(u,h)),_=Math.round(Math.min(u,h)),T=Math.round(Math.max(y,S)),R=Math.round(Math.min(y,S));return{minX:_,maxX:C,minY:R,maxY:T}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return t===0?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,o=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),l=n?n.width:this.width,u=n?n.height:this.height,h=(r=this.getRendererScreenPosition())==null?void 0:r.width,g=this.world.width,f=h?h/g:1,y=this.options.maxUnderZoom,S=Math.max(f||1,this.options.maxOverZoom),C=1/e,_=o*C;if(C<1){let R=l*o,O=u*o,E=this.world.width/R,F=this.world.height/O;if(E>F){let z=this.world.width*_,U=~~(l*o)*y;z<U&&(e=this.world.width*o/(l*o*y))}else{let z=this.world.height*_,U=~~(u*o)*y;z<U&&(e=this.world.height*o/(u*o*y))}}else _>S&&(e=o/S);let T=jr(this.target,ga(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(T,{ref:!0,panPadding:100}),T}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let o=this.width,l=this.height,u=i/o<r/l,h=e-n,g=t-n,f=i+n*2,y=r+n*2;if(u){let C=y/l*o;return{x:h-(C-f)/2,y:g,width:C,height:y}}let S=f/o*l;return{x:h,y:g-(S-y)/2,width:f,height:S}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=it.singleBox(i,r,e,t);return xr(n,Nr(rn(this.getScaleFactor()),Pi(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){xr(this.target,ga(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(i!==0)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter(i=>i!==t)}}updateNextFrame(){this.pendingUpdate=!0}},Ca=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,IE=typeof AbortController=="function",Yo=IE?AbortController:class{constructor(){this.signal=new yg}abort(e=new Error("This operation was aborted")){this.signal.reason=e,this.signal.dispatchEvent({type:"abort",target:this.signal})}},RE=typeof AbortSignal=="function",LE=typeof Yo.AbortSignal=="function",yg=RE?AbortSignal:LE?Yo.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(t=>t(e),this))}onabort(){}addEventListener(e,t){e==="abort"&&this._listeners.push(t)}removeEventListener(e,t){e==="abort"&&(this._listeners=this._listeners.filter(i=>i!==t))}},xc=new Set,_c=(e,t)=>{let i=`LRU_CACHE_OPTION_${e}`;Xo(i)&&Ec(i,`${e} option`,`options.${t}`,Fs)},Sc=(e,t)=>{let i=`LRU_CACHE_METHOD_${e}`;if(Xo(i)){let{prototype:r}=Fs,{get:n}=Object.getOwnPropertyDescriptor(r,e);Ec(i,`${e} method`,`cache.${t}()`,n)}},OE=(e,t)=>{let i=`LRU_CACHE_PROPERTY_${e}`;if(Xo(i)){let{prototype:r}=Fs,{get:n}=Object.getOwnPropertyDescriptor(r,e);Ec(i,`${e} property`,`cache.${t}`,n)}},bg=(...e)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...e):console.error(...e)},Xo=e=>!xc.has(e),Ec=(e,t,i,r)=>{xc.add(e);let n=`The ${t} is deprecated. Please use ${i} instead.`;bg(n,"DeprecationWarning",e,r)},un=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),wg=e=>un(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Zo:null:null,Zo=class extends Array{constructor(e){super(e),this.fill(0)}},$E=class{constructor(e){if(e===0)return[];let t=wg(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},Fs=class{constructor(e={}){let{max:t=0,ttl:i,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:l,allowStale:u,dispose:h,disposeAfter:g,noDisposeOnSet:f,noUpdateTTL:y,maxSize:S=0,maxEntrySize:C=0,sizeCalculation:_,fetchMethod:T,fetchContext:R,noDeleteOnFetchRejection:O,noDeleteOnStaleGet:E,allowStaleOnFetchRejection:F,allowStaleOnFetchAbort:z,ignoreFetchAbort:U}=e,{length:H,maxAge:G,stale:V}=e instanceof Fs?{}:e;if(t!==0&&!un(t))throw new TypeError("max option must be a nonnegative integer");let le=t?wg(t):Array;if(!le)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=S,this.maxEntrySize=C||this.maxSize,this.sizeCalculation=_||H,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=T||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=R,!this.fetchMethod&&R!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new le(t),this.prev=new le(t),this.head=0,this.tail=0,this.free=new $E(t),this.initialFill=1,this.size=0,typeof h=="function"&&(this.dispose=h),typeof g=="function"?(this.disposeAfter=g,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!y,this.noDeleteOnFetchRejection=!!O,this.allowStaleOnFetchRejection=!!F,this.allowStaleOnFetchAbort=!!z,this.ignoreFetchAbort=!!U,this.maxEntrySize!==0){if(this.maxSize!==0&&!un(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!un(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!V,this.noDeleteOnStaleGet=!!E,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!l,this.ttlResolution=un(r)||r===0?r:1,this.ttlAutopurge=!!n,this.ttl=i||G||0,this.ttl){if(!un(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let q="LRU_CACHE_UNBOUNDED";Xo(q)&&(xc.add(q),bg("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",q,Fs))}V&&_c("stale","allowStale"),G&&_c("maxAge","ttl"),H&&_c("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new Zo(this.max),this.starts=new Zo(this.max),this.setItemTTL=(i,r,n=Ca.now())=>{if(this.starts[i]=r!==0?n:0,this.ttls[i]=r,r!==0&&this.ttlAutopurge){let o=setTimeout(()=>{this.isStale(i)&&this.delete(this.keyList[i])},r+1);o.unref&&o.unref()}},this.updateItemAge=i=>{this.starts[i]=this.ttls[i]!==0?Ca.now():0};let e=0,t=()=>{let i=Ca.now();if(this.ttlResolution>0){e=i;let r=setTimeout(()=>e=0,this.ttlResolution);r.unref&&r.unref()}return i};this.getRemainingTTL=i=>{let r=this.keyMap.get(i);return r===void 0?0:this.ttls[r]===0||this.starts[r]===0?1/0:this.starts[r]+this.ttls[r]-(e||t())},this.isStale=i=>this.ttls[i]!==0&&this.starts[i]!==0&&(e||t())-this.starts[i]>this.ttls[i]}updateItemAge(e){}setItemTTL(e,t,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new Zo(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,i,r)=>{if(this.isBackgroundFetch(t))return 0;if(!un(i))if(r){if(typeof r!="function")throw new TypeError("sizeCalculation must be a function");if(i=r(t,e),!un(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.addItemSize=(e,t)=>{if(this.sizes[e]=t,this.maxSize){let i=this.maxSize-this.sizes[e];for(;this.calculatedSize>i;)this.evict(!0)}this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,i,r){if(i||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*rentries(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*keys(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*rkeys(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*values(){for(let e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}*rvalues(){for(let e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t={}){for(let i of this.indexes())if(e(this.valList[i],this.keyList[i],this))return this.get(this.keyList[i],t)}forEach(e,t=this){for(let i of this.indexes())e.call(t,this.valList[i],this.keyList[i],this)}rforEach(e,t=this){for(let i of this.rindexes())e.call(t,this.valList[i],this.keyList[i],this)}get prune(){return Sc("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){let e=[];for(let t of this.indexes({allowStale:!0})){let i=this.keyList[t],r=this.valList[t],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(n===void 0)continue;let o={value:n};if(this.ttls){o.ttl=this.ttls[t];let l=Ca.now()-this.starts[t];o.start=Math.floor(Date.now()-l)}this.sizes&&(o.size=this.sizes[t]),e.unshift([i,o])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let r=Date.now()-i.start;i.start=Ca.now()-r}this.set(t,i.value,i)}}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,start:r,noDisposeOnSet:n=this.noDisposeOnSet,size:o=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL}={}){if(o=this.requireSize(e,t,o,l),this.maxEntrySize&&o>this.maxEntrySize)return this.delete(e),this;let h=this.size===0?void 0:this.keyMap.get(e);if(h===void 0)h=this.newIndex(),this.keyList[h]=e,this.valList[h]=t,this.keyMap.set(e,h),this.next[this.tail]=h,this.prev[h]=this.tail,this.tail=h,this.size++,this.addItemSize(h,o),u=!1;else{this.moveToTail(h);let g=this.valList[h];t!==g&&(this.isBackgroundFetch(g)?g.__abortController.abort(new Error("replaced")):n||(this.dispose(g,e,"set"),this.disposeAfter&&this.disposed.push([g,e,"set"])),this.removeItemSize(h),this.valList[h]=t,this.addItemSize(h,o))}if(i!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(h,i,r),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let t=this.head,i=this.keyList[t],r=this.valList[t];return this.isBackgroundFetch(r)?r.__abortController.abort(new Error("evicted")):(this.dispose(r,i,"evict"),this.disposeAfter&&this.disposed.push([r,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){let i=this.keyMap.get(e);return i!==void 0&&!this.isStale(i)?(t&&this.updateItemAge(i),!0):!1}peek(e,{allowStale:t=this.allowStale}={}){let i=this.keyMap.get(e);if(i!==void 0&&(t||!this.isStale(i))){let r=this.valList[i];return this.isBackgroundFetch(r)?r.__staleWhileFetching:r}}backgroundFetch(e,t,i,r){let n=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(n))return n;let o=new Yo;i.signal&&i.signal.addEventListener("abort",()=>o.abort(i.signal.reason));let l={signal:o.signal,options:i,context:r},u=(y,S=!1)=>{let{aborted:C}=o.signal,_=i.ignoreFetchAbort&&y!==void 0;return C&&!_&&!S?h(o.signal.reason):(this.valList[t]===f&&(y===void 0?f.__staleWhileFetching?this.valList[t]=f.__staleWhileFetching:this.delete(e):this.set(e,y,l.options)),y)},h=y=>{let{aborted:S}=o.signal,C=S&&i.allowStaleOnFetchAbort,_=C||i.allowStaleOnFetchRejection,T=_||i.noDeleteOnFetchRejection;if(this.valList[t]===f&&(!T||f.__staleWhileFetching===void 0?this.delete(e):C||(this.valList[t]=f.__staleWhileFetching)),_)return f.__staleWhileFetching;if(f.__returned===f)throw y},g=(y,S)=>{this.fetchMethod(e,n,l).then(C=>y(C),S),o.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(y(),i.allowStaleOnFetchAbort&&(y=C=>u(C,!0)))})},f=new Promise(g).then(u,h);return f.__abortController=o,f.__staleWhileFetching=n,f.__returned=null,t===void 0?(this.set(e,f,l.options),t=this.keyMap.get(e)):this.valList[t]=f,f}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:g=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:S=this.allowStaleOnFetchAbort,fetchContext:C=this.fetchContext,forceRefresh:_=!1,signal:T}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r});let R={allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,ttl:n,noDisposeOnSet:o,size:l,sizeCalculation:u,noUpdateTTL:h,noDeleteOnFetchRejection:g,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:S,ignoreFetchAbort:y,signal:T},O=this.keyMap.get(e);if(O===void 0){let E=this.backgroundFetch(e,O,R,C);return E.__returned=E}else{let E=this.valList[O];if(this.isBackgroundFetch(E))return t&&E.__staleWhileFetching!==void 0?E.__staleWhileFetching:E.__returned=E;if(!_&&!this.isStale(O))return this.moveToTail(O),i&&this.updateItemAge(O),E;let F=this.backgroundFetch(e,O,R,C);return t&&F.__staleWhileFetching!==void 0?F.__staleWhileFetching:F.__returned=F}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet}={}){let n=this.keyMap.get(e);if(n!==void 0){let o=this.valList[n],l=this.isBackgroundFetch(o);return this.isStale(n)?l?t?o.__staleWhileFetching:void 0:(r||this.delete(e),t?o:void 0):l?void 0:(this.moveToTail(n),i&&this.updateItemAge(n),o)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return Sc("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){let i=this.keyMap.get(e);if(i!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(i);let r=this.valList[i];this.isBackgroundFetch(r)?r.__abortController.abort(new Error("deleted")):(this.dispose(r,e,"delete"),this.disposeAfter&&this.disposed.push([r,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(let e of this.rindexes({allowStale:!0})){let t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{let i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return Sc("reset","clear"),this.clear}get length(){return OE("length","size"),this.size}static get AbortController(){return Yo}static get AbortSignal(){return yg}},FE=Fs,xg=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,_g={},ME=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),Ko={},zE=class{constructor(e,t){this.imagesPending=0,this.imagesLoaded=0,this.imageIdsLoaded=[],this.frameIsRendering=!1,this.pendingDrawCall=!1,this.firstMeaningfulPaint=!1,this.parallelTasks=8,this.frameTasks=0,this.loadingQueueOrdered=!0,this.loadingQueue=[],this.currentTask=Promise.resolve(),this.tasksRunning=0,this.averageJobTime=64,this.lastKnownScale=1,this.visible=[],this.previousVisible=[],this.drawCalls=[],this.invalidated=[],this._worker=()=>{if(this.loadingQueue.length){let i=this.loadingQueue.pop();i&&(this.tasksRunning++,this.frameTasks++,this.currentTask=i.task().then(()=>{this.tasksRunning--}).catch(()=>{this.tasksRunning--}))}},this._scheduled=0,this._doWork=()=>{this.loadingQueue.length===0&&this.tasksRunning===0&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let i=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(i=this.loadingQueue.length);for(let r=0;r<=i;r++)this._worker()},this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.ctx=e.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=t||{},this.canvas.style.opacity="0",this.canvas.style.transition="opacity .3s",this.dpi=(t==null?void 0:t.dpi)||1,this.hostCache=t!=null&&t.lruCache?new FE({maxSize:1024*512*512,dispose:(i,r,n)=>{this.invalidated.push(r),i.width=0,i.height=0},sizeCalculation:(i,r)=>i.width*i.height}):{store:{},get(i){return this.store[i]},set(i,r){this.store[i]=r}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(e){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort((t,i)=>t.network&&t.scale===i.scale?i.distance-t.distance:t.scale<i.scale?-1:1),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let t=0;t<this.drawCalls.length;t++){let i=this.drawCalls.shift();i&&i()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,o=r.height/t,l=(n<o?o:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}beforeFrame(e,t,i,r){var n;this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(t);let o=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=(n=this.canvas.dataset.background)!=null?n:"rgb(0, 0, 0)",this.ctx.fillRect(0,0,o.width,o.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let l="";r.filters.brightness&&(l+=`brightness(${~~(100+r.filters.brightness*100)}%) `),r.filters.contrast&&(l+=`contrast(${~~(100+r.filters.contrast*100)}%) `),r.filters.grayscale&&(l+=`grayscale(${~~(r.filters.grayscale*100)}%) `),r.filters.invert&&(l+=`invert(${~~(r.filters.invert*100)}%) `),r.filters.sepia&&(l+=`sepia(${~~(r.filters.sepia*100)}%) `),r.filters.saturate&&(l+=`saturate(${~~(100+r.filters.saturate*100)}%) `),r.filters.hueRotate&&(l+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(l+=`blur(${r.filters.blur}px) `),this.ctx.filter=l}else this.ctx.filter="none"}applyTransform(e,t,i,r,n){let o=e.__owner.value;if(o&&o.rotation){this.ctx.save();let l=t+r/2,u=i+n/2;this.ctx.translate(l,u),this.ctx.rotate(o.rotation*Math.PI/180),this.ctx.translate(-l,-u),this.lastPaintedObject=o}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(e,t,i,r,n,o){let l=this.ctx.globalAlpha;if(e instanceof ur||e instanceof on){if(e.display.rotation){this.ctx.save();let g=i+n/2,f=r+o/2;e.crop&&(g-=e.crop[t*5+1],f-=e.crop[t*5+2]),this.ctx.translate(g,f),this.ctx.rotate(e.display.rotation*Math.PI/180),this.ctx.translate(-g,-f)}if(this.visible.push(e),typeof e.style&&e.style.opacity!=="undefined"){if(!e.style.opacity)return;this.ctx.globalAlpha=e.style.opacity}try{let g=e.__host.canvas,f=this.getCanvasDims();if((g.indices.indexOf(t)===-1||this.invalidated.indexOf(g.canvases[t])!==-1)&&this.schedulePaintToCanvas(g,e,t,Eo({x:i+n/2,y:r+n/2},{x:f.width/2,y:f.height/2})),!this.firstMeaningfulPaint)return;let y=this.hostCache.get(g.canvases[t]);if(y)if(e.crop&&e.cropData){if(e.crop[t*5]){let S=[e.crop[t*5+1]/e.display.scale-e.display.points[t*5+1],e.crop[t*5+2]/e.display.scale-e.display.points[t*5+2],1+(e.crop[t*5+3]-e.crop[t*5+1])/e.display.scale,1+(e.crop[t*5+4]-e.crop[t*5+2])/e.display.scale];S[0]+=e.cropData.x/e.display.scale,S[1]+=e.cropData.y/e.display.scale;let C=e.x*this.lastKnownScale,_=e.y*this.lastKnownScale,T=[i+C,r+_,n,o];T[0]+=C,T[1]+=_,this.ctx.drawImage(y,S[0],S[1],S[2],S[3],T[0],T[1],T[2]+1,T[3]+1)}}else ME?this.ctx.drawImage(y,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+1,o+1):this.ctx.drawImage(y,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+Number.MIN_VALUE+.5,o+Number.MIN_VALUE+.5)}catch{}e.display.rotation&&this.ctx.restore()}let u=e instanceof $s&&this.options.box,h=e instanceof fg&&this.options.polygon;if((u||h)&&!e.props.className&&!e.props.html&&!e.props.href){if(this.visible.push(e),e.props.style){let g=Object.assign({},e.props.style||{},e.hovering?e.props.hoverStyles:{},e.pressing?e.props.pressStyles:{}),f=e.props.relativeStyle?1:n/e.width;typeof g.opacity<"u"&&(this.ctx.globalAlpha=g.opacity);let y=0;typeof g.borderWidth<"u"&&(y=parseInt(g.borderWidth,10)*f);let S=0;typeof g.outlineWidth<"u"&&(S=parseInt(g.outlineWidth,10)*f);let C=0;if(typeof g.outlineOffset<"u"&&(C=parseInt(g.outlineOffset,10)*f),g.borderColor&&(this.ctx.strokeStyle=g.borderColor),g.boxShadow){let _=g.boxShadow.split(/,(?![^(]*\))/);for(let T of _){let R=_g[T]||xg.exec(T)||xg.exec(T);_g[T]=R,R&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(R[1])*this.dpi*f,this.ctx.shadowOffsetY=parseInt(R[3])*this.dpi*f,this.ctx.shadowBlur=parseInt(R[5])*this.dpi*f,this.ctx.shadowColor=R[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(i+y,r+y,n,o),this.ctx.restore())}}if(this.ctx.fillStyle=g.backgroundColor||"transparent",this.ctx.lineWidth=y,h){let _=e.shape,T=_.points||[],R=T.length;this.ctx.beginPath();for(let O=0;O<R;O++)this.ctx.lineTo(i+T[O][0]*this.lastKnownScale,r+T[O][1]*this.lastKnownScale);_.open||this.ctx.closePath(),y&&this.ctx.stroke(),_.open||this.ctx.fill()}else y&&this.ctx.strokeRect(i+y/2,r+y/2,n+y,o+y),this.ctx.fillRect(i+y,r+y,n,o);S&&(g.outlineColor&&(this.ctx.strokeStyle=g.outlineColor),this.ctx.lineWidth=S,this.ctx.strokeRect(i-S/2-C,r-S/2-C,n+y*2+S+C*2,o+y*2+S+C*2))}this.ctx.globalAlpha=l}}loadImage(e,t,i,r=!1){if(Ko[e]&&Ko[e].naturalWidth>0){t(Ko[e]);return}try{let n=!1;r||setTimeout(()=>{n||this.loadImage(e,t,i,!0)},3e3);let o=document.createElement("img");o.decoding="auto",o.onload=function(){n=!0,t(o),Ko[e]=o,o.onload=null},this.options.crossOrigin&&(o.crossOrigin="anonymous"),o.src=e,o.complete&&o.onload({}),o.width}catch(n){console.log("image error",n),i(n)}}schedulePaintToCanvas(e,t,i,r){this.imagesPending++,e.indices.push(i);let n=`${t.id}--${t.display.scale}-${i}`,o=this.invalidated.indexOf(n);o!==-1&&this.invalidated.splice(o,1),e.canvases[i]=n,t.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:n,scale:t.display.scale,network:!0,distance:r,task:()=>new Promise(l=>{if(this.visible.indexOf(t)===-1){this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l();return}let u=t.getImageUrl(i);this.loadImage(u,h=>{this.loadingQueue.push({id:n,scale:t.display.scale,distance:r,task:()=>new Promise(g=>{this.imageIdsLoaded.includes(n)||(this.imagesLoaded++,this.imageIdsLoaded.push(n)),e.loaded.push(i),e.loaded.length===e.indices.length&&(e.loading=!1);let f=t.display.points.slice(i*5,i*5+5),y=document.createElement("canvas"),S=y.getContext("2d");y.width=f[3]-f[1],y.height=f[4]-f[2],this.hostCache.set(e.canvases[i],y),this.drawCalls.push(()=>{S.drawImage(h,0,0,f[3]-f[1],f[4]-f[2]),g()})})}),l()},h=>{this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l()})})})}afterPaintLayer(e,t){}prepareLayer(e,t){e.__owner.value&&(e.cropData?(this.lastKnownScale*(1/e.display.scale),this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])):this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])),(!e.__host||!e.__host.canvas)&&(e instanceof ur||e instanceof on)&&this.createImageHost(e)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(e){e.__host=e.__host?e.__host:{},e.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getViewportBounds(e,t,i){let r=e.getActiveZone();if(r){let n=t[3]-t[1]<r.points[3]-r.points[1],o=t[4]-t[2]<r.points[4]-r.points[2];return{x1:n?r.points[1]-i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y1:o?r.points[2]-i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2,x2:n?r.points[3]+i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y2:o?r.points[4]+i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2}}return null}pendingUpdate(){let e=!this.pendingDrawCall&&this.drawCalls.length===0&&this.imagesPending===0&&this.loadingQueue.length===0&&this.tasksRunning===0;return!e&&this.visible.length===0&&setTimeout(()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0},500),!this.firstMeaningfulPaint&&e&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=e,!0):this.options.debug?!0:!e}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},Sg=class{constructor(e){this.renderers=[];for(let t of e)t&&this.renderers.push(t);this.length=this.renderers.length}afterFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].afterFrame(e,t,i,r)}afterPaintLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].afterPaintLayer(e,t)}beforeFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].beforeFrame(e,t,i,r)}triggerResize(){for(let e=0;e<this.length;e++){let t=this.renderers[e];t.triggerResize&&t.triggerResize()}}getPointsAt(e,t,i,r){return this.renderers[0].getPointsAt(e,t,i,r)}getScale(e,t){return this.renderers[0].getScale(e,t)}getViewportBounds(e,t,i){return this.renderers[0].getViewportBounds(e,t,i)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let e=0;e<this.length;e++)if(!this.renderers[e].isReady())return!1;return!0}paint(e,t,i,r,n,o){for(let l=0;l<this.length;l++)this.renderers[l].paint(e,t,i,r,n,o)}pendingUpdate(){for(let e=0;e<this.length;e++)if(this.renderers[e].pendingUpdate())return!0;return!1}prepareLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].prepareLayer(e,t)}finishLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].finishLayer(e,t)}resize(e,t){for(let i=0;i<this.length;i++)this.renderers[i].resize(e,t)}reset(){for(let e=0;e<this.length;e++)this.renderers[e].reset()}},NE=class{constructor(e){this.heightRatio=1,this.widthRatio=1,this.target=new Float32Array(5),this.delta=0,this.renderNextFrame=!0,this.canvas=e,this.initialWidth=e.width,this.initialHeight=e.height,this.context=e.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=rn(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(e,t,i){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.initialWidth/e.width,n=this.initialHeight/e.height,o=this.widthRatio>this.heightRatio?r:n;if(this.target=i,this.bounds){let l=e.getPointsAt(this.bounds,this.aggregate,o);for(let[u,h]of l)if(u instanceof ur&&u.__host.canvas){let g=h.length/5;for(let f=0;f<g;f++)u.__host.canvas.canvases[f]&&(h[f+1]*o,h[f+2]*o,(h[f+3]-h[f+1])*o,(h[f+4]-h[f+2])*o)}}e.getPoints().forEach((l,u,h)=>{if(u%5===0&&l){let g={x1:h[u+1]*o,y1:h[u+2]*o,x2:h[u+3]*o,y2:h[u+4]*o,width:(h[u+3]-h[u+1])*o,height:(h[u+4]-h[u+2])*o};this.context.strokeStyle="red",this.context.strokeRect(g.x1,g.y1,g.width,g.height)}}),i&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(i[1]*o,i[2]*o,(i[3]-i[1])*o,(i[4]-i[2])*o))}}getActiveZone(e){return null}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){return 1}beforeFrame(e,t){this.bounds=it.singleBox(e.width,e.height)}drawImage(){}afterPaintLayer(e,t){}paint(e,t,i,r,n,o){this.renderNextFrame=!0}prepareLayer(e){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(e,t,i){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}},Eg=!1,Nn,Cc,kc,Jo,el,Cg,tl,Ac,Pc,Tc,kg,Ic,Rc,Ag,Pg;function zi(){if(!Eg){Eg=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(Ic=/\b(iPhone|iP[ao]d)/.exec(e),Rc=/\b(iP[ao]d)/.exec(e),Tc=/Android/i.exec(e),Ag=/FBAN\/\w+;/i.exec(e),Pg=/Mobile/i.exec(e),kg=!!/Win64/.exec(e),t){Nn=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,Nn&&document&&document.documentMode&&(Nn=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(e);Cg=r?parseFloat(r[1])+4:Nn,Cc=t[2]?parseFloat(t[2]):NaN,kc=t[3]?parseFloat(t[3]):NaN,Jo=t[4]?parseFloat(t[4]):NaN,Jo?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),el=t&&t[1]?parseFloat(t[1]):NaN):el=NaN}else Nn=Cc=kc=el=Jo=NaN;if(i){if(i[1]){var n=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);tl=n?parseFloat(n[1].replace("_",".")):!0}else tl=!1;Ac=!!i[2],Pc=!!i[3]}else tl=Ac=Pc=!1}}var Lc={ie:function(){return zi()||Nn},ieCompatibilityMode:function(){return zi()||Cg>Nn},ie64:function(){return Lc.ie()&&kg},firefox:function(){return zi()||Cc},opera:function(){return zi()||kc},webkit:function(){return zi()||Jo},safari:function(){return Lc.webkit()},chrome:function(){return zi()||el},windows:function(){return zi()||Ac},osx:function(){return zi()||tl},linux:function(){return zi()||Pc},iphone:function(){return zi()||Ic},mobile:function(){return zi()||Ic||Rc||Tc||Pg},nativeApp:function(){return zi()||Ag},android:function(){return zi()||Tc},ipad:function(){return zi()||Rc}},jE=Lc,BE=!!(typeof window<"u"&&window.document&&window.document.createElement),DE={canUseDOM:BE},UE=DE,Tg=UE,Ig;Tg.canUseDOM&&(Ig=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function WE(e,t){if(!Tg.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,r=i in document;if(!r){var n=document.createElement("div");n.setAttribute(i,"return;"),r=typeof n[i]=="function"}return!r&&Ig&&e==="wheel"&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var HE=WE,qE=jE,QE=HE,Rg=10,Lg=40,Og=800;function $g(e){var t=0,i=0,r=0,n=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),r=t*Rg,n=i*Rg,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||n)&&e.deltaMode&&(e.deltaMode==1?(r*=Lg,n*=Lg):(r*=Og,n*=Og)),r&&!t&&(t=r<1?-1:1),n&&!i&&(i=n<1?-1:1),{spinX:t,spinY:i,pixelX:r,pixelY:n}}$g.getEventType=function(){return qE.firefox()?"DOMMouseScroll":QE("wheel")?"wheel":"mousewheel"};var VE=$g,GE=VE;function YE(e){return{x:e[1],y:e[2],width:e[3]-e[1],height:e[4]-e[2]}}var Fg="pan",Mg="scroll",XE="gesture",ZE={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},zg=(e={})=>({start:function(t){let{zoomWheelConstant:i,enableWheel:r,enableClickToZoom:n,ignoreSingleFingerTouch:o,enablePanOnWait:l,panOnWaitDelay:u,parentElement:h,requireMetaKeyForWheelZoom:g}=A(A({},ZE),e),f={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Le(5)};t.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove");function y(){T=0,O="",F(),F(void 0,"notice"),R=0}function S(){t.world.constraintBounds(),y()}function C(q){if(q.which>1){f.isPressing=!1;return}t.mode==="explore"&&(q.preventDefault(),f.pointerStart.x=q.atlas.x,f.pointerStart.y=q.atlas.y,t.transitionManager.stopTransition(),f.isPressing=!0)}function _(){y(),f.isPressing&&(t.mode==="explore"&&t.world.constraintBounds(),f.isPressing=!1)}let T=0,R=0,O="";function E(q){if(t.mode==="explore"){if(q.atlasTouches.length===1&&(R=performance.now(),o==!1&&q.preventDefault(),f.pointerStart.x=q.atlasTouches[0].x,f.pointerStart.y=q.atlasTouches[0].y),q.atlasTouches.length===2){O=XE,q.preventDefault();let ne=q.atlasTouches[0].x,ge=q.atlasTouches[1].x;f.pointerStart.x=(ne+ge)/2;let de=q.atlasTouches[0].y,we=q.atlasTouches[1].y;f.pointerStart.y=(de+we)/2,T=Eo({x:q.touches[0].clientX,y:q.touches[0].clientY},{x:q.touches[1].clientX,y:q.touches[1].clientY})}t.transitionManager.stopTransition(),f.isPressing=!0}}function F(q,ne="intent"){h&&(h.dataset[ne]=q)}function z(q){let ne=null,ge=null,de=0;if(f.isPressing&&q.touches.length===2){let we=q.touches[0].clientX,me=q.touches[1].clientX;ne=(we+me)/2;let ce=q.touches[0].clientY,We=q.touches[1].clientY;ge=(ce+We)/2,de=Eo({x:q.touches[0].clientX,y:q.touches[0].clientY},{x:q.touches[1].clientX,y:q.touches[1].clientY})}if(F(O),f.isPressing&&q.touches.length===1){if(l&&(performance.now()-R<u&&O==""&&(O=Mg),O==""&&(O=Fg)),F(O),O==""&&o==!0||O==Mg){F("require-two-finger","notice");return}let we=q.touches[0];ne=we.clientX,ge=we.clientY}if(ne!==null&&ge!==null){let we=t.getRendererScreenPosition();if(we){let{x:me,y:ce}=t.viewerToWorld(ne-we.x,ge-we.y),We=de&&T?de/T:1;t.transitionManager.customTransition(ee=>{ee.from=Le(t.target),ee.to=jr(ee.from,Nr(Pi(f.pointerStart.x-me,f.pointerStart.y-ce),ga(1/We,me,ce)),f.mousemoveBuffer),ee.elapsed_time=0,ee.total_time=0,ee.timingFunction=Er.easeInOutExpo,ee.done=!1})}T=de}O==Fg&&q.preventDefault()}function U(q){if(f.isPressing){let ne=t.getRendererScreenPosition();if(ne){let{x:ge,y:de}=t.viewerToWorld(q.clientX-ne.x,q.clientY-ne.y);t.transitionManager.customTransition(we=>{we.from=Le(t.target),we.to=jr(we.from,Pi(f.pointerStart.x-ge,f.pointerStart.y-de),f.mousemoveBuffer),we.elapsed_time=0,we.total_time=0,we.timingFunction=Er.easeInOutExpo,we.done=!1})}}}function H(q){t.mode==="explore"&&t.world.zoomIn(q.atlas)}function G(q){let ne=GE(q),ge=1+ne.spinY/i;t.world.zoomTo(ge,q.atlas,!0)}function V(q){return g&&q.metaKey==!1?(F("meta-required","notice"),q.stopPropagation(),!1):!0}t.world.addEventListener("mouseup",S),t.world.addEventListener("touchend",S),t.world.addEventListener("touchstart",E),t.world.addEventListener("mousedown",C),window.addEventListener("touchend",_),window.addEventListener("mouseup",_),window.addEventListener("mousemove",U),h&&h.addEventListener("touchmove",z),n&&(t.world.activatedEvents.push("onClick"),t.world.addEventListener("click",H)),r&&(t.world.activatedEvents.push("onWheel"),g&&(h==null||h.addEventListener("wheel",V,{passive:!0,capture:!0})),t.world.addEventListener("wheel",G));let le=t.world.addLayoutSubscriber((q,ne)=>{if(q==="zone-changed"&&t.transitionManager.constrainBounds({transition:{duration:0}}),q==="zoom-to"&&ne&&t.transitionManager.zoomTo(ne.factor,{origin:ne.point,stream:ne.stream}),q==="go-home"){let ge=ne.immediate?{duration:0}:void 0;t.transitionManager.goToRegion(YE(t.homePosition),{transition:ge})}if(q==="goto-region"&&ne){let ge=ne.immediate?{duration:0}:{};t.transitionManager.goToRegion(ne,{transition:ge})}q==="constrain-bounds"&&t.transitionManager.constrainBounds({transition:ne!=null&&ne.immediate?{duration:0}:void 0})});return()=>{t.world.removeEventListener("mouseup",S),t.world.removeEventListener("touchend",S),t.world.removeEventListener("touchstart",E),t.world.removeEventListener("mousedown",C),window.removeEventListener("touchend",_),window.removeEventListener("mouseup",_),t.world.removeEventListener("mousemove",U),h&&(h.removeEventListener("touchmove",U),h.removeEventListener("wheel",V,{passive:!0,capture:!0})),n&&t.world.removeEventListener("click",H),r&&t.world.removeEventListener("wheel",G),le()}},updatePosition(){}}),il=J.createContext("explore");il.displayName="Mode";var Oc=()=>Yt(il);function $c(e,t,i){var r,n,o,l,u;t==null&&(t=100);function h(){var f=Date.now()-l;f<t&&f>=0?r=setTimeout(h,t-f):(r=null,i||(u=e.apply(o,n),o=n=null))}var g=function(){o=this,n=arguments,l=Date.now();var f=i&&!r;return r||(r=setTimeout(h,t)),f&&(u=e.apply(o,n),o=n=null),u};return g.clear=function(){r&&(clearTimeout(r),r=null)},g.flush=function(){r&&(u=e.apply(o,n),o=n=null,clearTimeout(r),r=null)},g}$c.debounce=$c;var Ng=$c;function jg(e){let{debounce:t,scroll:i,polyfill:r,offsetSize:n}=e===void 0?{debounce:0,scroll:!1,offsetSize:!1}:e,o=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[l,u]=ze({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),h=ke({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),g=t?typeof t=="number"?t:t.scroll:null,f=t?typeof t=="number"?t:t.resize:null,y=ke(!1);fe(()=>(y.current=!0,()=>void(y.current=!1)));let[S,C,_]=Ae(()=>{let E=()=>{if(!h.current.element)return;let{left:F,top:z,width:U,height:H,bottom:G,right:V,x:le,y:q}=h.current.element.getBoundingClientRect(),ne={left:F,top:z,width:U,height:H,bottom:G,right:V,x:le,y:q};h.current.element instanceof HTMLElement&&n&&(ne.height=h.current.element.offsetHeight,ne.width=h.current.element.offsetWidth),Object.freeze(ne),y.current&&!tC(h.current.lastBounds,ne)&&u(h.current.lastBounds=ne)};return[E,f?Ng(E,f):E,g?Ng(E,g):E]},[u,n,g,f]);function T(){h.current.scrollContainers&&(h.current.scrollContainers.forEach(E=>E.removeEventListener("scroll",_,!0)),h.current.scrollContainers=null),h.current.resizeObserver&&(h.current.resizeObserver.disconnect(),h.current.resizeObserver=null)}function R(){!h.current.element||(h.current.resizeObserver=new o(_),h.current.resizeObserver.observe(h.current.element),i&&h.current.scrollContainers&&h.current.scrollContainers.forEach(E=>E.addEventListener("scroll",_,{capture:!0,passive:!0})))}let O=E=>{!E||E===h.current.element||(T(),h.current.element=E,h.current.scrollContainers=Bg(E),R())};return JE(_,!!i),KE(C),fe(()=>{T(),R()},[i,_,C]),fe(()=>T,[]),[O,l,S]}function KE(e){fe(()=>{let t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function JE(e,t){fe(()=>{if(t){let i=e;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[e,t])}function Bg(e){let t=[];if(!e||e===document.body)return t;let{overflow:i,overflowX:r,overflowY:n}=window.getComputedStyle(e);return[i,r,n].some(o=>o==="auto"||o==="scroll")&&t.push(e),[...t,...Bg(e.parentElement)]}var eC=["x","y","top","bottom","left","right","width","height"],tC=(e,t)=>eC.every(i=>e[i]===t[i]),rl=J.createContext(null);rl.displayName="Atlas";var nl=J.createContext(null);nl.displayName="Bounds";var sl,iC=typeof performance=="object"&&typeof performance.now=="function";if(iC){let e=performance;sl=()=>e.now()}else{let e=Date,t=e.now();sl=()=>e.now()-t}var Dg={exports:{}},jn={};jn.ConcurrentRoot=1,jn.ContinuousEventPriority=4,jn.DefaultEventPriority=16,jn.DiscreteEventPriority=1,jn.IdleEventPriority=536870912,jn.LegacyRoot=0,Dg.exports=jn;function Ug(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function Wg(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function rC(e,t){return Wg(e.world,t)}function nC(e,t,i){return Hg(e.world,t,i)}function Hg(e,t,i){e&&e instanceof Go&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function Fc(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof _r))for(let r of xo){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function Mc(e,t){let i=Object.keys(t),r=!1;for(let n of i)if(xo.indexOf(n)!==-1){let o=Es[n];if(o){if(e.activatedEvents.indexOf(o)!==-1)continue;r=!0,e.activatedEvents.push(o)}}r&&e.triggerEventActivation()}var al=new Map,qg={};function sC(e,t,i,r,n){var o=t,{args:l=[]}=o,u=oe(o,["args"]);if(!(i instanceof Go)&&n){let f=y=>y.return?f(y.return):y.stateNode&&y.stateNode.containerInfo;i=f(n)}let h,g=i.world;switch(e){case"world":h=ln.withProps({width:u.width,height:u.height,viewingDirection:"left-to-right"}),h.activatedEvents=g.activatedEvents,h.eventHandlers=g.eventHandlers,h.subscriptions=g.subscriptions,h.triggerEventActivation(),g=h;break;case"box":h=new $s;break;case"shape":h=new fg;break;case"worldObject":case"world-object":h=new Os;break;case"worldImage":case"world-image":h=new ur;break;case"texture":h=new So;break;case"compositeImage":case"composite-image":h=new wc({id:u.id,width:u.width,height:u.height,images:[],renderOptions:u.renderOptions});break;case"tiledImage":case"tiled-image":h=on.fromTile(u.uri,u.display,u.tile,u.scaleFactor,void 0,u.format);break;case"paragraph":h=new _a,h.text=u.children;break;default:return}return Mc(g,u),Fc(h,{},u),h}function aC(e,t){if(t instanceof ln)e.world=t;else if(t instanceof Os)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var ka=(0,Hx.default)({unstable_now:sl,now:sl,createInstance:sC,removeChild:Wg,appendChild:Ug,appendInitialChild:Ug,insertBefore:Hg,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:aC,removeChildFromContainer:rC,createTextInstance(){},insertInContainerBefore:nC,prepareUpdate(e,t,i,r,n){return Mc(n.world,r),r},commitUpdate(e,t,i,r,n,o){e.applyProps&&t&&Fc(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return qg},getRootHostContext(){return qg},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),Dg.exports.DefaultEventPriority},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});ka.injectIntoDevTools({bundleType:0,version:wo,rendererPackageName:"@atlas-viewer/atlas"});function zc(e,t){let i=al.get(e);i&&ka.updateContainer(null,i,null,()=>{al.delete(e),t&&t(e)})}var Qg={render(e,t){let i=al.get(t);if(i)ka.updateContainer(e,i,null);else{let r=ka.createContainer(t,0,null,!1,null,"",()=>{},null);ka.updateContainer(e,r,null),al.set(t,r)}},unmountComponentAtNode(e,t){zc(e,t)}},Aa=typeof window<"u"&&((Gf=window.document)!=null&&Gf.createElement||((Yf=window.navigator)==null?void 0:Yf.product)==="ReactNative")?Tt:fe,oC=J.memo(({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:o="explore"})=>{let l=Ue(function(u){let h=ke(!1),g=()=>{t(!0)};return fe(()=>{if(n&&!h.current){n.runtime.goHome();let f=i&&i(n);return void(f&&f.then?f.then(g):g())}return()=>{}},[]),fe(()=>{h.current=!0},[]),u.children},[n]);return Aa(()=>{if(n){let u=n.runtime;o!==u.mode&&(u.mode=o),Qg.render(J.createElement(J.StrictMode,null,J.createElement(l,null,J.createElement(nl.Provider,{value:r},J.createElement(il.Provider,{value:o},J.createElement(rl.Provider,{value:n},e))))),u)}},[n,o,e]),Aa(()=>{if(n){let u=n.runtime;return()=>{Qg.unmountComponentAtNode(u)}}return()=>{}},[n]),null}),lC=class{constructor(e,t){this.fragmentShaderSource=`
    precision mediump float;

    uniform sampler2D u_image;
    varying vec2 v_texCoord;

    void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
    }
  `,this.vertexShaderSource=`
    attribute vec2 a_position;
    uniform vec2 u_resolution;
    varying vec4 v_color;
    uniform sampler2D u_texture;

    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {

        // convert the position from pixels to 0.0 to 1.0
        vec2 zeroToOne = a_position / u_resolution;

        // convert from 0->1 to 0->2
        vec2 zeroToTwo = zeroToOne * 2.0;

        // convert from 0->2 to -1->+1 (clip space)
        vec2 clipSpace = zeroToTwo - 1.0;

        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
        
        v_texCoord = a_texCoord;
    }
  `,this.lastResize=0,this.lastKnownScale=1,this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.gl=e.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=(t==null?void 0:t.dpi)||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(e,t,i){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=t}prepareLayer(e){(!e.__host||!e.__host.webgl)&&((e instanceof ur||e instanceof on)&&this.createImageHost(e),e instanceof So&&this.createTextureHost(e))}createTextureHost(e){e.__host=e.__host?e.__host:{};let t=this.gl,i=this.gl.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);let r;if(e instanceof So){let n=e.getTexture();n.source&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n.source),r=n}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),e.__host.webgl={height:e.height,width:e.width,texture:i,lastImage:r}}createImageHost(e){let t=[...new Array(e.points.length/5)];e.__host=e.__host?e.__host:{},e.__host.webgl={height:e.height,width:e.width,textures:t,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(i,r)=>{let n=this.gl,o=this.gl.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null),e.__host.webgl.textures[i]=o,e.__host.webgl.loaded.push(i)}}}paint(e,t,i,r,n,o){if(e.type==="spacial-content"&&e.__host&&e.__host.webgl){if(e.getTexture){let u=e==null?void 0:e.getTexture();if(u&&e.__host.webgl.lastImage!==u.hash&&u.source&&!e.__host.webgl.error)try{let h=this.gl.RGBA,g=this.gl.RGBA,f=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,e.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,h,g,f,u.source),e.__host.webgl.lastImage=u.hash}catch(h){e.__host.webgl.error=h}}if(e.__host.webgl.loading&&e.__host.webgl.loading.indexOf(t)===-1&&e.getImageUrl){e.__host.webgl.loading.push(t);let u=document.createElement("img");u.decoding="async",u.crossOrigin="anonymous",u.src=e.getImageUrl(t),u.onload=()=>(u.onload=null,e.__host.webgl.onLoad(t,u))}let l=e.__host.webgl.texture?e.__host.webgl.texture:e.__host.webgl.textures[t];l&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(i,r,n,o),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(e,t){}pendingUpdate(){return!0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}afterFrame(){}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,o=r.height/t,l=(n<o?o:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(e,t,i){return null}createShader(e,t){let i=this.gl.createShader(e);if(i){if(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i;let r=this.gl.getShaderInfoLog(i);if(this.gl.deleteShader(i),r)throw new Error(r)}throw new Error("Invalid shader")}createProgram(e,t){let i=this.gl.createProgram();if(i){if(this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS))return i;let r=this.gl.getProgramInfoLog(i);if(this.gl.deleteProgram(i),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let e=this.gl.canvas,t=e.clientWidth,i=e.clientHeight,r=e.width!==t||e.height!==i;return r&&(e.width=t,e.height=i),r}createArrayBuffer(e){let t=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),e&&this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),!t)throw new Error("Cannot create buffer");return t}setRectangle(e,t,i,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(e,t,i,r),this.gl.STATIC_DRAW)}getRectangle(e,t,i,r){let n=e,o=e+i,l=t,u=t+r;return this.rectBuffer.set([n,l,o,l,n,u,n,u,o,l,o,u]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function Nc(e,t){let i=t?e:JSON.stringify(e),r=5381,n=i.length;for(;n;)r=r*33^i.charCodeAt(--n);let o=(r>>>0).toString(16);return o.length%2?"0"+o:o}var Vg=class{constructor(e){this.sheetPrefix=(e==null?void 0:e.sheetPrefix)||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(e){let t=e.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),i=this.sheetPrefix+Nc(t,!0);return this.stylesheetClasses.indexOf(i)!==-1||(this.stylesheetClasses.push(i),this.activeStylesheetClasses.push(i),this.stylesheetEntries[i]=t,this.sheetsDidUpdate=!0),i}removeStylesheet(e){let t=this.sheetPrefix+Nc(e,!0);this.stylesheetClasses.indexOf(t)&&(this.stylesheetClasses=this.stylesheetClasses.filter(i=>i!==t)),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let e of this.activeStylesheetClasses)if(this.stylesheetClasses.indexOf(e)===-1)return!0;for(let e of this.stylesheetClasses)if(this.activeStylesheetClasses.indexOf(e)===-1)return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map(e=>`.${e}{${this.stylesheetEntries[e]}}`).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},Gg=class{constructor(e,t){this.visible=[],this.previousVisible=[],this.htmlIds=[],this.firstMeaningfulPaint=!1,this.paintTx=1,this.zIndex=0,this.htmlContainer=e,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options=A({triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:""},t||{}),this.stylesheet=new Vg({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.classes={hostClassName:this.stylesheet.addStylesheet(`
        position: absolute;
        transform-origin: 0px 0px;
      `),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(e){if(this.htmlContainer&&(this.options.box||e.props.className||e.props.html||e.props.href)){let t=document.createElement(e.props.href?"a":"div");if(e.props.href){t.style.display="block",t.href=e.props.href;let i=e.props.hrefTarget||"_blank";t.target=i,i!=="_self"&&(t.rel="noopener noreferrer")}t.title=e.props.title||"",this.options.inlineStyles?(t.style.display="block",t.style.position="absolute",t.style.overflow="hidden",t.style.transformOrigin="0px 0px"):t.classList.add(this.classes.hostClassName),e.__host={element:t,revision:null,relative:!1},this.updateHtmlHost(e,e.width,e.height),e.__onCreate&&e.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(e,t,i){if(e.__revision!==e.__host.revision){let r=e.__host.element,n=[this.classes.hostClassName];if(e.props.interactive?this.options.inlineStyles?r.style.pointerEvents="all":n.push(this.classes.interactive):this.options.inlineStyles?r.style.pointerEvents="none":n.push(this.classes.nonInteractive),e.props.href){r.style.display="block",r.href=e.props.href;let l=e.props.hrefTarget||"_blank";r.target=l,l!=="_self"?r.rel="noopener noreferrer":r.rel=""}else r.href&&r.removeAttribute("href");if(e.props.title&&(r.title=e.props.title||""),e.props.className&&(n.push(e.props.className),e.hovering&&n.push(`${e.props.className}--hover`),e.pressing&&n.push(`${e.props.className}--active`)),e.props.relativeStyle?(r.style.width=`${t||e.width}px`,r.style.height=`${i||e.height}px`):(r.style.width=`${e.width}px`,r.style.height=`${e.height}px`),e.props.style){Object.assign(r.style,e.props.style||{},e.hovering?e.props.hoverStyles||{}:{},e.pressing?e.props.pressStyles||{}:{});return}if(this.options.text&&e instanceof _a){e.text&&(r.innerText=e.text),e.backgroundColor&&(r.style.backgroundColor=e.backgroundColor),e.color&&(r.style.color=e.color),e.props.font&&(r.style.font=e.props.font),e.props.textAlign&&(r.style.textAlign=e.props.textAlign),e.__host.revision=e.__revision;let l=n.join(" ");r.className=l,r.part=l}e instanceof $s&&(this.options.box||e.props.className||e.props.html)&&(e.props.backgroundColor&&(r.style.backgroundColor=e.props.backgroundColor),e.props.border!==r.style.border&&(r.style.border=e.props.border));let o=n.join(" ");r.className=o,r.part=o}}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previousVisible)this.visible.indexOf(r)===-1&&this.htmlContainer&&r.__id&&this.htmlIds.indexOf(r.__id)!==-1&&this.htmlContainer.removeChild(r.__host.element);this.previousVisible=this.visible}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){let i=this.rendererPosition.width/e,r=this.rendererPosition.height/t;return i<r?r:i}getViewportBounds(e,t,i){return null}isReady(){return!1}paint(e,t,i,r,n,o){if(this.zIndex++,(this.options.text&&e instanceof _a||e instanceof $s&&(this.options.box||e.props.className||e.props.html))&&e.__host.tx!==this.paintTx&&(this.visible.push(e),e.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(e,n,o);let l=n/e.width,u=e.__host.element;u.style.zIndex=`${this.zIndex}`,e.props.relativeStyle?u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px)`:u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px) scale(${l})`,this.previousVisible.indexOf(e)===-1&&this.htmlContainer.appendChild(u),this.htmlIds.indexOf(e.__id)===-1&&this.htmlIds.push(e.__id)}}pendingUpdate(){return!1}prepareLayer(e){e.__host||(e instanceof _a||e instanceof $s)&&this.createHtmlHost(e)}resize(e,t){typeof e<"u"&&typeof t<"u"&&(this.htmlContainer.style.width=`${e}px`,this.htmlContainer.style.height=`${t}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},ol=class{constructor(e,t,i){this.activatedEvents=[],this.eventHandlers=[],this.pointerMoveEvent=void 0,this.pointerEventState={isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]},this._realPointerMove=n=>{this.pointerMoveEvent=n},this.onWheelEvent=n=>{n.preventDefault(),this.onPointerEvent(n)},this.onTouchEvent=n=>{let o=Es[n.type],l=[],u=n.touches.length;for(let h=0;h<u;h++){let g=n.touches.item(h);if(!g)continue;let{x:f,y}=this.runtime.viewerToWorld(g.clientX-this.bounds.left,g.clientY-this.bounds.top),S={id:g.identifier,x:f,y};l.push(S)}l.length&&this.assignToEvent(n,l[0].x,l[0].y),o!=="onTouchEnd"?(this.pointerEventState.lastTouches=l,n.atlasTouches=l,this.runtime.world.propagateTouchEvent(o,n,l)):(n.atlasTouches=[],this.runtime.world.propagateTouchEvent(o,n,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])},this.onPointerEvent=n=>{let o=Es[n.type];if(o&&this.runtime.world.activatedEvents.indexOf(o)!==-1){let{x:l,y:u}=this.runtime.viewerToWorld(n.clientX-this.bounds.left,n.clientY-this.bounds.top);this.assignToEvent(n,l,u),this.runtime.world.propagatePointerEvent(o,n,l,u)}},this.onPointerDown=n=>{this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=n.clientX,this.pointerEventState.mouseDownStart.y=n.clientY,setTimeout(()=>{this.runtime&&(this.pointerEventState.isClicking=!1)},250),setTimeout(()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let o=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",n,o.x,o.y)}},800),this.onPointerEvent(n)},this.onPointerUp=n=>{if(this.pointerEventState.isClicking){let{x:o,y:l}=this.runtime.viewerToWorld(n.clientX-this.bounds.left,n.clientY-this.bounds.top);this.assignToEvent(n,o,l),this.runtime.world.propagatePointerEvent("onClick",n,o,l)}if(this.pointerEventState.isDragging){for(let o of this.pointerEventState.itemsBeingDragged)o.dispatchEvent("onDragEnd",n);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(n)},this.onPointerMove=n=>{this.pointerMoveEvent=void 0;let{x:o,y:l}=this.runtime.viewerToWorld(n.clientX-this.bounds.left,n.clientY-this.bounds.top);if(Number.isNaN(o)||Number.isNaN(l))return;this.assignToEvent(n,o,l),this.runtime.world.propagatePointerEvent("onPointerMove",n,o,l);let u=this.runtime.world.propagatePointerEvent("onMouseMove",n,o,l),h=[],g=[];for(let f of u)h.push(f.id),g.push(f),this.pointerEventState.mousedOver.indexOf(f)===-1&&(f.dispatchEvent("onMouseEnter",n),f.dispatchEvent("onPointerEnter",n),f.dispatchEvent("onMouseOver",n),f.dispatchEvent("onPointerOver",n));for(let f of this.pointerEventState.mousedOver)h.indexOf(f.id)===-1&&(f.dispatchEvent("onMouseLeave",n),f.dispatchEvent("onPointerLeave",n),f.dispatchEvent("onMouseOut",n),f.dispatchEvent("onPointerOut",n));if(this.pointerEventState.isDragging)for(let f of this.pointerEventState.itemsBeingDragged)f.dispatchEvent("onDrag",n);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&Eo(this.pointerEventState.mouseDownStart,{x:n.clientX,y:n.clientY})>50){let f=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",D(A({},n),{atlas:{x:f.x,y:f.y}}),f.x,f.y)}this.pointerEventState.mousedOver=g},this.element=e,this.runtime=t,this.unsubscribe=t.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=e.getBoundingClientRect(),this.listening=!1,this.options=A({simulationRate:0},i||{});let r=0;t.registerHook("useFrame",n=>{r+=n,r>this.options.simulationRate&&this.pointerMoveEvent&&(r=0,t.updateNextFrame())}),t.registerHook("useBeforeFrame",()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)}),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(e){e==="event-activation"&&this.listening==!1&&this.activateEvents()}assignToEvent(e,t,i){ol.eventPool.atlas.x=t,ol.eventPool.atlas.y=i,e.atlas=ol.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(e){return e.startsWith("on")?e.slice(2).toLowerCase():e.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[e,t]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(e),t)}},jc=ol;jc.eventPool={atlas:{x:0,y:0}};function Yg({interactive:e=!0,viewport:t,forceRefresh:i,canvasElement:r,overlayElement:n,controllerConfig:o,unstable_webglRenderer:l,dpi:u,debug:h,canvasBox:g=!0,polygon:f=!0,navigatorElement:y,runtimeOptions:S}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let C=e?zg(A({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},o||{})):void 0,_=new Sg([l?new lC(r,{dpi:u}):new zE(r,{dpi:u,debug:h,box:g,polygon:f}),n?new Gg(n,{box:l||!g,text:!0,triggerResize:i}):void 0,y?new NE(y):void 0]),T=new Go(_,new ln(1024,1024),t,C?[C]:[],S),R=new jc(r,T);return{name:"default-preset",em:R,runtime:T,renderer:_,controller:C,canvas:r,navigator:y,unmount(){zc(T),T.stopControllers(),T.stop(),T.reset(),R&&R.stop()}}}var cn=1+Number.MIN_VALUE,uC=class{constructor(e,t){this.pending=!0,this.zIndex=0,this.lastKnownScale=1,this.currentlyVisible=[],this.previouslyVisible=[],this.container=e,this.rendererPosition=e.getBoundingClientRect();let{width:i,height:r}=this.rendererPosition;this.width=i,this.height=r,this.options=A({addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000"},t||{}),this.stylesheet=new Vg({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previouslyVisible)this.currentlyVisible.indexOf(r)===-1&&this.container.removeChild(r);for(let r of this.currentlyVisible)this.previouslyVisible.indexOf(r)===-1&&this.container.appendChild(r);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let i=this.width/e,r=this.height/t,n=i<r?r:i;return Number.isNaN(n)||(this.lastKnownScale=n),this.lastKnownScale}getViewportBounds(e,t,i){return null}createImage(){let e=document.createElement("img");return this.options.imageClass?(e.className=this.options.imageClass,this.options.addPart&&e.setAttribute("part",this.options.imageClass)):(e.style.position="absolute",e.style.pointerEvents="none",e.style.userSelect="none"),this.options.setDraggableFalse&&e.setAttribute("draggable","false"),e}paint(e,t,i,r,n,o){if(this.pending=!1,this.zIndex++,e instanceof ur){if(!e.__host){let u=this.createImage();u.src=e.uri,e.__host=u,this.container.appendChild(e.__host)}let l=e.__host;this.currentlyVisible.push(l),l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+cn).toFixed(2)}px;height:${(o+cn).toFixed(2)}px;`):(l.style.width=`${n+cn}px`,l.style.height=`${o+cn}px`),l.style.transform=`translate(${i}px, ${r}px)`}if(e instanceof on){if(e.__host||(e.__host={images:[]}),!e.__host.images[t]){let u=e.getImageUrl(t),h=this.createImage();h.src=u,e.__host.images[t]=h,this.container.appendChild(h)}let l=e.__host.images[t];l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.currentlyVisible.push(l),this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+cn).toFixed(2)}px;height:${(o+cn).toFixed(2)}px;`):(l.style.width=`${n+cn}px`,l.style.height=`${o+cn}px`),l.style.transform=`translate(${i}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(e){}finishLayer(e){}reset(){}};function cC({interactive:e,viewport:t,forceRefresh:i,containerElement:r,overlayElement:n,controllerConfig:o}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let l=e?zg(A({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},o||{})):void 0,u=new uC(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image"}),h=n?new Sg([u,new Gg(n,{box:!0,text:!0,triggerResize:i})]):u,g=new Go(h,new ln(1024,1024),t,l?[l]:[]),f=new jc(r,g);return{name:"static-preset",em:f,runtime:g,renderer:h,controller:l,container:r,overlay:n,unmount(){zc(g),g.stopControllers(),g.stop(),f&&f.stop()}}}var hC={"default-preset":Yg,"static-preset":cC},dC={};function fC(e,t){let i=ke(),r=ke(),n=ke(),o=ke(),l=ke({width:t.width,height:t.height,didUpdate:!0}),[u="default-preset",h=dC]=Array.isArray(e)?e||[]:[e],[g,f]=ze(null);Tt(()=>{let S=r.current,C=o.current,_=i.current,T=n.current,R=(hC[u]||Yg)(A({containerElement:C,canvasElement:S,overlayElement:_,navigatorElement:T,viewport:l.current,dpi:window.devicePixelRatio||1,forceRefresh:t.forceRefresh,unstable_webglRenderer:t.unstable_webglRenderer},h||{}));return f(R),()=>{R&&(R.unmount(),S&&(S.height=0,S.width=0),_&&(_.innerHTML=""),T&&(T.height=0,T.width=0))}},[u,h]);let y=Ae(()=>({canvas:r,overlay:i,container:o,navigator:n}),[]);return[u,g,l,y]}function pC(e){return Ae(()=>Nc(e),e)}var Pa=J.forwardRef((e,t)=>J.createElement("div",D(A({},e),{ref:t,part:e.className}))),Xg=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],gC=e=>{var t=e,{htmlChildren:i,renderPreset:r,onCreated:n,mode:o="explore",resetWorldOnChange:l=!0,unstable_webglRenderer:u=!1,unstable_noReconciler:h=!1,hideInlineStyle:g=!1,controllerConfig:f,children:y,overlayStyle:S,containerStyle:C,enableNavigator:_,className:T,containerProps:R={},homePosition:O,homeOnResize:E,homeCover:F,background:z,runtimeOptions:U,debug:H,filters:G}=t,V=oe(t,["htmlChildren","renderPreset","onCreated","mode","resetWorldOnChange","unstable_webglRenderer","unstable_noReconciler","hideInlineStyle","controllerConfig","children","overlayStyle","containerStyle","enableNavigator","className","containerProps","homePosition","homeOnResize","homeCover","background","runtimeOptions","debug","filters"]);let[le,q]=ze(o),[ne,ge]=ze(!1),de=ke(!1),[we,me]=ze(0),ce=Ae(()=>(typeof r=="string"&&(r=[r,{}]),H?r?[r[0],A({debug:H},r[1]||{})]:["default-preset",{debug:H}]:r||"default-preset"),[r,H]),[We,ee,Pe]=jg({scroll:!0}),Oe=ke(),Ge=ue=>{Oe.current=ue,We(ue)},[ut,K,Ce,dt]=fC(ce,{width:V.width,height:V.height,forceRefresh:Pe,unstable_webglRenderer:u}),[pt,Et]=ze("");fe(()=>{q(o)},[o]),fe(()=>{K&&K.em&&K.em.updateBounds()},[K,ee]),fe(()=>{K==null||K.runtime.setOptions(U||{})},[U]),fe(()=>{K&&K.runtime&&(K.runtime.mode=le),ne&&K&&(K.ready=!0)},[K,ne,le]),fe(()=>{K&&(F||(K.runtime.manualHomePosition=!!O,K.runtime.setHomePosition(O)))},[K,F,O]),fe(()=>{if(K){let ue=K.runtime;ue.resize(Ce.current.width,V.width,Ce.current.height,V.height),Ce.current.width=V.width,Ce.current.height=V.height,ue.updateNextFrame(),Ce.current.didUpdate=!0}},[K,V.width,V.height]),fe(()=>{if(G&&K){let ue=K.runtime,xe=!1;ue.hookOptions.enableFilters=!0;for(let Fe of Xg)G[Fe]?G[Fe]!==K.runtime.hookOptions.filters[Fe]&&(ue.hookOptions.filters[Fe]=G[Fe],xe=!0):ue.hookOptions.filters[Fe]&&(ue.hookOptions.filters[Fe]=0,xe=!0);xe&&ue.updateNextFrame()}else if(K){let ue=K.runtime;for(let xe of Xg)ue.hookOptions.filters[xe]=0;ue.hookOptions.enableFilters=!1,ue.updateNextFrame()}},[K,G]),Aa(()=>{if(K&&(K.overlay&&(K.overlay.style.width=`${ee.width}px`,K.overlay.style.height=`${ee.height}px`),K.container&&(K.container.style.width=`${ee.width}px`,K.container.style.height=`${ee.height}px`),F)){let ue=K.runtime.world.width,xe=K.runtime.world.height,Fe=ue/xe,rt=Ce.current.width,Ct=Ce.current.height,ii=rt/Ct;if(Fe>ii){ii=Ct/rt,K.runtime.manualHomePosition=!0;let Oi=(ue-xe/ii)/2;F==="start"&&(Oi=0),F==="end"&&(Oi=ue-xe/ii),K.runtime.setHomePosition({x:Oi,y:0,width:xe/ii,height:xe})}else{let Oi=(xe-ue/ii)/2;F==="start"&&(Oi=0),F==="end"&&(Oi=xe-ue/ii),K.runtime.manualHomePosition=!0,K.runtime.setHomePosition({x:0,y:Oi,width:ue,height:ue/ii})}E&&K.runtime.goHome({})}},[K,ee.height,ee.width,F,we]),Aa(()=>{let ue=()=>{if(K){let xe=K.runtime;Ce.current.width!==V.width&&Ce.current.height!==V.height&&(xe.resize(Ce.current.width,V.width,Ce.current.height,V.height),Ce.current.width=V.width,Ce.current.height=V.height,xe.updateNextFrame(),Ce.current.didUpdate=!0)}};return window.addEventListener("resize",ue),()=>window.removeEventListener("resize",ue)},[K,V.height,V.width]);let Ri={width:120},cr=()=>{if(K&&K.navigator){let ue=K.runtime.world.height,xe=K.runtime.world.width,Fe=window.devicePixelRatio||1,rt=Ri.width,Ct=Ri.width/xe*ue;K.navigator.width=rt*Fe,K.navigator.height=Ct*Fe,K.navigator.style.width=rt+"px",K.navigator.style.height=Ct+"px"}};Aa(()=>{if(K){cr();let ue=K.runtime;return ue.world.addLayoutSubscriber(xe=>{xe==="recalculate-world-size"&&(cr(),ue.resize(Ce.current.width,V.width,Ce.current.height,V.height),me(Fe=>Fe+1))})}return()=>{}},[K,V.width,V.height]);let hr=Ue(function(ue){let xe=()=>{ge(!0)};return fe(()=>{if(K){K.runtime.goHome();let Fe=n&&n(K);return void(Fe&&Fe.then?Fe.then(xe):xe())}else throw new Error("Invalid configuration - no runtime found")},[]),ue.children},[K]);fe(()=>{if(K){let ue=K.runtime;if(l)return ue.world.addLayoutSubscriber(xe=>{xe==="recalculate-world-size"&&ue.goHome()})}return()=>{}},[K,l]),fe(()=>K?K.runtime.registerHook("useBeforeFrame",()=>{var ue;if(Ce.current.didUpdate&&K.canvas){let xe=window.devicePixelRatio||1,Fe=Ce.current.width,rt=Ce.current.height;K.canvas.width=Fe*xe,K.canvas.height=rt*xe,K.canvas.style.width=Fe+"px",K.canvas.style.height=rt+"px",(ue=K.canvas.getContext("2d"))==null||ue.scale(xe,xe),K&&K.em&&K.em.updateBounds(),Ce.current.didUpdate=!1}}):()=>{},[K,l]),fe(()=>{let ue=()=>{K&&(q("sketch"),Et("mode-sketch")),window.removeEventListener("keyup",ue)},xe=Fe=>{if(Fe.code==="Space"&&K&&K.runtime.mode==="sketch"){if(Fe.target&&Fe.target.tagName&&Fe.target.tagName.toLowerCase()==="input")return;Fe.preventDefault(),q("explore"),Et("mode-explore"),window.addEventListener("keyup",ue)}};return window.addEventListener("keydown",xe),()=>{window.removeEventListener("keydown",xe),window.removeEventListener("keyup",ue)}},[K]),de.current=!0;let Li=V,{height:jt,width:Zi}=Li,Wt=oe(Li,["height","width"]),Qr=pC([V.width,V.height]),Vr=!0;return ce&&Array.isArray(ce)&&ce.length>1&&ce[1].interactive===!1&&(Vr=!1),z=z??"#000",Oe.current&&(z=getComputedStyle(Oe.current).getPropertyValue("--atlas-background")||z),J.createElement(Pa,{ref:Ge,className:["atlas",g?"":`atlas-width-${Qr}`,pt,T,`atlas-${ut}`].filter(Boolean).join(" ").trim(),style:A(A({},C),g?{}:{width:V.width,height:V.height})},ut==="static-preset"?J.createElement(Pa,A({className:"atlas-static-container",ref:dt.container,tabIndex:0},R)):J.createElement("canvas",D(A(A({className:"atlas-canvas",part:"atlas-canvas",tabIndex:0},Wt),R),{ref:dt.canvas,"data-background":z})),J.createElement(Pa,{className:["atlas-overlay",Vr?"atlas-overlay--interactive":""].filter(Boolean).join(" ").trim(),style:A({},S||{}),ref:dt.overlay},h?J.createElement(hr,null,J.createElement(nl.Provider,{value:ee},J.createElement(il.Provider,{value:le},J.createElement(rl.Provider,{value:K},y)))):J.createElement(oC,{bounds:ee,preset:K,mode:le,setIsReady:ge,onCreated:n},y)),_?J.createElement(Pa,{className:"atlas-navigator"},J.createElement("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:dt.navigator})):null,g?J.createElement("style",null,`.atlas-width-${Qr} { width: ${V.width}px; height: ${V.height}px; }`):J.createElement("style",null,`
        .atlas { position: relative; display: flex; background: ${z}; z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .atlas-width-${Qr} { width: ${V.width}px; height: ${V.height}px; }
        .atlas-canvas { flex: 1 1 0px; }
        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }
        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }
        .atlas-static-preset { touch-action: inherit; }
        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }
        .atlas-overlay { position: absolute; top: 0; left: 0; none; overflow: hidden; }
        /** setting the pointer events to none means that Atlas will own the touch and mousewheel events **/
        .atlas-overlay--interactive { pointer-events: none; }
        .atlas-static-image { position: absolute; user-select: none; transform-origin: 0px 0px; }
        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }
        .atlas-navigator-canvas { width: 100%; }
      `),i)};function mC(e){return Number(e)==e?`${e}px`:e}var vC=e=>{var t=e,{resizeHash:i,aspectRatio:r,containerProps:n={}}=t,o=oe(t,["resizeHash","aspectRatio","containerProps"]);let[l,u,h]=jg(),g=o,{height:f,width:y}=g,S=oe(g,["height","width"]);fe(()=>{h()},[y,f,i,h]);let C=Ae(()=>r?{width:u.width,height:u.width*(1/r)}:u,[u,r]);return J.createElement(Pa,A({ref:l,className:"atlas-container"},n),C.width?J.createElement(gC,A({width:C.width||100,height:C.height||100},S),o.children):null,o.hideInlineStyle?null:J.createElement("style",null,`
          .atlas-container { 
            display: var(--atlas-container-display, block);
            flex: var(--atlas-container-flex, none);
            width: var(--atlas-container-width, ${y?`${y}px`:"100%"});
            height: var(--atlas-container-height, ${mC(f||(r?C.height:512))})  
          }
      `),o.htmlChildren)},ll=()=>Yt(rl),hn=()=>{let e=ll();return e?e.runtime:void 0},Bc=(e,t=[])=>{let i=hn();fe(()=>i?i.registerHook("useAfterFrame",e):()=>{},t)},Dc=(e,t=[])=>{let i=hn();fe(()=>i?i.registerHook("useFrame",e):()=>{},t)},yC=()=>{let e=ll();return e&&e.canvas?e.canvas:void 0};function Zg(){return Yt(nl)}var Kg=({onCreate:e})=>{let t=ke({x:0,y:0}),i=yC(),r=Zg(),n=hn(),[o,l]=ze(),[u,h]=ze(),g=Oc();return Dc(()=>{n&&o&&!u&&(n.pendingUpdate=!0)},[o,u]),Bc(()=>{if(o&&i&&n){let f=i.getContext("2d");if(f){let{x:y,y:S,width:C,height:_}=n.worldToViewer(o.x,o.y,(u?u.x:t.current.x)-o.x,(u?u.y:t.current.y)-o.y);f.lineWidth=u?3:1,f.strokeStyle="#fff",f.strokeRect(y,S,C,_),f.lineWidth=u?3:1,f.strokeStyle="#000",f.strokeRect(y+1,S+1,C-2,_-2)}}},[o,u]),fe(()=>{let f=y=>{if(r&&n){let{x:S,y:C}=n.viewerToWorld(y.clientX-r.left,y.clientY-r.top);t.current.x=~~S,t.current.y=~~C}};return i?(i.addEventListener("mousemove",f),()=>i.removeEventListener("mousemove",f)):()=>{}},[r,i,n]),fe(()=>{let f=y=>{g==="sketch"&&(l({x:Math.round(t.current.x),y:Math.round(t.current.y)}),h(void 0))};return i?(i.addEventListener("mousedown",f),()=>i.removeEventListener("mousedown",f)):()=>{}},[i,g]),fe(()=>{let f=y=>{o&&!u&&h({x:Math.round(t.current.x),y:Math.round(t.current.y)})};return i?(i.addEventListener("mouseup",f),()=>i.removeEventListener("mouseup",f)):()=>{}},[i,o,u]),fe(()=>{o&&u&&e({x:Math.min(o.x,u.x),y:Math.min(o.y,u.y),width:Math.abs(u.x-o.x),height:Math.abs(u.y-o.y)})},[o,e,u]),null};async function bC(e,t,i){if(wo.startsWith("18.")){let r=await Promise.resolve().then(()=>De(Hf(),1)),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then(()=>(Qe(),xs)),n=r.default?r.default.render:r.render,o=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){o(e)}}}}var wC=J.forwardRef((e,t)=>{var i=e,{children:r}=i,n=oe(i,["children"]);let o=ke(),l=hn(),u=ke(0),h=ke(),g=ke();return Dc(()=>{var f,y,S,C;if(n.relative){let _=o.current;if(_&&l){let T=l.getScaleFactor();u.current!==T&&(u.current=T,_.style.transformOrigin="0 0",_.style.transform=`scale(${1/u.current})`,_.style.width=`${u.current*100}%`,_.style.height=`${u.current*100}%`,o.current&&((y=(f=h.current)==null?void 0:f.__owner.value)!=null&&y.rotation)&&(_.style.transform=`scale(${1/u.current}) translate(50%, 50%) rotate(${((C=(S=h.current)==null?void 0:S.__owner.value)==null?void 0:C.rotation)||0}deg)  translate(-50%, -50%)`))}}},[n.relative]),Tt(()=>{let f=h.current;t&&f&&(typeof t=="function"?t(f):t.current=f);async function y(){if(f&&f.__host){let S=n.relative?J.createElement("div",{ref:o},r):r;await bC(f.__host.element,S,g)}}f&&f.__host?y():f&&(f.__onCreate=y)},[t,r,h,n.relative]),Tt(()=>()=>{g.current&&setTimeout(()=>{g.current.unmount()},0)},[]),J.createElement("box",D(A({html:!0},n),{ref:h}))});wC.displayName="HTMLPortal";var Jg=(e,t,i=[])=>{let r=hn(),n=r?r.world:void 0;fe(()=>{if(r){let o=t,l=Es[e];r.world.activatedEvents.push(l);let u=l.slice(2).toLowerCase();return r.world.addEventListener(u,o),()=>{r.world.removeEventListener(u,o)}}return()=>{}},[n,e,...i])};function em(e,t){if(e===0)return[0,1];if(t===0)return[1,0];let i=Math.abs(e)/Math.abs(t);return[i,1-i]}function xC(){let e=ke({ctrl:!1,shift:!1,alt:!1});return Tt(()=>{function t(r){r.key==="Shift"&&(e.current.shift=!0),r.key==="Control"&&(e.current.ctrl=!0),r.key==="Alt"&&(e.current.alt=!0)}function i(r){r.key==="Shift"&&(e.current.shift=!1),r.key==="Control"&&(e.current.ctrl=!1),r.key==="Alt"&&(e.current.alt=!1)}return window.addEventListener("keydown",t),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",i)}},[]),e}var _C=(e,t)=>{let i=Oc(),r=hn(),n=Zg(),o=ke(),l=ke(null),u=ke(),[h,g]=ze(!1),f=ke(!1),y=ke({north:0,south:0,east:0,west:0}),S=xC(),C=Ue(E=>F=>{if(f.current=!0,g(!0),n&&r){let{top:z,left:U}=n,H=r.viewerToWorld(F.pageX-U,F.pageY-z);u.current={x:H.x,y:H.y},o.current=E}},[n,r]),_=Ae(()=>e.width/e.height,[e.width,e.height]),T=Ue(E=>{if(!Math.abs(E.north-E.south+(E.east-E.west)))return;let F=-E.west+E.east,z=-E.north+E.south,U=e.width+F,H=e.height+z;if(U/H>=_){let G=H*_,V=U-G,[le,q]=em(E.east,E.west);E.west=E.west+V*q,E.east=E.east-V*le}else{let G=U/_,V=H-G,[le,q]=em(E.north,E.south);E.north=E.north+V*le,E.south=E.south-V*q}},[e.width,e.height,_]);Dc(()=>{u&&r&&r.updateNextFrame()}),fe(()=>{r&&r.updateNextFrame()},[r,h]);let R=Ue(E=>{var F;if(!r||!n||r.mode!=="sketch")return;let{top:z,left:U}=n,H=r.viewerToWorld(E.pageX-U,E.pageY-z),G=l.current,V=!e.maintainAspectRatio&&S.current.alt,le=!V&&S.current.shift&&((F=o.current)==null?void 0:F.indexOf("-"))!==-1;if((o.current==="translate"||o.current==="east"||o.current==="north-east"||o.current==="south-east")&&(y.current.east=H.x-(u.current?u.current.x:0),V&&(y.current.west=-y.current.east)),(o.current==="translate"||o.current==="west"||o.current==="north-west"||o.current==="south-west")&&(y.current.west=H.x-(u.current?u.current.x:0),V&&(y.current.east=-y.current.west)),(o.current==="translate"||o.current==="north"||o.current==="north-east"||o.current==="north-west")&&(y.current.north=H.y-(u.current?u.current.y:0),V&&(y.current.south=-y.current.north)),(o.current==="translate"||o.current==="south"||o.current==="south-west"||o.current==="south-east")&&(y.current.south=H.y-(u.current?u.current.y:0),V&&(y.current.north=-y.current.south)),(e.maintainAspectRatio||le)&&T(y.current),G){let q=y.current.west,ne=y.current.north,ge=e.width+y.current.east,de=e.height+y.current.south;G.points[1]=Math.min(q,ge),G.points[2]=Math.min(ne,de),G.points[3]=Math.max(q,ge),G.points[4]=Math.max(ne,de),r.updateNextFrame()}},[r,e.width,e.height,e.maintainAspectRatio,n]);Jg("mousemove",R,[e.width,e.height,n]),Jg("pointermove",R,[e.width,e.height,n]);let O=ke();return fe(()=>{O.current=()=>{if(f.current){let E=y.current.west,F=y.current.north,z=e.width+y.current.east,U=e.height+y.current.south,H=Math.min(E,z),G=Math.min(F,U),V=Math.max(E,z),le=Math.max(F,U),q={x:(e.x||0)+H,y:(e.y||0)+G,width:V-H||1,height:le-G||1};e.maintainAspectRatio,t(q),o.current=void 0,u.current=void 0,y.current.east=0,y.current.west=0,y.current.north=0,y.current.south=0,f.current=!1,g(!1)}}},[t,e.height,e.width,e.x,e.y]),fe(()=>{let E=()=>{O.current&&O.current()};return window.addEventListener("pointerup",E),window.addEventListener("touchend",E),()=>{window.removeEventListener("pointerup",E),window.removeEventListener("touchend",E)}},[]),{portalRef:l,mode:i,mouseEvent:C,onPointerMoveCallback:R,isEditing:h}};function tm(e,t){return e?t?D(A(A({},e),t||{}),{":hover":e[":hover"]?Object.assign(e[":hover"]||{},t[":hover"]||{}):t[":hover"],":active":e[":active"]?Object.assign(e[":active"]||{},t[":active"]||{}):t[":hover"]}):e:t}Xe(),Xe();var SC=0;function Jt(e,t,i,r,n){var o,l,u={};for(l in t)l=="ref"?o=t[l]:u[l]=t[l];var h={type:e,props:u,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--SC,__source:n,__self:r};if(typeof e=="function"&&(o=e.defaultProps))for(l in o)u[l]===void 0&&(u[l]=o[l]);return Te.vnode&&Te.vnode(h),h}var EC={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]},CC={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],duration:0,height:0,width:0},kC={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],services:[]},AC={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:[],behavior:[],homepage:[],items:[],label:null,logo:[],metadata:[],motivation:null,navDate:null,provider:[],partOf:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:[],requiredStatement:null,rights:null,seeAlso:[],service:[],services:[],start:null,structures:[],summary:null,thumbnail:[],viewingDirection:"left-to-right"},PC={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],start:null,supplementary:null,viewingDirection:"left-to-right"},TC={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:[],seeAlso:[],homepage:[]},im=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function IC(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e.type=="string"){let t=im.indexOf(e.type);if(t!==-1)return im[t]}if(e.profile)return"Service";throw new Error("Resource type is not known")}var rm=class{constructor(e,t={}){Ve(this,"traversals"),Ve(this,"options"),this.traversals=A({collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[]},e),this.options=A({allowUndefinedReturn:!1},t)}static all(e){return new rm({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map(t=>this.traverseType(t,this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(t=>this.traverseAgent(t))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(t=>this.traverseType(t,this.traversals.contentResource))),e.service&&(e.service=e.service.map(t=>this.traverseType(t,this.traversals.service))),e.services&&(e.services=e.services.map(t=>this.traverseType(t,this.traversals.service))),e.logo&&(e.logo=e.logo.map(t=>this.traverseType(t,this.traversals.contentResource))),e.homepage&&(e.homepage=e.homepage.map(t=>this.traverseType(t,this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(t=>typeof t=="string"||!t.type?this.traverseType(t,this.traversals.contentResource):t.type==="Canvas"?this.traverseType(t,this.traversals.canvas):t.type==="AnnotationCollection"?this.traverseType(t,this.traversals.annotationCollection):this.traverseType(t,this.traversals.contentResource))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map(t=>this.traverseType(t,this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(t=>this.traverseType(t,this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(t=>t.type==="Collection"?this.traverseCollection(t):this.traverseManifest(t)),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseCanvas(t))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(t=>this.traverseAnnotationPage(t)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(t=>this.traverseAnnotationPage(t))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseAnnotation(t))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(t=>this.traverseContentResource(t)):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseType(e.posterCanvas,this.traversals.canvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseType(e.placeholderCanvas,this.traversals.canvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseType(e.accompanyingCanvas,this.traversals.canvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=(e.service||[]).map(t=>this.traverseType(t,this.traversals.service))),e}traverseContentResource(e){return e.type==="Choice"&&(e.items=e.items.map(t=>this.traverseContentResource(t))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(t=>typeof t=="string"?this.traverseCanvas({id:t,type:"Canvas"}):t.type==="Manifest"?this.traverseManifest(t):this.traverseRange(t))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){let t=IC(e);switch(t){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${t}`)}}},nm=["sc:Collection","sc:Manifest","sc:Canvas","oa:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function RC(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e["@type"]=="string"){let t=nm.indexOf(e["@type"]);if(t!==-1)return nm[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw new Error("Resource type is not known")}var sm=class{constructor(e,t={}){Ve(this,"traversals"),Ve(this,"options"),this.traversals=A({collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[]},e),this.options=A({convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1},t)}static all(e){return new sm({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Manifest"}:i),...(e.collections||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Collection"}:i),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map(t=>this.traverseManifest(typeof t=="string"?{"@id":t,"@type":"sc:Manifest"}:t))),e.collections&&(e.collections=e.collections.map(t=>this.traverseCollection(typeof t=="string"?{"@id":t,"@type":"sc:Collection"}:t))),e.members&&(e.members=e.members.map(t=>typeof t=="string"?t:this.traverseUnknown(t))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(t=>this.traverseSequence(t))),e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(t=>this.traverseCanvas(t))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(t=>this.traverseAnnotation(t))),e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationListItems(e))),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(t=>this.traverseAnnotation(t))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(t=>this.traverseContentResource(t))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(RC(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"oa:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)typeof n=="string"?r.push(this.traverseContentResource({"@id":n,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)r.push(this.traverseService(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(i=>this.traverseType(i,t))}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}},LC="http://library.stanford.edu/iiif/image-api/compliance.html#level0",am="http://library.stanford.edu/iiif/image-api/compliance.html#level1",om="http://library.stanford.edu/iiif/image-api/compliance.html#level2",OC="http://library.stanford.edu/iiif/image-api/conformance.html#level0",lm="http://library.stanford.edu/iiif/image-api/conformance.html#level1",um="http://library.stanford.edu/iiif/image-api/conformance.html#level2",$C="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",cm="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",hm="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",FC="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",dm="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",fm="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",MC="http://iiif.io/api/image/1/level0.json",zC="http://iiif.io/api/image/1/profiles/level0.json",pm="http://iiif.io/api/image/1/level1.json",gm="http://iiif.io/api/image/1/profiles/level1.json",mm="http://iiif.io/api/image/1/level2.json",vm="http://iiif.io/api/image/1/profiles/level2.json",NC="http://iiif.io/api/image/2/level0.json",jC="http://iiif.io/api/image/2/profiles/level0.json",ym="http://iiif.io/api/image/2/level1.json",bm="http://iiif.io/api/image/2/profiles/level1.json",wm="http://iiif.io/api/image/2/level2.json",xm="http://iiif.io/api/image/2/profiles/level2.json",BC="level0",_m="level1",Sm="level2",DC="http://iiif.io/api/image/2/level0",Em="http://iiif.io/api/image/2/level1",Cm="http://iiif.io/api/image/2/level2",UC=[Em,Cm,am,om,lm,um,cm,hm,dm,fm,pm,gm,mm,vm,ym,bm,wm,xm,_m,Sm],WC=[DC,Em,Cm,LC,am,om,OC,lm,um,$C,cm,hm,FC,dm,fm,MC,zC,pm,gm,mm,vm,NC,jC,ym,bm,wm,xm,BC,_m,Sm],Uc={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:"Unknown"};function Bn(e,t="none"){if(!e)return{};let i=Array.isArray(e)?e:[e],r={};for(let n of i){if(typeof n=="string"){r[t]=r[t]?r[t]:[],r[t].push(n||"");continue}if(!n["@language"]){r[t]=r[t]?r[t]:[],r[t].push(n["@value"]||"");continue}let o=n["@language"];r[o]=r[o]?r[o]:[],r[o].push(n["@value"]||"")}return r}function km(e){if(Array.isArray(e))return km(e.find(t=>typeof t=="string"));if(WC.indexOf(e)!==-1)return"level2";if(UC.indexOf(e)!==-1)return"level1";if(typeof e=="string")return e}function HC(e){let t=Array.isArray(e)?e:[e];for(let i of t)switch(i){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function qC(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function QC(e){return Array.isArray(e)?e:[e]}function VC(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}var GC=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Wc(e){let t=e["@id"]||e.id,i=e["@type"]||e.type,r=e.profile||void 0,n=e["@context"]||void 0;if(r){let o=qC(r);if(o)return o}if(n){let o=HC(n);if(o)return o}if(i){if(Array.isArray(i)){if(i.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(i.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";i=i[0]}for(let o of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${o}:`)){i=i.slice(o.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&GC.indexOf(i)!==-1)return i;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||e.format==="application/pdf")return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":i||"unknown"}var YC=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function XC(e){let t=e.match(YC);return t?t[0]:e}function ZC(e,t="Rights/License",i="none"){let r=null,n=[],o=Array.isArray(e)?e:[e];for(let l of o){let u=l?XC(l):void 0;if(u&&(u.indexOf("creativecommons.org")!==-1||u.indexOf("rightsstatements.org")!==-1)){u.startsWith("https://")?r=`http://${u.slice(8)}`:r=u;continue}u&&n.push({label:{[i]:[t]},value:{[i]:[u]}})}return[r,n]}var KC=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function JC(e){if(e){let t=Array.isArray(e)?e:[e],i=[];for(let r of t)r==="http://iiif.io/api/presentation/2/context.json"&&i.push("http://iiif.io/api/presentation/3/context.json"),KC.indexOf(r)===-1&&i.push(r);if(t.length)return i.length===1?i[0]:i}}function ek(e){return e?e.map(t=>({label:Bn(t.label),value:Bn(t.value)})):[]}function Wr(e){for(let t in e)(typeof e[t]>"u"||e[t]===null)&&delete e[t];return e}var Am=0;function Pm(e,t){let i=encodeURI(e.id||e["@id"]||"").trim();return i&&t?`${i}/${t}`:i||(Am++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${Am}`)}function Hr(e){let t=[...e.behavior||[]];return e.viewingHint&&t.push(e.viewingHint),{"@context":e["@context"]?JC(e["@context"]):void 0,id:(e["@id"]||Pm(e)).trim(),type:Wc(e),behavior:t.length?t:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:e.motivation?VC(e.motivation):void 0,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function Cr(e){let[t,i]=ZC(e.license),r=[...e.metadata?ek(e.metadata):[],...i];return{rights:t,metadata:r.length?r:void 0,label:e.label?Bn(e.label):void 0,requiredStatement:e.attribution?{label:Bn(Uc.attributionLabel),value:Bn(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?Bn(e.description):void 0,thumbnail:e.thumbnail}}function tk(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],i=[];for(let r of t)if(typeof r=="string"){if(r)switch(e["@type"]){case"sc:Manifest":i.push({id:r,type:"Collection"});break}}else r["@id"]&&i.push({id:r["@id"],type:Wc(r)});return i.length?i:void 0}function dn(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],i=e.contentLayer;return{provider:e.logo||t.length?[{id:Uc.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:Bn(Uc.providerName)}]:void 0,partOf:tk(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?QC(e.service):void 0,supplementary:i?[i]:void 0}}function ik(e){return Wr(D(A(A(A({},Hr(e)),Cr(e)),dn(e)),{items:e.members}))}function rk(e){let t=[],i=[];for(let n of e.sequences||[])n.canvases.length&&t.push(...n.canvases),n.behavior&&i.push(...n.behavior);let r=Hr(e);return i.length&&(r.behavior?r.behavior.push(...i):r.behavior=i),Wr(D(A(A(A({},r),Cr(e)),dn(e)),{items:t,structures:e.structures}))}function nk(e){return Wr(D(A(A(A({},Hr(e)),Cr(e)),dn(e)),{items:e.images&&e.images.length?[{id:Pm(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0}))}function sk(e){return Wr(D(A(A(A({},Hr(e)),Cr(e)),dn(e)),{items:e.resources}))}function ak(e){return!e.canvases||e.canvases.length===0?{canvases:[],behavior:[]}:{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[]}}function ok(e){return Wr(D(A(A(A({},Hr(e)),Cr(e)),dn(e)),{target:typeof e.on=="string"?encodeURI(e.on).trim():e.on,body:e.resource}))}function lk(e){let t=e;return Wr(A(A(A({},Hr(t)),Cr(t)),dn(t)))}function uk(e){let t=[];return e.default&&e.default!=="rdf:nil"&&t.push(e.default),e.item&&e.item!=="rdf:nil"&&t.push(...e.item),D(A(A({},Hr(e)),Cr(e)),{items:t})}function ck(e){return Wr(D(A(A(A({},Hr(e)),Cr(e)),dn(e)),{items:e.members}))}function hk(e){let t=e,{"@id":i,"@type":r,"@context":n,profile:o}=t,l=oe(t,["@id","@type","@context","profile"]);return i&&(l.id=i),l.type=Wc(e),l.type==="unknown"&&(l.type="Service"),o&&(l.profile=km(o)),Wr(A(A({},l),Cr(l)))}function dk(e){return Wr(A(A(A({},Hr(e)),Cr(e)),dn(e)))}var fk=new sm({collection:[ik],manifest:[rk],canvas:[nk],annotationList:[sk],sequence:[ak],annotation:[ok],contentResource:[lk],choice:[uk],range:[ck],service:[hk],layer:[dk]});function pk(e){return e&&e["@context"]&&(e["@context"]==="http://iiif.io/api/presentation/2/context.json"||e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||e["@context"]==="http://www.shared-canvas.org/ns/context.json")||e["@context"]==="http://iiif.io/api/image/2/context.json"?fk.traverseUnknown(e):e}function gk(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function Tm(e,t){if(typeof e=="string")return{id:e,type:t};if(!e.id)throw new Error(`Invalid resource does not have an ID (${t})`);return e}function mk(e){return(t,i)=>{let r=e[t]?e[t]:{};return n=>{let o=Tm(n,i||t);return o&&o.id&&t?(r[o.id]=r[o.id]?Object.assign({},r[o.id],o):Object.assign({},o),{id:o.id,type:t==="ContentResource"?t:o.type}):o}}}function vk(e){return(t,i)=>r=>{let{id:n,type:o}=Tm(r,i||t);if(typeof n>"u")throw new Error("Found invalid entity without an ID.");return t==="ContentResource"?e[n]=t:e[n]=o,r}}function yk(e){let t=JSON.stringify(e),i=5381,r=t.length;for(;r;)i=i*33^t.charCodeAt(--r);let n=(i>>>0).toString(16);return n.length%2?"0"+n:n}function Hc(e){return t=>typeof t=="string"?{id:t,type:e}:t.id?t.type?t:A({type:e},t):A({id:yk(t),type:e},t)}function Ms(e){return t=>A(A({},e),t)}function zs(e){return Array.isArray(e)?e:[e]}function bk(e){return e.body&&(e.body=zs(e.body)),e.seeAlso&&(e.seeAlso=zs(e.seeAlso)),e.body&&(e.body=zs(e.body)),e.audience&&(e.audience=zs(e.audience)),e.accessibility&&(e.accessibility=zs(e.accessibility)),e.motivation&&(e.motivation=zs(e.motivation)),e}function Im(e){let t=pk(e),i=gk(),r={},n=mk(i),o=vk(r),l=new rm({collection:[Ms(kC),o("Collection"),n("Collection")],manifest:[Ms(AC),o("Manifest"),n("Manifest")],canvas:[Ms(CC),o("Canvas"),n("Canvas")],annotationPage:[Hc("AnnotationPage"),Ms(EC),o("AnnotationPage"),n("AnnotationPage")],annotation:[Hc("Annotation"),bk,o("Annotation"),n("Annotation")],contentResource:[Hc("ContentResource"),o("ContentResource"),n("ContentResource")],range:[Ms(PC),o("Range","Canvas"),n("Range","Canvas")],agent:[Ms(TC),o("Agent"),n("Agent")]}).traverseUnknown(t);return{entities:i,resource:l,mapping:r}}var Dn="__$UNSET$__",Rm="__$UNWRAP$__";function wk(e,t){let i=e.requests[t],r=e.mapping[t];if(!(!r||i&&i.resourceUri&&!e.entities[r][i.resourceUri]))return e.entities[r][i?i.resourceUri:t]}function xk(e){let t={};for(let[i,r]of e){if(i===Rm&&r!==Dn)return r;r!==Dn&&typeof r<"u"&&r!==null&&(t[i]=r)}return t}function Lm(e,t,i){if(!t.type||!t.id)throw new Error("Unknown entity");if(!i[t.type])throw new Error(`Serializer not found for ${t.type}`);function r(n){let o=i[n.type];if(!o)return Dn;let l=wk(e,n.id)||(n.id&&n.type?n:null);if(!l)return Dn;let u=o(l,e,{isTopLevel:t.id===n.id}),h=u.next();for(;!h.done;){let g=h.value,f=Dn;if(g)if(Array.isArray(g)){let y=[];for(let S of g)y.push(r(S));f=y}else f=r(g);h=u.next(f)}return h.value===Dn?Dn:xk(h.value)}return r(t)}function Ns(e){if(!e)return;let t=Object.keys(e);if(t.length!==0){if(t.length===1){let i=t[0];if(!i)return"";let r=(e[i]||[]).join("");return i==="@none"||i==="none"||i==="en"?r:{"@language":i,"@value":r}}return t.map(i=>({"@language":i,"@value":(e[i]||[]).join("")}))}}function Om(e){return Array.isArray(e)?e.map(t=>Om(t)):typeof e=="string"?e:e.type&&e.type==="Canvas"?e.id:e}function fn(e,t=!1){if(e)return e.length>1&&!t?e:e[0]||void 0}function _k(e){if(e){if(typeof e=="string")return{"@id":e};if("@id"in e){let t=A({},e);return delete t["@type"],t}return{"@context":"http://iiif.io/api/image/2/context.json","@id":e.id,profile:`http://iiif.io/api/image/2/profiles/${e.profile}.json`}}}function Un(e,t){return[["@id",e.id],["@type",t],["format",e.format],["height",e.height],["width",e.width],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0]]}function*Wn(e){let t=e.provider?yield e.provider[0]:void 0;return[["label",Ns(e.label)],["metadata",e.metadata&&e.metadata.length?e.metadata.map(i=>({label:Ns(i.label)||"",value:Ns(i.value)||""})):void 0],["description",Ns(e.summary)],["thumbnail",fn(yield e.thumbnail)],["navDate",e.navDate],["logo",t?fn(t.logo):void 0],["homepage",t?t.homepage:void 0],["attribution",e.requiredStatement?Ns(e.requiredStatement.value):void 0]]}function*Ta(e){return[["seeAlso",fn(yield e.seeAlso)],["service",fn((e.service||[]).map(_k))],["rendering",fn(yield e.rendering)],["startCanvas",e.start?e.start.id:void 0]]}var $m={Manifest:function*(e){return[...Un(e,"sc:Manifest"),...yield*Wn(e),...yield*Ta(e),["sequences",[{"@id":`${e.id}/sequence0`,"@type":"sc:Sequence",canvases:yield e.items}]],["structures",yield e.structures]]},Canvas:function*(e){let t=(yield e.items)[0];return[...Un(e,"sc:Canvas"),...yield*Wn(e),...yield*Ta(e),["images",t?[t.resources]:void 0],["annotations",e.annotations&&e.annotations.length?fn(yield e.annotations):void 0]]},AnnotationPage:function*(e){return[...Un(e,"sc:AnnotationList"),...yield*Wn(e),["resources",e.items&&e.items.length?fn(yield e.items):void 0]]},Annotation:function*(e){return[["@id",e.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",Om(e.target)],["resource",fn(yield e.body,!0)]]},ContentResource:function*(e){switch(e.type){case"Image":return[...Un(e,"dctypes:Image"),...yield*Wn(e),...yield*Ta(e)];case"Text":case"Dataset":default:return[...Un(e,void 0),...yield*Wn(e)]}},AnnotationCollection:function*(e){return[["@id",e.id],["@type","sc:Layer"],["label",Ns(e.label)]]},Collection:function*(e){return[...Un(e,"sc:Collection"),...yield*Wn(e),...yield*Ta(e),["members",yield*e.items]]},Range:function*(e){let t=[],i=[];if(e.items)for(let r of e.items){let n=yield r;t.push({"@id":r.id,"@type":r.type,label:n?n.label:void 0,within:e.id}),r.type==="Canvas"&&i.push(r.id)}return[...Un(e,"sc:Range"),...yield*Wn(e),...yield*Ta(e),["canvases",i.length===t.length?i:void 0],["members",i.length!==t.length?t:void 0]]}};function Hn(e){return[["id",e.id],["type",e.type],["format",e.format],["profile",e.profile],["height",e.height],["width",e.width],["duration",e.duration||void 0],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0],["behavior",e.behavior&&e.behavior.length?e.behavior:void 0],["timeMode",e.timeMode],["motivation",e.motivation]]}function ui(e){if(!(!e||e.length===0))return e}function Fm(e){if(e&&e.type&&e.type==="ImageService2"){let t=e,{id:i,type:r,profile:n}=t,o=oe(t,["id","type","profile"]);return A({"@id":i,"@type":r,profile:n.startsWith("http")?n:`http://iiif.io/api/image/2/${n}.json`},o)}return e}function Mm(e){if(!(!e||e.length===0))return e.map(Fm)}function*qn(e){return[["label",e.label],["metadata",ui(e.metadata)],["summary",e.summary],["requiredStatement",e.requiredStatement],["rights",e.rights],["navDate",e.navDate],["language",e.language],["thumbnail",ui(yield e.thumbnail)],["placeholderCanvas",yield e.placeholderCanvas],["accompanyingCanvas",yield e.accompanyingCanvas],["provider",ui(yield e.provider)]]}function*Qn(e){return[["seeAlso",ui(yield e.seeAlso)],["service",Mm(e.service)],["services",Mm(e.services)],["rendering",ui(yield e.rendering)],["supplementary",ui(yield e.supplementary)],["homepage",ui(yield e.homepage)],["logo",ui(yield e.logo)],["partOf",ui(yield e.partOf)],["start",e.start]]}var zm={Manifest:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Hn(e),...yield*qn(e),...yield*Qn(e),["items",yield e.items],["structures",ui(yield e.structures)],["annotations",ui(yield e.annotations)]]:[...Hn(e),...yield*qn(e)]},Canvas:function*(e){return[...Hn(e),...yield*qn(e),...yield*Qn(e),["items",yield e.items],["annotations",ui(yield e.annotations)]]},Agent:function*(e){return[["id",e.id],["type","Agent"],["label",e.label],...yield*Qn(e)]},AnnotationPage:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?ui(i):i]).filter(([t,i])=>t!=="items"),...yield*Qn(e),["items",yield e.items]]},Service:function*(e){return[[Rm,Fm(e)]]},Annotation:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?ui(i):i]).filter(([t])=>t!=="body"),["body",yield e.body]]},ContentResource:function*(e){return[...Hn(e),...yield*qn(e),...yield*Qn(e),["annotations",ui(yield e.annotations)]]},AnnotationCollection:function*(e){return[["id",e.id],["type","AnnotationCollection"],["label",e.label]]},Collection:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Hn(e),...yield*qn(e),...yield*Qn(e),["items",ui(yield e.items)]]:[...Hn(e),...yield*qn(e)]},Range:function*(e){let t=[];for(let i of e.items)i.type==="Range"?t.push(yield i):t.push(i);return[...Hn(e),...yield*qn(e),...yield*Qn(e),["items",t],["annotations",ui(yield e.annotations)]]}},ci=De(rc(),1);function Sk(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Nm(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function jm(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Nm(Object(i),!0).forEach(function(r){Sk(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Nm(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function bi(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Bm=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})(),qc=function(){return Math.random().toString(36).substring(7).split("").join(".")},ul={INIT:"@@redux/INIT"+qc(),REPLACE:"@@redux/REPLACE"+qc(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+qc()}};function Ek(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Qc(e,t,i){var r;if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(bi(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(bi(1));return i(Qc)(e,t)}if(typeof e!="function")throw new Error(bi(2));var n=e,o=t,l=[],u=l,h=!1;function g(){u===l&&(u=l.slice())}function f(){if(h)throw new Error(bi(3));return o}function y(T){if(typeof T!="function")throw new Error(bi(4));if(h)throw new Error(bi(5));var R=!0;return g(),u.push(T),function(){if(R){if(h)throw new Error(bi(6));R=!1,g();var O=u.indexOf(T);u.splice(O,1),l=null}}}function S(T){if(!Ek(T))throw new Error(bi(7));if(typeof T.type>"u")throw new Error(bi(8));if(h)throw new Error(bi(9));try{h=!0,o=n(o,T)}finally{h=!1}for(var R=l=u,O=0;O<R.length;O++){var E=R[O];E()}return T}function C(T){if(typeof T!="function")throw new Error(bi(10));n=T,S({type:ul.REPLACE})}function _(){var T,R=y;return T={subscribe:function(O){if(typeof O!="object"||O===null)throw new Error(bi(11));function E(){O.next&&O.next(f())}E();var F=R(E);return{unsubscribe:F}}},T[Bm]=function(){return this},T}return S({type:ul.INIT}),r={dispatch:S,subscribe:y,getState:f,replaceReducer:C},r[Bm]=_,r}function Ck(e){Object.keys(e).forEach(function(t){var i=e[t],r=i(void 0,{type:ul.INIT});if(typeof r>"u")throw new Error(bi(12));if(typeof i(void 0,{type:ul.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(bi(13))})}function cl(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++){var n=t[r];typeof e[n]=="function"&&(i[n]=e[n])}var o=Object.keys(i),l;try{Ck(i)}catch(u){l=u}return function(u,h){if(u===void 0&&(u={}),l)throw l;for(var g=!1,f={},y=0;y<o.length;y++){var S=o[y],C=i[S],_=u[S],T=C(_,h);if(typeof T>"u")throw h&&h.type,new Error(bi(14));f[S]=T,g=g||T!==_}return g=g||o.length!==Object.keys(u).length,g?f:u}}function Vn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.length===0?function(r){return r}:t.length===1?t[0]:t.reduce(function(r,n){return function(){return r(n.apply(void 0,arguments))}})}function hl(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return function(){var n=r.apply(void 0,arguments),o=function(){throw new Error(bi(15))},l={getState:n.getState,dispatch:function(){return o.apply(void 0,arguments)}},u=t.map(function(h){return h(l)});return o=Vn.apply(void 0,u)(n.dispatch),jm(jm({},n),{},{dispatch:o})}}}var Dm="@iiif/IMPORT_ENTITIES",Um="@iiif/MODIFY_ENTITY_FIELD",Wm="@iiif/REORDER_ENTITY_FIELD",Hm="@iiif/ADD_REFERENCE",qm="@iiif/REMOVE_REFERENCE",Qm=(0,ci.createAction)(Dm)(),kk=(0,ci.createAction)(Um)(),Ak=(0,ci.createAction)(Wm)(),Pk=(0,ci.createAction)(Hm)(),Tk=(0,ci.createAction)(qm)(),Ik={importEntities:Qm,modifyEntityField:kk,reorderEntityField:Ak,addReference:Pk,removeReference:Tk},Vm="@iiif/ADD_MAPPING",Gm="@iiif/ADD_MAPPINGS",Rk=(0,ci.createAction)(Vm)(),Lk=(0,ci.createAction)(Gm)(),Ym="@iiif/SET_META_VALUE",Xm="@iiif/SET_META_VALUE_DYNAMIC",Zm="@iiif/UNSET_META_VALUE",Ok=(0,ci.createAction)(Ym)(),$k=(0,ci.createAction)(Xm)(),Fk=(0,ci.createAction)(Zm)(),Km={setMetaValue:Ok,setMetaValueDynamic:$k,unsetMetaValue:Fk},Vc="RESOURCE_ERROR",Jm="RESOURCE_LOADING",Gc="RESOURCE_READY",ev="@iiif/REQUEST_RESOURCE",tv="@iiif/REQUEST_ERROR",iv="@iiif/REQUEST_MISMATCH",rv="@iiif/REQUEST_COMPLETE",nv="@iiif/REQUEST_OFFLINE_RESOURCE",Mk=(0,ci.createAction)(ev)(),sv=(0,ci.createAction)(tv)(),zk=(0,ci.createAction)(iv)(),Nk=(0,ci.createAction)(rv)();(0,ci.createAction)(nv)();var Yc="@iiif/BATCH",av="@iiif/BATCH_IMPORT",Xc=(0,ci.createAction)(Yc)();(0,ci.createAction)(av)();var jk=(e,t)=>{let{entities:i,resource:r,mapping:n}=Im(t);if(r.id===void 0)return[sv({id:e,message:"ID is not defined in resource."})];let o=[Qm({entities:i}),Lk({mapping:n})];return r.id!==e&&(o.push(Rk({id:e,type:r.type})),o.push(zk({requestId:e,actualId:r.id}))),o.push(Nk({id:e})),o},ov=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Bk(e,t){return!!(e===t||ov(e)&&ov(t))}function lv(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Bk(e[i],t[i]))return!1;return!0}function Zc(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function uv(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let o=e.getState(),l=o.iiif.requests[r];if(l)switch(l.loadingState){case Vc:break;case Jm:{let u,h=!1;try{let g=await Promise.race([new Promise((f,y)=>{h||(u=e.subscribe(()=>{let S=e.getState();if(S.iiif.requests[r].loadingState===Vc){y();return}if(S.iiif.requests[r].loadingState===Gc){let C=Zc(S,r);C?f(C):y()}}))}),new Promise((f,y)=>setTimeout(()=>{h=!0,y()},i*60))]);if(u&&u(),g)return g}catch{u&&u();break}break}case Gc:{let u=Zc(o,r);if(u)return u;break}}e.dispatch(Mk({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let h=jk(r,u);return e.dispatch(Xc({actions:h})),Zc(e.getState(),r)}catch(u){throw e.dispatch(sv({id:r,message:u.toString()})),u}}}function Dk(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var Uk=(e={},t)=>{switch(t.type){case Vm:return D(A({},e),{[t.payload.id]:t.payload.type});case Gm:return A(A({},e),t.payload.mapping);default:return e}};function Kc(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}var Wk=(e=Dk(),t)=>{var i;switch(t.type){case Um:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:t.payload.value})})})}case Wm:{if(!Kc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[o]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,o),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})})}case Dm:{let r=Object.keys(t.payload.entities),n=A({},e);for(let o of r)n[o]=A(A({},e[o]||{}),t.payload.entities[o]||{});return n}case Hm:{if(!Kc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})})}case qm:{if(!Kc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),o=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return o===-1||((i=n[o])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(o,1),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})}))}default:return e}},Hk=(e={},t)=>{switch(t.type){case ev:case nv:return D(A({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:Jm,uriMismatch:!1,resourceUri:t.payload.id}});case iv:return D(A({},e),{[t.payload.requestId]:D(A({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case tv:return D(A({},e),{[t.payload.id]:D(A({},e[t.payload.id]||{}),{loadingState:Vc,error:t.payload.message})});case rv:return D(A({},e),{[t.payload.id]:D(A({},e[t.payload.id]||{}),{loadingState:Gc,error:void 0})})}return e},qk=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:o,key:l}=t&&t.payload||{};switch(t.type){case Ym:return D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:n})})});case Xm:return D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:e[i]&&e[i][o]?r(e[i][o][l]):r(void 0)})})});case Zm:return e[i]&&e[i][o]&&e[i][o][l]?D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:void 0})})}):e;default:return e}};function Qk(e){return(t,i)=>i&&i.type===Yc?i.payload.actions.reduce(e,t):i&&i.type===av?i.payload.state:e(t,i)}var Vk=cl({mapping:Uk,entities:Wk,requests:Hk,meta:qk}),Gk=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Vn;function Yk(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:o={}}=e,l=cl(A({[i]:Vk},o));return Qc(Qk(l),r,t?Gk(hl(...n)):Vn(hl(...n)))}function Xk(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var Jc=class{constructor(e,t){Ve(this,"options"),Ve(this,"store"),Ve(this,"emitter"),Ve(this,"isBatching",!1),Ve(this,"batchQueue",[]),Ve(this,"remoteFetcher"),Ve(this,"staticFetcher"),Ve(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Ve(this,"middleware",i=>r=>n=>{if(n.type===Yc){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let o=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:o}),o}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||Yk({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=Xk(),this.remoteFetcher=uv(this.store,this.options.customFetcher),this.staticFetcher=uv(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Xc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Xc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(Ik.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return Lm(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,$m)}toPresentation3(e){return this.serialize(e,zm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(h=>this.get(h,i));let n=this.getState();if(typeof e=="string"){let h=t||n.iiif.mapping[e];if(!h)return r?null:{id:e,type:"unknown"};e={id:e,type:h}}let o=t||e.type,l=e.id,u=n.iiif.entities[o];if(!u){let h=n.iiif.requests[l];return h&&h.resourceUri!==l?this.get(h.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return lv(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),o=e(n);lv(r,o)||t(o,this),r=o})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?Km.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):Km.setMetaValue({id:e,meta:t,key:i,value:r}))}};function Zk(){return typeof self<"u"?self:typeof window<"u"?window:typeof Su<"u"?Su:{}}function cv(e){let t=Zk();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new Jc(e);try{t.IIIF_VAULT=i}catch{}return i}var hi=De(rc(),1);De(Hf(),1);var Kk=Object.defineProperty,Jk=Object.defineProperties,eA=Object.getOwnPropertyDescriptors,hv=Object.getOwnPropertySymbols,tA=Object.prototype.hasOwnProperty,iA=Object.prototype.propertyIsEnumerable,dv=(e,t,i)=>t in e?Kk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,fv=(e,t)=>{for(var i in t||(t={}))tA.call(t,i)&&dv(e,i,t[i]);if(hv)for(var i of hv(t))iA.call(t,i)&&dv(e,i,t[i]);return e},pv=(e,t)=>Jk(e,eA(t)),rA=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,nA=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function eh(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=eh(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?eh({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=rA.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(nA);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function Ia(e,t={}){if(Array.isArray(e))return Ia(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?Ia({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return Ia(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?eh(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?Ia({type:"SpecificResource",source:pv(fv({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:pv(fv({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function Gn(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var sA="http://library.stanford.edu/iiif/image-api/compliance.html#level0",gv="http://library.stanford.edu/iiif/image-api/compliance.html#level1",mv="http://library.stanford.edu/iiif/image-api/compliance.html#level2",aA="http://library.stanford.edu/iiif/image-api/conformance.html#level0",vv="http://library.stanford.edu/iiif/image-api/conformance.html#level1",yv="http://library.stanford.edu/iiif/image-api/conformance.html#level2",oA="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",bv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",wv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",lA="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",xv="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",_v="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",uA="http://iiif.io/api/image/1/level0.json",cA="http://iiif.io/api/image/1/profiles/level0.json",Sv="http://iiif.io/api/image/1/level1.json",Ev="http://iiif.io/api/image/1/profiles/level1.json",Cv="http://iiif.io/api/image/1/level2.json",kv="http://iiif.io/api/image/1/profiles/level2.json",hA="http://iiif.io/api/image/2/level0.json",dA="http://iiif.io/api/image/2/profiles/level0.json",Av="http://iiif.io/api/image/2/level1.json",Pv="http://iiif.io/api/image/2/profiles/level1.json",Tv="http://iiif.io/api/image/2/level2.json",Iv="http://iiif.io/api/image/2/profiles/level2.json",fA="level0",Rv="level1",Lv="level2",pA="http://iiif.io/api/image/2/level0",Ov="http://iiif.io/api/image/2/level1",$v="http://iiif.io/api/image/2/level2",Fv=[$v,mv,yv,wv,_v,Cv,kv,Tv,Iv,Lv],Mv=[...Fv,Ov,gv,vv,bv,xv,Sv,Ev,Av,Pv,Rv],gA=[pA,Ov,$v,sA,gv,mv,aA,vv,yv,oA,bv,wv,lA,xv,_v,uA,cA,Sv,Ev,Cv,kv,hA,dA,Av,Pv,Tv,Iv,fA,Rv,Lv],mA={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},vA={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},yA={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function bA(e){return Fv.indexOf(e)!==-1?yA:Mv.indexOf(e)!==-1?vA:mA}function wA(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=bA(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function xA(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function _A(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""?(t.height=parseInt(i[1],10),t.version=2):t.version=3),t}function SA(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function EA(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],o=i[4];if(o[0]==="/"&&(o=o.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==o.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${o}, prefix: ${t})`);o=o.substr(t.length)}return{scheme:r,server:n,path:o,prefix:t}}function CA(e,t=""){let{path:i,scheme:r,server:n,prefix:o}=EA(e,t),l=i.split("/").reverse(),[u,h,g,f,...y]=l,S=y.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:o,identifier:S};if(u==="info.json"){let[,..._]=l;return{type:"info",scheme:r,server:n,prefix:o,identifier:_.reverse().filter(Boolean).join("/")}}let C=u.split(".");return{type:"image",scheme:r,server:n,prefix:o,identifier:S,originalPath:i,region:xA(f),size:_A(g),rotation:SA(h),quality:C[0],format:C[1]}}function kA(e){let t=CA(Gn(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=wA(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function AA(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o].width;n.push(e/l)}return n}function PA(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function Ft(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function dl(e){if(!e||!e.profile||!Ft(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&gA.indexOf(i)!==-1)return!0;return!1}function TA(e){if(!dl(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(Mv.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function fl(e,t){if(t&&t.profile){let i=t.profile;if(i){let r=Array.isArray(i)?i:[i];return r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function th(e){return dl(e)?fl(0,e)?0:fl(1,e)?1:fl(2,e)?2:null:null}function zv(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function IA(e){if(!TA(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let o=i[n];if(typeof o!="string"&&(o.maxHeight||o.maxWidth))return[{id:Ft(e),type:"variable",minWidth:0,minHeight:0,maxHeight:o.maxHeight||o.maxWidth,maxWidth:o.maxWidth||o.maxHeight,level:th(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let n=e.tiles.length;for(let o=0;o<n;o++){let l=e.tiles[o];(l.height||l.width)&&t.push({id:Ft(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width,level:th(e),version:zv(e)?3:2})}}return t}function Nv(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),o=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&o&&l)return{type:"fixed",id:e,height:o,width:n}}return{type:"unknown",id:e}}function RA(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function ih(e){if(typeof e=="string")return Nv(e);let t=RA(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=Ft(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Nv(r):null}function LA(e){return dl(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:Ft(e),type:"fixed-service",height:t.height,width:t.width,level:th(e),version:zv(e)?3:2})):[]}function jv(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=LA(e[r]);n.length&&t.push(...n);let o=IA(e[r]);o.length&&t.push(...o)}return t}function rh(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)dl(t[n])&&r.push(t[n]);return r}function OA(e,t=!0,i){let r=[],n=ih(e);if(n===null)return r;let o=e;if(r.push(n),t&&o&&o.width&&o.height){let l=[],u=rh(o);for(let h of u){let g={id:Ft(h),width:o.width,height:o.height};if(i.canLoadSync(g)){let f=i.loadServiceSync(g);f&&(f.height||(f.height=o.height),f.width||(f.width=o.width),l.push(...jv([f])))}}if(l.length)return r.push(...l),r}return o.service&&r.push(...jv(o.service)),r}function $A({x:e=0,y:t=0,w:i,h:r,full:n,square:o,percent:l}){return"full"}function FA({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o,serialiseAsFull:l,version:u}){let h=[];return i&&h.push("^"),e?(h.push(l?"full":"max"),h.join("")):(r&&h.push("!"),t&&h.push(`pct:${t}`),n&&h.push(`${n}`),h.push(","),o&&u===3&&h.push(`${o}`),h.join(""))}function MA(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function zA(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`,{size:n}=e,{region:o,rotation:l,format:u,quality:h}=e;return[r,$A(o),FA(n),MA(l),`${h}.${u}`].filter(Boolean).join("/")}function nh(e,t,i){let r=kA({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:Gn(Ft(e)),profile:e.level===null||typeof e.level>"u"?"level0":`level${e.level}}`,type:e.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=t,r.size.height=i,{id:zA(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function js(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function NA(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function jA(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=(f,y=0)=>r.explain?i.push(new Array(y).fill(0).map(S=>"    ").join("")+f().trim()):void 0,o=[],l=[],u=null;n(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let h=(f,y)=>{if(n(()=>"Swapping choice",3),NA(r,y,f)){if(r.preferFixedSize&&f.unsafe){n(()=>`We found an image that was marked as unsafe, but it was the best size. (${f.id})`,4),l.push(f);return}r.returnAllOptions&&y&&l.push(y),n(()=>`We found a new image that was the best size. (${f.id})`,4),u=f}else r.returnAllOptions&&l.push(f)};n(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let g=t.length;for(let f=0;f<g;f++){let y=t[f]();n(()=>`Candidate group ${f}: ${JSON.stringify(y,null,2)}`,1);let S=y.length;n(()=>`Checking candidate list number ${f} and found ${S} potential ways of creating image(s)`,1);for(let C=0;C<S;C++){let _=y[C];if(n(()=>`-> Checking candidate ${C}`,1),_.type==="unknown"&&r.atAnyCost&&(n(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),o.push(_)),_.type==="fixed"&&(_.unsafe?(n(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),o.push(_)):(n(()=>"We've found a fixed size image, checking if it matches the request",2),h(_,u))),_.type==="fixed-service")if(r.unsafeImageService){n(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let T=nh(_,r.width,r.height);h(T,u)}else{n(()=>"Checking for an image from the tile source 3",2);let T=nh(_,_.width,_.height);h(T,u)}if(_.type==="variable"&&_.maxWidth){let T=nh({id:_.id,width:_.maxWidth,height:_.maxWidth,level:_.level,version:_.version},_.maxWidth);h(T,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;n(()=>`We found a match in choice list number ${f}, no searching any more`);break}}return r.atAnyCost&&l.length===0?(n(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||o[0],fallback:o.slice(1),log:i}):r.returnAllOptions?(n(()=>"Returning all options that we have found"),{best:r.atAnyCost?u||l[0]||o[0]:u||l[0],fallback:[...l,...o],log:i}):(n(()=>"Returning the best image that we found, and a fallback"),{best:u||l[0]||null,fallback:u?l:l.slice(1),log:i})}var BA=Object.defineProperty,DA=Object.defineProperties,UA=Object.getOwnPropertyDescriptors,Bv=Object.getOwnPropertySymbols,WA=Object.prototype.hasOwnProperty,HA=Object.prototype.propertyIsEnumerable,Dv=(e,t,i)=>t in e?BA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,qA=(e,t)=>{for(var i in t||(t={}))WA.call(t,i)&&Dv(e,i,t[i]);if(Bv)for(var i of Bv(t))HA.call(t,i)&&Dv(e,i,t[i]);return e},QA=(e,t)=>DA(e,UA(t));function VA(e,t,i){let r=e>t?e:t,n=i.length,o=[];for(let l=0;l<n;l++){let u=i[l],h=u.scaleFactors[0],g=r/h,f=[h];for(;g>=u.width;)h=h*2,f.push(h),g=g/2;o.push(QA(qA({},u),{scaleFactors:f}))}return o}function GA(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let o=0;o<i;o++){let l=e[o],u=t[o];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++)if(e[o].width===t[l].width&&e[o].height===t[l].height){n++;break}return n===i}function Uv(e){return fl(0,e)}var Yn=(e,t,i)=>new Promise((r,n)=>{var o=h=>{try{u(i.next(h))}catch(g){n(g)}},l=h=>{try{u(i.throw(h))}catch(g){n(g)}},u=h=>h.done?r(h.value):Promise.resolve(h.value).then(o,l);u((i=i.apply(e,t)).next())}),sh=class{constructor(e={}){this.config={verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={},this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=js(Ft(e)),n=Gn(Ft(e)),o=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!o&&e.tiles&&!Uv(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Ft(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:AA(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=js(Ft(e)),o=this.knownImageServers[n],l=Gn(Ft(e));return this.imageServices[l]?this.imageServices[l]:!this.config.approximateServices||!o||!o.result||!(r!=null&&r.height||e.height)||!(r!=null&&r.width||e.width)||!i&&(o.malformed||o.verifications<this.config.verificationsRequired)||Uv(e.source)?null:(this.imageServices[l]||(this.imageServices[l]={"@context":o.result.context,"@id":Ft(e),id:Ft(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||VA(e.width,e.height,o.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||PA(Math.round(e.width/o.result.resourceServiceRatio),Math.round(e.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(r==null?void 0:r.profile)||o.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l])}getThumbnailFromResource(e,t){return Yn(this,arguments,function*(i,r,n=!0,o=[]){let l=i?yield this.getImageCandidates(i,n):[];return jA(r,[()=>o,()=>l])})}getImageCandidates(e,t=!0){return Yn(this,null,function*(){let i=e;if(t&&i&&i.height&&i.width){let r=rh(i);for(let n of r){let o={id:Ft(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(o)}}return OA(e,t,this)})}verify(e){return Yn(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(Ft(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&GA(t.sizes||[],i.sizes||[]);if(r){let n=js(Ft(e));this.knownImageServers[n]&&(this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0))}return r})}canLoadSync(e){let t=typeof e=="string"?e:Ft(e),i=Gn(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[js(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Yn(this,null,function*(){return this.knownImageServers[js(Ft(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return Yn(this,null,function*(){let i=Gn(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return Yn(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return Yn(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(o=>setTimeout(o,500));else{n=!1;break}}let i=this.knownImageServers[js(Ft(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(Ft(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=Gn(Ft(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}};new sh;var YA=Object.defineProperty,XA=Object.defineProperties,ZA=Object.getOwnPropertyDescriptors,Wv=Object.getOwnPropertySymbols,KA=Object.prototype.hasOwnProperty,JA=Object.prototype.propertyIsEnumerable,Hv=(e,t,i)=>t in e?YA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ei=(e,t)=>{for(var i in t||(t={}))KA.call(t,i)&&Hv(e,i,t[i]);if(Wv)for(var i of Wv(t))JA.call(t,i)&&Hv(e,i,t[i]);return e},wi=(e,t)=>XA(e,ZA(t)),eP={collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0},qv=J.createContext(eP),Xn=()=>Yt(qv);function pl({value:e,children:t}){let i=Xn(),r=Ae(()=>ei(ei({},i),e),[e,i]);return Jt(qv.Provider,{value:r,children:t})}var ah=J.createContext({vault:null,setVaultInstance:e=>{}});function pn({vault:e,vaultOptions:t,useGlobal:i,resources:r,children:n}){let[o,l]=ze(()=>e||(i?cv(t):t?new Jc(t):new Jc));return Jt(ah.Provider,{value:{vault:o,setVaultInstance:l},children:Jt(pl,{value:r||{},children:n})})}var Mt=()=>{let{vault:e}=Yt(ah);if(e===null)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return e};function tP(e,{noCache:t=!1}={}){let i=typeof e=="string"?e:e.id,r=Mt(),[n,o]=ze(i),[l,u]=ze(void 0),h=Ae(()=>r.get(i,{skipSelfReturn:!0})||void 0,[i,r]),[g,f]=ze(h);return fe(()=>{(async()=>{try{let y=h&&!t?h:await r.load(i),S=y?y.id||y["@id"]:null;y&&n!==S&&o(S),f(y)}catch(y){u(y)}})()},[i,t]),{isLoaded:!!g,id:n,requestId:i,error:l,resource:g,cached:!!(g&&g===h)}}function gl(e,t){let{id:i,isLoaded:r,error:n,resource:o,requestId:l,cached:u}=tP(e,t);return{id:i,isLoaded:r,error:n,manifest:o,requestId:l,cached:u}}function ml({manifest:e,children:t}){return Jt(pl,{value:{manifest:e},children:t})}function oh({canvas:e,children:t}){return Jt(pl,{value:{canvas:e},children:t})}function xi(e,t=[]){let i=Mt(),[r,n]=ze(()=>e(i.getState(),i));return fe(()=>i.subscribe(o=>e(o,i),o=>{n(o)},!1),t),r}var Qv=J.createContext([]);function Vv(){let e=Yt(Qv);return xi(t=>e.map(i=>t.iiif.entities.Canvas[i]).filter(Boolean),[e])}function gn(e={},t=[]){let{id:i,selector:r}=e,n=Xn();Mt();let o=i||n.manifest,l=xi(u=>o?u.iiif.entities.Manifest[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function lh({range:e,children:t}){return Jt(pl,{value:{range:e},children:t})}function Gv(e,t){let i=[];for(let r of t.items)if(r.type==="Canvas"&&(r.id.indexOf("#")!==-1?i.push({id:r.id.split("#")[0],type:"Canvas"}):i.push(r)),r.type==="Range"&&i.push(...Gv(e,e.get(r))),r.type==="SpecificResource"){let n=typeof r.source=="string"?r.source:r.source.id;i.push({id:n,type:"Canvas"})}return i}function iP(e,t,{disablePaging:i,skipNonPaged:r}={}){let n=t.behavior,o=n.includes("paged"),l=o?!1:n.includes("continuous"),u=o||l?!1:n.includes("individuals"),h=t.type==="Manifest"?t.items:Gv(e,t);if(l)return[h,[h.map((_,T)=>T)]];if(u||!o||i)return[h,h.map((_,T)=>[T])];let g=[],f=[],y=()=>{f.length&&(g.push([...f]),f=[])},S=0,C=!1;for(let _=0;_<h.length;_++){let T=e.get(h[_]);if(T.behavior.includes("non-paged")){_===S&&S++,r||(y(),g.push([_]),y());continue}if(_===S||T.behavior.includes("facing-pages")){f.length&&(C=!0),y(),g.push([_]),y();continue}if(f.push(_),C){y(),C=!1;continue}f.length>1&&y()}return f.length&&y(),[h,g]}function uh(e={},t=[]){let{id:i,selector:r}=e,n=Xn(),o=i||n.range,l=xi(u=>o?u.iiif.entities.Range[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function rP({startCanvas:e,disablePaging:t}){var i;let r=Mt(),n=gn(),o=uh(),[l,u]=ze(void 0),h=o||n;if(!h)throw new Error("Nothing selected");let[g,f]=Ae(()=>iP(r,h,{disablePaging:t}),[r,h]),y=Ue(T=>{let R=f.findIndex(O=>O.includes(T));u(R===-1?0:R)},[g,f]),S=Ue(T=>{let R=g.findIndex(O=>O.id===T);R!==-1?y(R):u(0)},[g,f]),C=Ue(()=>{u(T=>T>=f.length?T:T+1)},[f]),_=Ue(()=>{u(T=>T<=0?0:T-1)},[f]);return typeof l>"u"&&(e?S(e):u(0)),{visibleItems:((i=f[l])==null?void 0:i.map(T=>g[T].id))||[],cursor:l,items:g,sequence:f,setSequenceIndex:u,setCanvasIndex:y,setCanvasId:S,next:C,previous:_}}var Ra=()=>{},Yv=Kt({setCurrentCanvasId:Ra,setCurrentCanvasIndex:Ra,nextCanvas:Ra,previousCanvas:Ra,items:[],sequence:[],setSequenceIndex:Ra,currentSequenceIndex:0});function nP(e){let t=gn(),{cursor:i,visibleItems:r,next:n,sequence:o,items:l,setCanvasIndex:u,setCanvasId:h,previous:g,setSequenceIndex:f}=rP({startCanvas:e.startCanvas,disablePaging:e.pagingEnabled===!1}),y=Ae(()=>({sequence:o,items:l,setCurrentCanvasId:h,nextCanvas:n,previousCanvas:g,totalCanvases:l.length,setCurrentCanvasIndex:u,setSequenceIndex:f,currentSequenceIndex:i}),[o,l,h,n,g,l,u,f,i]);return t?Jt(Yv.Provider,{value:y,children:Jt(Qv.Provider,{value:r,children:Jt(oh,{canvas:r[0],children:e.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Jt("div",{children:"Sorry, something went wrong."}))}function sP(e){let t=gl(e.manifest);if(!t)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Jt("div",{children:"Sorry, something went wrong."});if(!t.isLoaded)return Jt("div",{children:"Loading..."});let i=Jt(nP,wi(ei({},e),{children:e.children}));return Jt(ml,{manifest:t.id,children:e.rangeId?Jt(lh,{range:e.rangeId,children:i}):i})}function aP(){return Yt(Yv)}var oP="@iiif/IMPORT_ENTITIES",lP="@iiif/MODIFY_ENTITY_FIELD",uP="@iiif/REORDER_ENTITY_FIELD",cP="@iiif/ADD_REFERENCE",hP="@iiif/REMOVE_REFERENCE",dP=(0,hi.createAction)(oP)(),fP=(0,hi.createAction)(lP)(),pP=(0,hi.createAction)(uP)(),gP=(0,hi.createAction)(cP)(),mP=(0,hi.createAction)(hP)(),ch={importEntities:dP,modifyEntityField:fP,reorderEntityField:pP,addReference:gP,removeReference:mP},vP="@iiif/ADD_MAPPING",yP="@iiif/ADD_MAPPINGS";(0,hi.createAction)(vP)(),(0,hi.createAction)(yP)();var bP="@iiif/SET_META_VALUE",wP="@iiif/SET_META_VALUE_DYNAMIC",xP="@iiif/UNSET_META_VALUE";(0,hi.createAction)(bP)(),(0,hi.createAction)(wP)(),(0,hi.createAction)(xP)();var _P="@iiif/REQUEST_RESOURCE",SP="@iiif/REQUEST_ERROR",EP="@iiif/REQUEST_MISMATCH",CP="@iiif/REQUEST_COMPLETE",kP="@iiif/REQUEST_OFFLINE_RESOURCE";(0,hi.createAction)(_P)(),(0,hi.createAction)(SP)(),(0,hi.createAction)(EP)(),(0,hi.createAction)(CP)(),(0,hi.createAction)(kP)();var AP="@iiif/BATCH",PP="@iiif/BATCH_IMPORT";(0,hi.createAction)(AP)(),(0,hi.createAction)(PP)();function TP(){let e=Mt().getStore();return Ae(()=>t=>e.dispatch(t),[e])}function Xv(e){return typeof e!="string"&&e&&e.bindToVault}function IP(){let e=Mt(),t=ke([]),i=TP(),r=Ae(()=>`vault://annotation-page/${new Date().getTime()}/${Math.round(Math.random()*1e9).toString(16)}`,[]);Tt(()=>{let u={id:r,type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]};i(ch.importEntities({entities:{AnnotationPage:{[u.id]:u}}}))},[r]);let n=xi(u=>r?u.iiif.entities.AnnotationPage[r]:null,[r]),o=Ue((u,h)=>{if(r){if(Xv(u)){let y=u;y.__vault||y.bindToVault(e),u=typeof y.source=="string"?y.source:y.source.id,t.current[u]=y}else typeof u!="string"&&(u=u.id);let g=e.get({id:r,type:"AnnotationPage"}),f=e.get({id:u,type:"Annotation"});g&&f&&(g.items.find(y=>y.id===f.id)||i(ch.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"},index:h})))}},[r]),l=Ue(u=>{r&&(Xv(u)?u=typeof u.source=="string"?u.source:u.source.id:typeof u!="string"&&(u=u.id),t.current[u]&&t.current[u].beforeRemove(),e.get({id:r,type:"AnnotationPage"})&&i(ch.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"}})))},[r]);return[n,{addAnnotation:o,removeAnnotation:l}]}Kt(null),Kt(null),J.createContext(null),J.createContext(null);function RP(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],o=>{let l=o||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(o=>o.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),o={};if(n&&r)for(let l of Object.keys(n))o[l]=u=>{let h=e.get(r);for(let{callback:g,scope:f}of n[l]||[])(!f||i&&f.indexOf(i)!==-1)&&g(u,h)};return o}}}function vl(e,t){let i=Mt(),r=Ae(()=>RP(i),[i]),n=xi(()=>e&&e.id?i.getResourceMeta(e.id,"eventManager"):null,[e]);return Ae(()=>e?r.getListenersAsProps(e,t):{},[n,e,i,t])}function Zv(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function Zn(e,t){let i=Mt(),r=Ae(()=>Zv(i),[i]);return xi(()=>{if(!e)return null;let n=r.getAppliedStyles(e.id);return n?t?n[t]:n:void 0},[e,t])}var LP=Object.defineProperty,OP=Object.defineProperties,$P=Object.getOwnPropertyDescriptors,Kv=Object.getOwnPropertySymbols,FP=Object.prototype.hasOwnProperty,MP=Object.prototype.propertyIsEnumerable,Jv=(e,t,i)=>t in e?LP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ey=(e,t)=>{for(var i in t||(t={}))FP.call(t,i)&&Jv(e,i,t[i]);if(Kv)for(var i of Kv(t))MP.call(t,i)&&Jv(e,i,t[i]);return e},ty=(e,t)=>OP(e,$P(t)),zP=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,NP=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function yl(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=yl(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?yl({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=zP.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(NP);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function qr(e,t={}){if(Array.isArray(e))return qr(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?qr({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return qr(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?yl(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?qr({type:"SpecificResource",source:ty(ey({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:ty(ey({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function hh(e={},t=[]){let{id:i,selector:r}=e,n=Xn(),o=Mt(),l=i||n.annotation,u=xi(g=>l?g.iiif.entities.Annotation[l]:void 0,[l]),h=xi(g=>u&&u.body?u.body.map(f=>f?g.iiif.entities[f.type][f.id]:null).filter(Boolean):[],[u]);return Ae(()=>{if(!u)return;let g=wi(ei({},u),{body:h,target:qr(u.target,{typeMap:o.getState().iiif.mapping})});return r?r(g):g},[u,r,h,...t])}function mn(e={},t=[]){let{id:i,selector:r}=e,n=Xn(),o=i||n.canvas,l=xi(u=>o?u.iiif.entities.Canvas[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function iy(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function jP(e,t,i){let r=[],n=null,o=[];for(let l of t){let u=e.get(l.body,{skipSelfReturn:!1});for(let h of u){if(!h)continue;let[g,{selector:f}]=iy(h),y=(g.type||"unknown").toLowerCase();if(y==="choice"){let S=e.get(g.items),C=i.length?i.map(_=>S.find(T=>T.id===_)).filter(Boolean):[S[0]];C.length===0&&C.push(S[0]),n={type:"single-choice",items:S.map(_=>({id:_.id,label:_.label,selected:C.indexOf(_)!==-1})),label:h.label},u.push(...C);continue}r.indexOf(y)===-1&&r.push(y),o.push({annotationId:l.id,type:y,resource:g,target:l.target,selector:f})}}return{types:r,items:o,choice:n}}function ry(e,t){let{selector:i,source:r}=Ia(t);if(r.id!==e.id)return[null,r];let n={spatial:{x:0,y:0,width:e.width,height:e.height}};return[i?i.type==="TemporalSelector"?{type:"TemporalBoxSelector",temporal:i.temporal,spatial:n.spatial}:i:null,r]}var BP={makeChoice:()=>{}},dh={type:"unknown"},ti=e=>({type:"unknown",reason:e,annotations:{pages:[]}}),DP=(e,t)=>({type:"empty",width:e,height:t,annotations:{pages:[]},image:null,images:[]});function UP(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function WP(e,t){return xi(i=>{let r=[];if(!e)return r;let n=Object.keys(i.iiif.entities.AnnotationPage);for(let o of n)if(!t||t.indexOf(o)!==-1){let l=UP(i,o);l&&l.views&&l.views[e]&&r.push(o)}return r},[e,t])}function HP({canvas:e,manifest:t,all:i,canvases:r}){let n=[];if(t)for(let o of t.annotations)n.indexOf(o.id)===-1&&n.push(o.id);if(i){if(r&&r.length)for(let o of r)for(let l of o.annotations)n.indexOf(l.id)===-1&&n.push(l.id)}else if(e)for(let o of e.annotations)n.indexOf(o.id)===-1&&n.push(o.id);return n}function qP(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function fh(e,t={}){let i=Mt(),r=gn(),n=mn(),o=Vv(),l=Ae(()=>HP({all:t.all,manifest:r,canvas:n,canvases:o}),[t.all,n,o,r]),u=WP(e,t.all?void 0:l),h=Ue(f=>{!e||i.setMetaValue([f,"annotationPageManager","views"],y=>y&&!y[e]?y:wi(ei({},y||{}),{[e]:!1}))},[e,i]),g=Ue((f,y={})=>{if(!e)return;let S=i.getState(),C=[];if(y!=null&&y.deselectOthers){let _=Object.keys(S.iiif.entities.AnnotationPage);for(let T of _){let R=qP(S,T);R&&R.views&&R.views[e]&&C.push(T)}}for(let _ of C)h(_);i.setMetaValue([f,"annotationPageManager","views"],_=>_&&_[e]?_:wi(ei({},_||{}),{[e]:!0}))},[e,h,i]);return{availablePageIds:l,enabledPageIds:u,setPageEnabled:g,setPageDisabled:h}}function QP(e,t){return xi((i,r)=>r.get(e.map(n=>({id:n,type:t}))),[e,t])}var ny=J.createContext(new sh);function ph(){return Yt(ny)}function sy(){let e=ph(),[t,i]=ze({}),r=ke(!1);return fe(()=>()=>{r.current=!0},[]),[Ue((n,{height:o,width:l})=>{if(n){let u=n.id||n["@id"],h=e.loadServiceSync({id:u,width:n.width||l,height:n.height||o,source:n});h?n=h:t[u]||(r.current||i(g=>wi(ei({},g),{[u]:"loading"})),e.loadService({id:u,width:n.width||l,height:n.height||o}).then(()=>{r.current||i(g=>wi(ei({},g),{[u]:"done"}))}))}return n},[e,t]),t]}function VP(e={}){let t=hh(),i=mn(e.canvasId?{id:e.canvasId}:void 0);return xi((r,n)=>{if(!i)return[];if(t&&e.enableSingleAnnotation)return[t];let o=n.get(i.items),l=[];for(let u of o)l.push(...n.get(u.items));return l},[i])}function GP(e,t=[]){let i=Mt(),r=VP({enableSingleAnnotation:e==null?void 0:e.enableSingleAnnotation}),[n,o]=ze((e==null?void 0:e.defaultChoices)||[]),l=Ae(()=>jP(i,r,n),[i,r,n,...t]),u={makeChoice:Ue((h,{deselectOthers:g=!0,deselect:f=!1}={})=>{if(l.choice){if(l.choice.type!=="single-choice")throw new Error("Complex choice not supported yet");o(y=>{if(f){let C=y.filter(_=>_!==h);if(C.length===0){let _=l.items[0].resource.id;return _?[_]:[]}return C}if(g)return[h];let S=[...y];if(S.length===0&&l.items.length){let C=l.items[0].resource.id;C&&S.push(C)}return y.indexOf(h)!==-1?y:[...y,h]})}},[l.choice])};return[l,u]}function YP(e,t,i){let r=[];for(let n of t.items){let o=n.resource&&n.resource.type==="SpecificResource"?n.resource.source:n.resource;if(!o.id)return ti("No resource Identifier");let l;if(o.service){let _=rh(o);_[0]&&(l=i(_[0],e))}let u={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},[h,g]=ry(e,n.target);if(g.id!==e.id)continue;let f={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},y=n.resource.type==="SpecificResource"?qr(n.resource):null,S=y&&y.selector&&(y.selector.type==="BoxSelector"||y.selector.type==="TemporalBoxSelector")?{type:"BoxSelector",spatial:{x:y.selector.spatial.x,y:y.selector.spatial.y,width:y.selector.spatial.width,height:y.selector.spatial.height}}:f;l&&!l.id&&(l.id=l["@id"]);let C={id:o.id,type:"Image",annotationId:n.annotationId,width:h?o.width:e.width,height:h?o.height:e.height,service:l,sizes:l&&l.sizes?l.sizes:o.width&&o.height?[{width:o.width,height:o.height}]:[],target:h&&h.type!=="PointSelector"?h:u,selector:S};r.push(C)}return{type:"images",image:r[0],images:r,choice:t.choice}}var XP=["model/gltf-binary"];function ZP(e,t){let i=t.items[0].resource;return i.format?XP.indexOf(i.format)===-1?ti(`3D format: ${i.format} is unsupported`):{type:"3d-model",model:i}:ti("Unknown format")}function KP(e,t){var i;if(!e.duration)return ti("No duration on canvas");if(t.items.length>1)return ti("Only one audio source supported");let r=(i=t.items[0])==null?void 0:i.resource;return r?r.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:r.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:r.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:ti("Audio does not have format"):ti("Unknown audio")}function JP(e,t){var i;let r=t.items.filter(o=>o.type==="video");if(!e.duration)return ti("No duration on canvas");if(r.length>1)return ti("Only one video source supported");let n=(i=r[0])==null?void 0:i.resource;return n?n.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:n.id,type:"Video",items:[],target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:n.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:ti("Video does not have format"):ti("Unknown video")}function ay(e,t={},i){let r=e.language||i||"none";switch(e.type){case"TextualBody":{typeof e.value<"u"&&(t[r]=e.value);break}case"List":case"Composite":case"Choice":e.items&&e.items.forEach(n=>ay(n,t,r))}return t}function eT(e,t){let i=[];return t.items.forEach(r=>{if(r.resource){let[n]=ry(e,r.target);i.push({annotationId:r.annotationId,text:ay(r.resource),target:n})}}),{type:"textual-content",items:i}}function tT(e){let t=gn(),i=mn(),r=Mt(),[n,o]=sy(),{enabledPageIds:l}=fh((e==null?void 0:e.annotationPageManagerId)||(t==null?void 0:t.id)||(i==null?void 0:i.id),{all:!1}),u=QP(l,"AnnotationPage"),h=(e==null?void 0:e.strategies)||["empty","images","media","textual-content","complex-timeline"],[g,f]=GP(e,[o]),y=Ae(()=>{if(!i)return dh;if(g.types.length===0)return h.indexOf("empty")!==-1?DP(i.width,i.height):dh;if(g.types.length!==1)if(g.types.length===2&&g.types.indexOf("text")!==-1)g.types=g.types.filter(C=>C!=="text");else return h.indexOf("complex-timeline")===-1?ti("Complex timeline not supported"):ti("ComplexTimelineStrategy not yet supported");let S=g.types[0];return S==="image"?h.indexOf("images")===-1?ti("Image not supported"):YP(i,g,n):S==="Model"||S==="model"?h.indexOf("3d-model")===-1?ti("3D not supported"):ZP(i,g):S==="textualbody"?h.indexOf("textual-content")===-1?ti("Textual content not supported"):eT(i,g):S==="sound"||S==="audio"?h.indexOf("media")===-1?ti("Media not supported"):KP(i,g):S==="video"?h.indexOf("media")===-1?ti("Media not supported"):JP(i,g):dh},[i,g,r,f.makeChoice]);return Ae(()=>y.type==="unknown"?[y,BP]:[wi(ei({},y),{annotations:{pages:u}}),f],[y,u])}var iT=(e,t=[])=>{let i=Mt();fe(()=>{e(i)},[i,...t])};function rT(e,t={}){let i=t.imageServiceLoader||new sh;async function r(n,o,l,u=[],h){if(typeof n=="string")return{best:ih(n),fallback:[],log:[]};let g=e.get(n);if(typeof g=="string")return{best:ih(g),fallback:[],log:[]};switch(g.type){case"Annotation":{let f=g.body,y=e.get(f[0]);return h&&!y.width&&(y.width=h.width,y.height=h.height),await i.getThumbnailFromResource(y,o,l,u)}case"Canvas":{let f=g;if(f.thumbnail&&f.thumbnail.length){let y=e.get(f.thumbnail[0]),S=await i.getImageCandidates(y,l);S&&S.length&&u.push(...S)}return r(f.items[0],o,l,u,{width:f.width,height:f.height})}case"AnnotationPage":return r(g.items[0],o,l,u,h);case"Choice":return r(g.items[0],o,l,u,h);case"Collection":{let f=g.items[0];return r(f,o,l,u,h)}case"Manifest":{let f=g.items[0];return r(f,o,l,u,h)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return h&&!g.width&&(g.width=h.width,g.height=h.height),i.getThumbnailFromResource(g,o,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function nT(e,t,{canvasId:i,manifestId:r}={}){let n=Mt(),o=ph(),l=Ae(()=>rT(n,{imageServiceLoader:o}),[n,o]),[u,h]=ze(),g=gn(r?{id:r}:void 0),f=mn(i?{id:i}:void 0),y=f||g,S=ke(!1);if(fe(()=>(S.current=!1,()=>{S.current=!0}),[]),!y)throw new Error("Must be called under a manifest or canvas context.");return iT(C=>{l.getBestThumbnailAtSize(y,e,t).then(_=>{_.best&&!S.current&&h(_.best)})},[y]),u}function sT(e){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:e}}function aT(e,t){switch(t.type){case"FINISHED":return wi(ei({},e),{isFinished:!0,isPlaying:!1,playRequested:!1});case"PLAY_PAUSE":return wi(ei({},e),{isFinished:!1,isPlaying:!e.isPlaying});case"PLAY_REQUESTED":return wi(ei({},e),{isFinished:!1,playRequested:!0});case"PAUSE":return wi(ei({},e),{isPlaying:!1});case"PLAY":return wi(ei({},e),{isFinished:!1,playRequested:!1,isPlaying:!0});case"MUTE":return wi(ei({},e),{isMuted:!0});case"SET_VOLUME":return wi(ei({},e),{volume:t.volume,isMuted:t.volume===0});case"TOGGLE_MUTE":return wi(ei({},e),{isMuted:!e.isMuted});case"UNMUTE":return wi(ei({},e),{isMuted:!1})}return e}function oT(e){let t=Math.round(e);return`${Math.floor(t/60)}:${`${t%60}`.padStart(2,"0")}`}function oy(e){let[t,i]=ws(aT,sT(e.duration)),r=ke(null),n=ke(null),o=ke(null),l=ke(!1),u=Ue(()=>{n.current&&r.current&&(n.current.innerHTML=oT(r.current.currentTime),o.current&&(o.current.style.width=`${r.current.currentTime/e.duration*100}%`),l.current!==r.current.muted&&(l.current=r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))},[e.duration]),h=Ue(()=>{r.current&&(i({type:"PLAY_REQUESTED"}),r.current.play().then(()=>{i({type:"PLAY"})}),u())},[u]),g=Ue(()=>{r.current&&(r.current.duration>0&&r.current.paused?h():f())},[u]),f=Ue(()=>{r.current&&(r.current.pause(),i({type:"PAUSE"}),u())},[u]),y=Ue(()=>{r.current&&(r.current.muted=!r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))},[]),S=Ue(()=>{r.current&&(r.current.muted=!0,i({type:"MUTE"}))},[]),C=Ue(()=>{r.current&&(r.current.muted=!1,i({type:"UNMUTE"}))},[]),_=Ue(O=>{r.current&&(r.current.muted=!1,r.current.volume=O/100,i({type:"SET_VOLUME",volume:O}))},[]),T=Ue(O=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(O*e.duration,e.duration)),u())},[]),R=Ue(O=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(O,e.duration)),u())},[]);return fe(()=>{let O=setInterval(()=>{u()},350);return()=>clearInterval(O)},[u,e.duration]),fe(()=>{let O=()=>{i({type:"FINISHED"})},E=r.current;return E==null||E.addEventListener("ended",O),()=>E==null?void 0:E.removeEventListener("ended",O)},[]),[{element:r,currentTime:n,progress:o},t,{play:h,pause:f,playPause:g,mute:S,unmute:C,toggleMute:y,setVolume:_,setDurationPercent:T,setTime:R}]}var lT=Kt(null),uT=Kt(null),cT=Kt(null);function hT({actions:e,state:t,children:i,currentTime:r,progress:n,element:o}){return Jt(cT.Provider,{value:{currentTime:r,progress:n,element:o},children:Jt(uT.Provider,{value:e,children:Jt(lT.Provider,{value:t,children:i})})})}function dT(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fT(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pT(e,t,i){return t&&fT(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}J.createContext(),(function(){function e(){dT(this,e),this.usedNamespaces={}}return pT(e,[{key:"addUsedNamespaces",value:function(t){var i=this;t.forEach(function(r){i.usedNamespaces[r]||(i.usedNamespaces[r]=!0)})}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}]),e})();function gT(e={},t=[]){let{id:i,selector:r}=e,n=Xn(),o=i||n.annotationPage,l=xi(u=>o?u.iiif.entities.AnnotationPage[o]:void 0,[o]);return Ae(()=>{if(l)return r?r(l):l},[l,...t])}function bl(){let e=Yt(ah);return e&&e.vault?e.vault:cv()}function mT(){let e=Mt();return Ae(()=>Zv(e),[e])}Qe();async function vT(e){if(!e)return null;switch(e){case"static":return{render:"static",interactive:!1,viewport:!0};case"responsive":return{render:"static",interactive:!1,viewport:!1};case"zoom":return{render:"canvas",interactive:!0,viewport:!0}}if(e.startsWith("http"))return fetch(e).then(t=>t.json());if(e.startsWith("#")){let t=document.getElementById(e.slice(1));if(t)try{return JSON.parse(t.innerText)}catch{console.error("Invalid JSON on element",t)}}return null}function yT(e,t){let[i,r]=ze(!1),[n,o]=ze({}),l=e&&!n.__loaded,u=!!((!e||n.__loaded)&&i);return Tt(()=>{let h=[];return e&&vT(e).then(g=>{if(g){let f=g,{media:y}=f,S=oe(f,["media"]),C=Object.keys(y||{}),_=C.map(R=>({query:R,mql:window.matchMedia(R)})),T=()=>{if(!_.length||!y)return A({__loaded:!0},S);let R=_.filter(({mql:E})=>E.matches),O=A(A({__loaded:!0},S),R.reduce((E,F)=>Object.assign(E,y[F.query]),{}));if(t)for(let E of R)t(E.query,O);return O};for(let R of C){let O=window.matchMedia(R),E=()=>{let F=T();o(F)};O.addEventListener("change",E),h.push(()=>{O.removeEventListener("change",E)})}o(T())}else o({__loaded:!0})}).catch(()=>{o({__loaded:!0})}),()=>{h.forEach(g=>g())}},[u,e]),{internalConfig:n,isReady:u,isConfigBlocking:l,setIsReady:r}}Qe(),Qe();function Be(e,{parse:t,defaultValue:i}={}){let r=ke(),[n,o]=ze(()=>t?t(e):e),l=Ue(u=>{let h=t?t(u):u;typeof i<"u"&&typeof h>"u"&&(h=i),(r.current||n)!==h&&(o(h),r.current=h)},[]);return Tt(()=>{l(e)},[e]),[n,l,o,r]}function bT({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o}){let l=[];return i&&l.push("^"),e?(l.push("max"),l.join("")):(r&&l.push("!"),t&&l.push(`pct:${t}`),n&&l.push(`${n}`),l.push(","),o&&l.push(`${o}`),l.join(""))}function wT(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),(e==="max"||e==="full")&&(t.max=!0),e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10)),t}function wl(e){return e==null||e<0?0:e}function xl(e){return xT(typeof e=="string"?e:JSON.stringify(e))}function _l(e,t){if(e=e.trim(),e[0]==="{")return JSON.parse(e);if(e.startsWith("http"))throw new Error("Cannot fetch remote fetch with async=false in parseContentState");return _l(_T(e))}function xT(e){let t=encodeURIComponent(e);return(typeof btoa>"u"?Buffer.from(t,"utf-8").toString("base64"):btoa(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function _T(e){let t=ST(e).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(i).trim()}function ST(e){let t=e.length%4;if(t===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return e+(t?"====".slice(0,4-t):"")}function Bs(e){if(!e)throw new Error("Content state is empty");Array.isArray(e)||(e=[e]);let t="vault://virtual-annotation/"+new Date().getTime(),i=["contentState"],r=[];for(let n of e){if(typeof n=="string")throw new Error("Content state is a [String] type and cannot be inferred");if(n.type==="Annotation"){if(t=n.id,Array.isArray(n.motivation))for(let l of n.motivation)i.indexOf(l)===-1&&i.push(l);if(Array.isArray(n.target))for(let l of n.target){let u=qr(l);r.push(u)}else{let l=qr(n.target);r.push(l)}continue}let o=qr(n);r.push(o)}return{id:t,type:"Annotation",motivation:["contentState",...e.motivation||[]],target:r,extensions:{}}}function ET(e){if(!e)return[];typeof e=="string"&&(e=e.split("|")),Array.isArray(e)||(e=[e]);let t=[];for(let i of e)typeof i=="string"&&(i=wT(i)),t.push(i);return t}function gh(e){if(typeof e=="string"){let t=e.match(/^(pct|pixel|percent)?:?([0-9,\s]+)/);if(t)return gh({type:"FragmentSelector",value:`xywh=${t[1]?t[1]==="pixel"?"pixel:":"percent:":""}${t[2]}`})}return e?yl(e):void 0}function ly(e){return e?Array.isArray(e)?e:e.indexOf(",")!==-1?e.split(",").map(t=>t.trim()):[e]:[]}function CT(e){let t=ly(e),i=[];for(let r of t){let[n,o]=r.split("#");if(o){let l=o.match(/opacity=([01]?\.[0-9]+)/);if(l){let u=parseFloat(l[1]);if(u<1&&u>=0){i.push({id:n,opacity:u});continue}}}i.push({id:n})}return i}function ot(e,t){return typeof e>"u"?t:typeof e=="string"?e.toLowerCase()==="true":t?typeof e>"u"?t:!1:e}function kr(e,t){return typeof e>"u"||e===null||e===""?t:(typeof e=="string"&&(e=parseInt(""+e,10)),typeof e<"u"&&!Number.isNaN(e)?e:t)}function Sl(e){if(!e)return null;if(typeof e=="string"&&e.startsWith("http"))return{type:"remote-content-state",id:e};try{return Bs(typeof e=="string"?_l(e):e)}catch{return null}}var kT=class{constructor(e,t){this._className="",this.onChange=e||(()=>{}),this.className=Array.isArray(t)?t.join(" "):t||""}set className(e){this._className=e}get className(){return this._className}add(e){this.className.split(" ").includes(e.trim())||(this.className+=" "+e.trim())}remove(e){this.className=this.className.split(" ").filter(t=>t&&t!==e).join(" ")}toggle(e,t){let i=this.className.split(" ");t&&!i.includes(e)&&(this.className+=" "+e.trim())}contains(e){return this.className.split(" ").includes(e.trim())}getClassName(){return this.className}};function mh(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],o=>{let l=o||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(o=>o.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),o={};if(n&&r)for(let l of Object.keys(n))o[l]=u=>{let h=e.get(r);for(let{callback:g,scope:f}of n[l]||[])(!f||i&&f.indexOf(i)!==-1)&&g(u,h)};return o}}}function vh(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function Kn(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var AT="http://library.stanford.edu/iiif/image-api/compliance.html#level0",uy="http://library.stanford.edu/iiif/image-api/compliance.html#level1",cy="http://library.stanford.edu/iiif/image-api/compliance.html#level2",PT="http://library.stanford.edu/iiif/image-api/conformance.html#level0",hy="http://library.stanford.edu/iiif/image-api/conformance.html#level1",dy="http://library.stanford.edu/iiif/image-api/conformance.html#level2",TT="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",fy="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",py="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",IT="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",gy="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",my="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",RT="http://iiif.io/api/image/1/level0.json",LT="http://iiif.io/api/image/1/profiles/level0.json",vy="http://iiif.io/api/image/1/level1.json",yy="http://iiif.io/api/image/1/profiles/level1.json",by="http://iiif.io/api/image/1/level2.json",wy="http://iiif.io/api/image/1/profiles/level2.json",OT="http://iiif.io/api/image/2/level0.json",$T="http://iiif.io/api/image/2/profiles/level0.json",xy="http://iiif.io/api/image/2/level1.json",_y="http://iiif.io/api/image/2/profiles/level1.json",Sy="http://iiif.io/api/image/2/level2.json",Ey="http://iiif.io/api/image/2/profiles/level2.json",FT="level0",Cy="level1",ky="level2",MT="http://iiif.io/api/image/2/level0",Ay="http://iiif.io/api/image/2/level1",Py="http://iiif.io/api/image/2/level2",Ty=[Py,cy,dy,py,my,by,wy,Sy,Ey,ky],Iy=[...Ty,Ay,uy,hy,fy,gy,vy,yy,xy,_y,Cy],zT=[MT,Ay,Py,AT,uy,cy,PT,hy,dy,TT,fy,py,IT,gy,my,RT,LT,vy,yy,by,wy,OT,$T,xy,_y,Sy,Ey,FT,Cy,ky],NT={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},jT={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},BT={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function DT(e){return Ty.indexOf(e)!==-1?BT:Iy.indexOf(e)!==-1?jT:NT}function UT(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=DT(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function WT(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function HT(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10))),t}function qT(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function QT(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],o=i[4];if(o[0]==="/"&&(o=o.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==o.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${o}, prefix: ${t})`);o=o.substr(t.length)}return{scheme:r,server:n,path:o,prefix:t}}function VT(e,t=""){let{path:i,scheme:r,server:n,prefix:o}=QT(e,t),l=i.split("/").reverse(),[u,h,g,f,...y]=l,S=y.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:o,identifier:S};if(u==="info.json"){let[,..._]=l;return{type:"info",scheme:r,server:n,prefix:o,identifier:_.reverse().filter(Boolean).join("/")}}let C=u.split(".");return{type:"image",scheme:r,server:n,prefix:o,identifier:S,originalPath:i,region:WT(f),size:HT(g),rotation:qT(h),quality:C[0],format:C[1]}}function GT(e){let t=VT(Kn(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=UT(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function YT(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o].width;n.push(e/l)}return n}function XT(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function zt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function yh(e){if(!e||!e.profile||!zt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&zT.indexOf(i)!==-1)return!0;return!1}function ZT(e){if(!yh(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(Iy.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function KT(e){if(!ZT(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let o=i[n];if(typeof o!="string"&&(o.maxHeight||o.maxWidth))return[{id:zt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:o.maxHeight||o.maxWidth,maxWidth:o.maxWidth||o.maxHeight}]}if(e.tiles){let n=e.tiles.length;for(let o=0;o<n;o++){let l=e.tiles[o];(l.height||l.width)&&t.push({id:zt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width})}}return t}function Ry(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),o=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&o&&l)return{type:"fixed",id:e,height:o,width:n}}return{type:"unknown",id:e}}function JT(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function bh(e){if(typeof e=="string")return Ry(e);let t=JT(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=zt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Ry(r):null}function e2(e){return yh(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:zt(e),type:"fixed-service",height:t.height,width:t.width})):[]}function Ly(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=e2(e[r]);n.length&&t.push(...n);let o=KT(e[r]);o.length&&t.push(...o)}return t}function Oy(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)yh(t[n])&&r.push(t[n]);return r}function t2(e,t=!0,i){let r=[],n=bh(e);if(n===null)return r;let o=e;if(r.push(n),t&&o.width&&o.height){let l=[],u=Oy(o);for(let h of u){let g={id:zt(h),width:o.width,height:o.height};if(i.canLoadSync(g)){let f=i.loadServiceSync(g);f&&(f.height||(f.height=o.height),f.width||(f.width=o.width),l.push(...Ly([f])))}}if(l.length)return r.push(...l),r}return o.service&&r.push(...Ly(o.service)),r}function i2({x:e=0,y:t=0,w:i,h:r,full:n,square:o,percent:l}){return"full"}function r2({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o,serialiseAsFull:l}){let u=[];return i&&u.push("^"),e?(u.push(l?"full":"max"),u.join("")):(r&&u.push("!"),t&&u.push(`pct:${t}`),n&&u.push(`${n}`),u.push(","),o&&u.push(`${o}`),u.join(""))}function n2(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function s2(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`,{region:n,size:o,rotation:l,format:u,quality:h}=e;return[r,i2(n),r2(o),n2(l),`${h}.${u}`].filter(Boolean).join("/")}function wh(e,t,i){let r=GT({id:Kn(zt(e)),profile:"level2"});return r.size.max=!1,r.size.width=t,r.size.height=i,{id:s2(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Ds(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function a2(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function o2(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],o=[],l=null,u=(g,f)=>{if(a2(r,f,g)){if(r.preferFixedSize&&g.unsafe){o.push(g);return}r.returnAllOptions&&f&&o.push(f),l=g}else r.returnAllOptions&&o.push(g)},h=t.length;for(let g=0;g<h;g++){let f=t[g](),y=f.length;for(let S=0;S<y;S++){let C=f[S];if(C.type==="unknown"&&r.atAnyCost&&n.push(C),C.type==="fixed"&&(C.unsafe?n.push(C):u(C,l)),C.type==="fixed-service")if(r.unsafeImageService){let _=wh(C,r.width,r.height);u(_,l)}else{let _=wh(C,C.width,C.height);u(_,l)}if(C.type==="variable"&&C.maxWidth){let _=wh({id:C.id,width:C.maxWidth,height:C.maxWidth},C.maxWidth);u(_,l)}}if(l&&!r.returnAllOptions){if(l.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&o.length===0?{best:l||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?l||o[0]||n[0]:l||o[0],fallback:[...o,...n],log:i}:{best:l||o[0]||null,fallback:l?o:o.slice(1),log:i}}var l2=Object.defineProperty,u2=Object.defineProperties,c2=Object.getOwnPropertyDescriptors,$y=Object.getOwnPropertySymbols,h2=Object.prototype.hasOwnProperty,d2=Object.prototype.propertyIsEnumerable,Fy=(e,t,i)=>t in e?l2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,f2=(e,t)=>{for(var i in t||(t={}))h2.call(t,i)&&Fy(e,i,t[i]);if($y)for(var i of $y(t))d2.call(t,i)&&Fy(e,i,t[i]);return e},p2=(e,t)=>u2(e,c2(t));function g2(e,t,i){let r=e>t?e:t,n=i.length,o=[];for(let l=0;l<n;l++){let u=i[l],h=u.scaleFactors[0],g=r/h,f=[h];for(;g>=u.width;)h=h*2,f.push(h),g=g/2;o.push(p2(f2({},u),{scaleFactors:f}))}return o}function m2(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let o=0;o<i;o++){let l=e[o],u=t[o];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++)if(e[o].width===t[l].width&&e[o].height===t[l].height){n++;break}return n===i}function My(e){if(e&&e.profile){let t=e.profile;if(t){let i=Array.isArray(t)?t:[t];return i.includes("level0")||i.includes("http://iiif.io/api/image/2/level0.json")||i.includes("http://iiif.io/api/image/1/level0.json")||i.includes("http://iiif.io/api/image/1/profiles/level0.json")}}return!1}var Jn=(e,t,i)=>new Promise((r,n)=>{var o=h=>{try{u(i.next(h))}catch(g){n(g)}},l=h=>{try{u(i.throw(h))}catch(g){n(g)}},u=h=>h.done?r(h.value):Promise.resolve(h.value).then(o,l);u((i=i.apply(e,t)).next())}),v2=class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Ds(zt(e)),n=Kn(zt(e)),o=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!o&&e.tiles&&!My(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:zt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:YT(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Ds(zt(e)),o=this.knownImageServers[n];if(!o||!o.result||!i&&(o.malformed||o.verifications<this.config.verificationsRequired)||My(e.source))return null;let l=Kn(zt(e));return this.imageServices[l]||(this.imageServices[l]={"@context":o.result.context,"@id":zt(e),id:zt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||g2(e.width,e.height,o.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||XT(Math.round(e.width/o.result.resourceServiceRatio),Math.round(e.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(r==null?void 0:r.profile)||o.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l]}getThumbnailFromResource(e,t){return Jn(this,arguments,function*(i,r,n=!0,o=[]){let l=yield this.getImageCandidates(i,n);return o2(r,[()=>o,()=>l])})}getImageCandidates(e,t=!0){return Jn(this,null,function*(){let i=e;if(t&&i.height&&i.width){let r=Oy(i);for(let n of r){let o={id:zt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(o)}}return t2(e,t,this)})}verify(e){return Jn(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(zt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&m2(t.sizes||[],i.sizes||[]);if(r){let n=Ds(zt(e));this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0)}return r})}canLoadSync(e){let t=typeof e=="string"?e:zt(e),i=Kn(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Ds(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Jn(this,null,function*(){return this.knownImageServers[Ds(zt(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return Jn(this,null,function*(){let i=Kn(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return Jn(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return Jn(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(o=>setTimeout(o,500));else{n=!1;break}}let i=this.knownImageServers[Ds(zt(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(zt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=Kn(zt(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};function y2(e,t={}){let i=t.imageServiceLoader||new v2;async function r(n,o,l,u=[],h){if(typeof n=="string")return{best:bh(n),fallback:[],log:[]};let g=e.get(n);if(typeof g=="string")return{best:bh(g),fallback:[],log:[]};switch(g.type){case"Annotation":{let f=g.body,y=e.get(f[0]);return h&&!y.width&&(y.width=h.width,y.height=h.height),await i.getThumbnailFromResource(y,o,l,u)}case"Canvas":{let f=g;if(f.thumbnail&&f.thumbnail.length){let y=e.get(f.thumbnail[0]),S=await i.getImageCandidates(y,l);S&&S.length&&u.push(...S)}return r(f.items[0],o,l,u,{width:f.width,height:f.height})}case"AnnotationPage":return r(g.items[0],o,l,u,h);case"Choice":return r(g.items[0],o,l,u,h);case"Collection":{let f=g.items[0];return r(f,o,l,u,h)}case"Manifest":{let f=g.items[0];return r(f,o,l,u,h)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return h&&!g.width&&(g.width=h.width,g.height=h.height),i.getThumbnailFromResource(g,o,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function b2(e,t,i=[],r=!1){if(!e||!t||t.length===0)return;if(t.length===1)return t[0];if(t.indexOf(e)!==-1)return e;let n=e.indexOf("-")!==-1?e.slice(0,e.indexOf("-")):null;if(n&&t.indexOf(n)!==-1)return n;for(let o of i)if(t.indexOf(o)!==-1)return o;if(!r){let o=t.map(l=>l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null).indexOf(e);if(o!==-1)return t[o];for(let l of i){let u=l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null,h=u?t.indexOf(u):-1;if(h!==-1)return t[h]}}return t.indexOf("none")!==-1?"none":t.indexOf("@none")!==-1?"@none":t[0]}function w2(e,t,i={}){let{strictFallback:r=!1,defaultText:n="",separator:o=`
`,fallbackLanguages:l=[],closest:u}=i,h=Object.keys(e||{}),g=u?t:b2(t,h,l,r);if(!e)return n;if(typeof e=="string")return e;let f=g?e[g]:void 0;return f?typeof f=="string"?f:f.join(o):""}function Ar(e,t={}){return w2(e,typeof navigator<"u"?navigator.language:void 0,t)}var x2=(function(){function e(t,i){var r=[],n=!0,o=!1,l=void 0;try{for(var u=t[Symbol.iterator](),h;!(n=(h=u.next()).done)&&(r.push(h.value),!(i&&r.length===i));n=!0);}catch(g){o=!0,l=g}finally{try{!n&&u.return&&u.return()}finally{if(o)throw l}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),La=Math.PI*2,xh=function(e,t,i,r,n,o,l){var u=e.x,h=e.y;u*=t,h*=i;var g=r*u-n*h,f=n*u+r*h;return{x:g+o,y:f+l}},_2=function(e,t){var i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),o=Math.cos(e+t),l=Math.sin(e+t);return[{x:r-n*i,y:n+r*i},{x:o+l*i,y:l-o*i},{x:o,y:l}]},zy=function(e,t,i,r){var n=e*r-t*i<0?-1:1,o=e*i+t*r;return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)},S2=function(e,t,i,r,n,o,l,u,h,g,f,y){var S=Math.pow(n,2),C=Math.pow(o,2),_=Math.pow(f,2),T=Math.pow(y,2),R=S*C-S*T-C*_;R<0&&(R=0),R/=S*T+C*_,R=Math.sqrt(R)*(l===u?-1:1);var O=R*n/o*y,E=R*-o/n*f,F=g*O-h*E+(e+i)/2,z=h*O+g*E+(t+r)/2,U=(f-O)/n,H=(y-E)/o,G=(-f-O)/n,V=(-y-E)/o,le=zy(1,0,U,H),q=zy(U,H,G,V);return u===0&&q>0&&(q-=La),u===1&&q<0&&(q+=La),[F,z,le,q]},E2=function(e){var t=e.px,i=e.py,r=e.cx,n=e.cy,o=e.rx,l=e.ry,u=e.xAxisRotation,h=u===void 0?0:u,g=e.largeArcFlag,f=g===void 0?0:g,y=e.sweepFlag,S=y===void 0?0:y,C=[];if(o===0||l===0)return[];var _=Math.sin(h*La/360),T=Math.cos(h*La/360),R=T*(t-r)/2+_*(i-n)/2,O=-_*(t-r)/2+T*(i-n)/2;if(R===0&&O===0)return[];o=Math.abs(o),l=Math.abs(l);var E=Math.pow(R,2)/Math.pow(o,2)+Math.pow(O,2)/Math.pow(l,2);E>1&&(o*=Math.sqrt(E),l*=Math.sqrt(E));var F=S2(t,i,r,n,o,l,f,S,_,T,R,O),z=x2(F,4),U=z[0],H=z[1],G=z[2],V=z[3],le=Math.abs(V)/(La/4);Math.abs(1-le)<1e-7&&(le=1);var q=Math.max(Math.ceil(le),1);V/=q;for(var ne=0;ne<q;ne++)C.push(_2(G,V)),G+=V;return C.map(function(ge){var de=xh(ge[0],o,l,T,_,U,H),we=de.x,me=de.y,ce=xh(ge[1],o,l,T,_,U,H),We=ce.x,ee=ce.y,Pe=xh(ge[2],o,l,T,_,U,H),Oe=Pe.x,Ge=Pe.y;return{x1:we,y1:me,x2:We,y2:ee,x:Oe,y:Ge}})},C2=A2,_h={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},k2=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function A2(e){var t=[];return e.replace(k2,function(i,r,n){var o=r.toLowerCase();for(n=T2(n),o=="m"&&n.length>2&&(t.push([r].concat(n.splice(0,2))),o="l",r=r=="m"?"l":"L");;){if(n.length==_h[o])return n.unshift(r),t.push(n);if(n.length<_h[o])throw new Error("malformed path data");t.push([r].concat(n.splice(0,_h[o])))}}),t}var P2=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function T2(e){var t=e.match(P2);return t?t.map(Number):[]}var I2=R2;function R2(e){var t=0,i=0,r=0,n=0;return e.map(function(o){o=o.slice();var l=o[0],u=l.toUpperCase();if(l!=u)switch(o[0]=u,l){case"a":o[6]+=r,o[7]+=n;break;case"v":o[1]+=n;break;case"h":o[1]+=r;break;default:for(var h=1;h<o.length;)o[h++]+=r,o[h++]+=n}switch(u){case"Z":r=t,n=i;break;case"H":r=o[1];break;case"V":n=o[1];break;case"M":r=t=o[1],n=i=o[2];break;default:r=o[o.length-2],n=o[o.length-1]}return o})}function L2(e){let t=C2(e),i=I2(t),r,n=0,o=0,l=0,u=0,h,g,f=0,y=0,S=[];for(let C=0;C<i.length;C++){let _=i[C],T=_[0];switch(T){case"M":n=_[1],o=_[2];break;case"H":_=["L",_[1],o];break;case"V":_=["L",n,_[1]];break;case"S":{let R=f,O=y;(r==="C"||r=="S")&&(R+=R-l,O+=O-u),_=["C",R,O,_[1],_[2],_[3],_[4]]}break;case"T":r==="Q"||r=="T"?(h=f*2-h,g=y*2-g):(h=f,g=y),_=["Q",h,g,_[1],_[2]];break;case"Q":h=_[1],g=_[2];break;case"A":{let R=E2({px:f,py:y,cx:_[6],cy:_[7],rx:_[1],ry:_[2],xAxisRotation:_[3],largeArcFlag:_[4],sweepFlag:_[5]});if(!R.length)continue;for(let[O,E]of R.entries())_=["C",E.x1,E.y1,E.x2,E.y2,E.x,E.y],O<R.length-1&&S.push(_);_=_}break;case"Z":_=["L",n,o];break}r=T,f=_[_.length-2],y=_[_.length-1],["C","Q","A"].indexOf(T)>-1?(l=_[_.length-4],u=_[_.length-3]):(l=f,u=y),S.push(_)}return S}function O2(e,t,i,r=1){return new Ny(e,t,i).subdivide(r)}function $2(e,t,i,r,n=1){return new jy(new Float64Array([e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y])).subdivide(n)}function F2(e){return e.x*e.x+e.y*e.y}function Oa(e){return e/(1-.67+Math.pow(Math.pow(.67,4)+.25*e*e,.25))}function Us(e){return e*(1-.39+Math.sqrt(.39*.39+.25*e*e))}var Ny=class{constructor(e,t,i){this.start=e,this.control=t,this.end=i}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:i,y:r}=this.control,{x:n,y:o}=this.end,l=2*i-e-n,u=2*r-t-o,h=(i-e)*l+(r-t)*u,g=(n-i)*l+(o-r)*u,f=(n-e)*u-(o-t)*l,y=h/f,S=g/f,C=Math.abs(f)/(Math.hypot(l,u)*Math.abs(S-y));return{x0:e,x2:n,scale:C,cross:f}}subdivide(e){let t=this.mapToBasic(),i=Oa(t.x0),r=Oa(t.x2),n=.5*Math.abs(r-i)*Math.sqrt(t.scale/e),o=Math.ceil(n),l=Us(i),u=Us(r),h=[0];for(let g=1;g<o;g++){let f=(Us(i+(r-i)*g/o)-l)/(u-l);h.push(f)}return h.push(1),h.map(g=>this.eval(g))}},jy=class{constructor(e){this.c=e}weightsum(e,t,i,r){let n=e*this.c[0]+t*this.c[2]+i*this.c[4]+r*this.c[6],o=e*this.c[1]+t*this.c[3]+i*this.c[5]+r*this.c[7];return{x:n,y:o}}eval(e){let t=1-e,i=t*t*t,r=3*t*t*e,n=3*t*e*e,o=e*e*e;return this.weightsum(i,r,n,o)}deriv(e){let t=1-e,i=-3*t*t,r=3*e*e,n=-6*e*t-i,o=6*e*t-r;return this.weightsum(i,n,o,r)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new Ny({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(e,t){let i=new Float64Array(8),r=this.eval(e),n=this.eval(t);i[0]=r.x,i[1]=r.y;let o=(t-e)/3,l=this.deriv(e);i[2]=r.x+o*l.x,i[3]=r.y+o*l.y;let u=this.deriv(t);return i[4]=n.x-o*u.x,i[5]=n.y-o*u.y,i[6]=n.x,i[7]=n.y,new jy(i)}subdivide(e){let t=.1*e,i=e-t,r=Math.sqrt(i),n=F2(this.weightsum(1,-3,3,-1)),o=Math.ceil(Math.pow(n/(432*t*t),1/6)),l=[],u=0;for(let C=0;C<o;C++){let _=C/o,T=(C+1)/o,R=this.subsegment(_,T).midpoint_quadbez(),O=R.mapToBasic(),E=Oa(O.x0),F=Oa(O.x2),z=Math.sqrt(O.scale),U=Math.abs(F-E)*z;if(Math.sign(O.x0)!=Math.sign(O.x2)){let H=r/z,G=r*Math.abs(F-E)/Oa(H);U=Math.max(U,G)}l.push({quad:R,a0:E,a2:F,val:U}),u+=U}let h=.5*u/r,g=Math.ceil(h),f=[{x:this.c[0],y:this.c[1]}],y=0,S=0;for(let C=1;C<g;C++){let _=u*C/g;for(;y+l[S].val<_;)y+=l[S].val,S++;let T=l[S].a0,R=l[S].a2,O=Us(T),E=Us(R),F=T+(R-T)*(_-y)/l[S].val,z=(Us(F)-O)/(E-O);f.push(l[S].quad.eval(z))}return f.push({x:this.c[6],y:this.c[7]}),f}},M2=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,z2=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/,By=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function Sh(e,{domParser:t,svgPreprocessor:i}={}){var r,n;if(Array.isArray(e))return e.reduce((o,l)=>{let{selector:u,selectors:h}=Sh(l);return u&&(o.selector||(o.selector=u),o.selectors.push(...h)),o},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[o,l]=e.split("#");return l?Sh({type:"FragmentSelector",value:l}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let o={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:o,selectors:[o]}}if(e.type==="FragmentSelector"){let o=M2.exec(e.value);if(o){let u={type:"BoxSelector",spatial:{unit:o[2]==="percent:"||o[2]==="pct:"?"percent":"pixel",x:parseFloat(o[3]),y:parseFloat(o[4]),width:parseFloat(o[5]),height:parseFloat(o[6])}};return{selector:u,selectors:[u]}}let l=e.value.match(z2);if(l){let u={type:"TemporalSelector",temporal:{startTime:l[4]?parseFloat(l[4]):0,endTime:l[7]?parseFloat(l[7]):void 0}};return{selector:u,selectors:[u]}}return{selector:null,selectors:[]}}if(e.type==="SvgSelector"&&"value"in e){t||(typeof window<"u"?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let o=[],l,u,h=(r=i==null?void 0:i(e.value))!=null?r:e.value,g;if(t){let y=t.parseFromString(e.value,"image/svg+xml").querySelector("svg");if(!y)return console.warn(`Illegal SVG selector: ${e.value}`),{selector:null,selectors:[]};let S=Dy(y);S&&(o=S.points,g=S.shapeType,l=[Math.min(...o.map(C=>C[0])),Math.min(...o.map(C=>C[1])),Math.max(...o.map(C=>C[0])),Math.max(...o.map(C=>C[1]))],{style:u,svg:h}=(n=B2(S.element))!=null?n:{svg:h})}let f={type:"SvgSelector",svg:h,svgShape:g,style:u,points:o.length?o:void 0,spatial:l?{unit:"pixel",x:l[0],y:l[1],width:l[2]-l[0],height:l[3]-l[1]}:void 0};return{selector:f,selectors:[f]}}return{selector:null,selectors:[]}}function N2(e){let t=e.map(r=>r[0]).reduce((r,n)=>(r[n]+=1,r),{C:0,Q:0,L:0,M:0}),i=new Set(e.map(r=>r[0]));if(t.C>0||t.Q>0)return"path";if(t.L>0&&(i.size===1||i.size===2&&i.has("M"))){if(t.L===4)return"rect";let r=e.slice(-1)[0];return e[0][0]==="M"&&r[0]==="L"&&r[1]==e[0][1]&&r[2]===e[0][2]||r[1]===0&&r[2]===0?"polygon":"polyline"}return"path"}function Dy(e){var t,i,r,n,o,l,u,h,g,f,y,S,C,_,T,R,O;for(let E of Array.from(e.children))switch(E==null?void 0:E.tagName.toLowerCase()){case"g":{let F=Dy(E);if(F)return F}continue;case"path":{let F=E.getAttribute("d");if(!F)continue;let z=L2(F);return{element:E,points:j2(z),shapeType:N2(z)}}case"circle":{let F=parseFloat((t=E.getAttribute("cx"))!=null?t:"0"),z=parseFloat((i=E.getAttribute("cy"))!=null?i:"0"),U=parseFloat((r=E.getAttribute("r"))!=null?r:"0");if(!U)continue;let H=[];for(let G=0;G<=360;G+=12){let V=G*Math.PI/180;H.push([F+U*Math.cos(V),z+U*Math.sin(V)])}return{element:E,points:H,shapeType:"circle"}}case"ellipse":{let F=parseFloat((n=E.getAttribute("cx"))!=null?n:"0"),z=parseFloat((o=E.getAttribute("cy"))!=null?o:"0"),U=parseFloat((l=E.getAttribute("rx"))!=null?l:"0"),H=parseFloat((u=E.getAttribute("ry"))!=null?u:"0");if(!U&&!H)continue;let G=[];for(let V=0;V<=360;V+=12){let le=Math.tan(V/360*Math.PI),q=U*(1-le**2)/(1+le**2),ne=H*2*le/(1+le**2);G.push([F+q,z+ne])}return{element:E,points:G,shapeType:"ellipse"}}case"line":{let F=parseFloat((h=E.getAttribute("x0"))!=null?h:"0"),z=parseFloat((g=E.getAttribute("y0"))!=null?g:"0"),U=parseFloat((f=E.getAttribute("x1"))!=null?f:"0"),H=parseFloat((y=E.getAttribute("y1"))!=null?y:"0");if(F===U&&z===H)continue;return{element:E,points:[[F,z],[U,H]],shapeType:"polyline"}}case"polygon":case"polyline":{let F=(C=(S=E.getAttribute("points"))==null?void 0:S.split(" ").map(U=>U.split(",").map(parseFloat)))!=null?C:[];if(!F.length)continue;let z="polyline";return E.tagName.toLowerCase()==="polygon"&&(F.push(F[0]),z="polygon"),{element:E,points:F,shapeType:z}}case"rect":{let F=parseFloat((_=E.getAttribute("x"))!=null?_:"0"),z=parseFloat((T=E.getAttribute("y"))!=null?T:"0"),U=parseFloat((R=E.getAttribute("width"))!=null?R:"0"),H=parseFloat((O=E.getAttribute("height"))!=null?O:"0");if(!U||!H)continue;return{element:E,points:[[F,z],[F+U,z],[F+U,z+H],[F,z+H],[F,z]],shapeType:"rect"}}default:continue}return null}function j2(e){var t;let i=[];for(let r=0;r<e.length;r++){let n=(t=i[i.length-1])!=null?t:[0,0],o=e[r];switch(o[0]){case"M":case"L":i.push([o[1],o[2]]);continue;case"C":i.push(...$2({x:n[0],y:n[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]},{x:o[5],y:o[6]}).map(l=>[l.x,l.y]).slice(1));continue;case"Q":i.push(...O2({x:n[0],y:n[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]}).map(l=>[l.x,l.y]).slice(1));continue}}return i}function B2(e){let t={};if(e.hasAttribute("fill")?(t.fill=e.getAttribute("fill"),e.removeAttribute("fill")):e.style.fill&&(t.fill=e.style.fill),t.fill){let r=By.exec(t.fill);r&&(t.fillOpacity=parseFloat(r[4]),t.fill=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}if(e.hasAttribute("fill-opacity")?(t.fillOpacity=parseFloat(e.getAttribute("fill-opacity")),e.removeAttribute("fill-opacity")):e.style.fillOpacity&&(t.fillOpacity=parseFloat(e.style.fillOpacity)),e.hasAttribute("stroke")?(t.stroke=e.getAttribute("stroke"),e.removeAttribute("stroke")):e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let r=By.exec(t.stroke);r&&(t.strokeOpacity=parseFloat(r[4]),t.stroke=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}e.hasAttribute("stroke-opacity")?(t.strokeOpacity=parseFloat(e.getAttribute("stroke-opacity")),e.removeAttribute("stroke-opacity")):e.style.strokeOpacity&&(t.strokeOpacity=parseFloat(e.style.strokeOpacity)),e.hasAttribute("stroke-width")?(t.strokeWidth=e.getAttribute("stroke-width"),e.removeAttribute("stroke-width")):e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute("stroke-dasharray")?(t.strokeDasharray=e.getAttribute("stroke-dasharray"),e.removeAttribute("stroke-dasharray")):e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let i=e;for(;i.tagName.toLowerCase()!=="svg";)if(i=i.parentElement,i===null)throw new Error("Could not find root SVG element");return{svg:i.outerHTML,style:Object.keys(t).length>0?t:void 0}}function D2(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function U2(e){function t(n){let o=n?typeof n=="string"?e.get(n):n:null;if(!o)return[];let l=e.get(o.items),u=[];for(let h of l)u.push(...e.get(h.items));return u}function i(n,o=[]){let l=Array.isArray(n)?n:t(n),u=[],h=null,g=[];for(let f of l){if(f.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let y=e.get(f.body);for(let S of y){let[C,{selector:_}]=D2(S),T=(C.type||"unknown").toLowerCase();if(T==="choice"){let R=e.get(C.items),O=o.length?o.map(E=>R.find(F=>F.id===E)).filter(Boolean):[R[0]];O.length===0&&O.push(R[0]),h={type:"single-choice",items:R.map(E=>({id:E.id,label:E.label,selected:O.indexOf(E)!==-1})),label:S.label},y.push(...O);continue}u.indexOf(T)===-1&&u.push(T),g.push({type:T,resource:C,target:f.target,selector:_})}}return{types:u,items:g,choice:h}}function r(n){let{choice:o}=i(n);return o}return{getAllPaintingAnnotations:t,getPaintables:i,extractChoices:r}}function Uy(e,t){for(let i of t.items){if(i.type==="Canvas")return i;if(i.type==="Range"){let r=Uy(e,e.get(i));if(r)return r}}return null}function W2(e,t,i){for(let r of t.structures){let n=Wy(e,e.get(r),i);if(n)return n}return null}function Wy(e,t,i){var r;for(let n of t.items){let o=(r=n.id)==null?void 0:r.split("#")[0];if(n.type==="SpecificResource"&&n.source===i||n.type==="Canvas"&&i===o)return t;if(n.type==="Range"){let l=Wy(e,e.get(n),i);if(l)return l}}return null}var H2=class{constructor(e){this.__vault=null,this.__eventsHelper=null,this.__stylesHelper=null,this.__e={},this.htmlProps={},this.handlers=[],this.__annotation=typeof e=="string"?{id:e,type:"Annotation"}:{id:e.id,type:"Annotation"},this.classList=new kT(t=>{this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",D(A({},this.htmlProps),{className:t}))}),this.source=e}get className(){return this.classList.getClassName()}set className(e){this.classList.className=e}set href(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{href:e}),this.htmlProps.href=e}set title(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{title:e}),this.htmlProps.title=e}set target(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{target:e}),this.htmlProps.target=e}applyStyle(e){this.style=tm(this.style,e),this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style)}addEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.addEventListener(this.__annotation,e,t),this.handlers.push([e,t])}removeEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.removeEventListener(this.__annotation,e,t),this.handlers=this.handlers.filter(i=>i[0]===e&&i[1]===t)}bindToVault(e){this.__vault=e,this.__eventsHelper=mh(e),this.__stylesHelper=vh(e);for(let[t,i]of this.handlers)this.__eventsHelper.addEventListener(this.__annotation,t,i);this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style),this.__stylesHelper.applyStyles(this.__annotation,"html",D(A({},this.htmlProps),{className:this.classList.getClassName()}))}getSource(){return this.source}getAnnotation(){return this.__annotation}beforeRemove(){if(this.onBeforeRemove&&this.onBeforeRemove(),this.__vault){if(this.__eventsHelper)for(let[e,t]of this.handlers)this.__eventsHelper.removeEventListener(this.__annotation,e,t);this.__vault=null}}};Qe();var di=De(rc(),1),Hy="@iiif/IMPORT_ENTITIES",qy="@iiif/MODIFY_ENTITY_FIELD",Qy="@iiif/REORDER_ENTITY_FIELD",Vy="@iiif/ADD_REFERENCE",Gy="@iiif/REMOVE_REFERENCE",Yy=(0,di.createAction)(Hy)(),q2=(0,di.createAction)(qy)(),Q2=(0,di.createAction)(Qy)(),V2=(0,di.createAction)(Vy)(),G2=(0,di.createAction)(Gy)(),Y2={importEntities:Yy,modifyEntityField:q2,reorderEntityField:Q2,addReference:V2,removeReference:G2},Xy="@iiif/ADD_MAPPING",Zy="@iiif/ADD_MAPPINGS",X2=(0,di.createAction)(Xy)(),Z2=(0,di.createAction)(Zy)(),Ky="@iiif/SET_META_VALUE",Jy="@iiif/SET_META_VALUE_DYNAMIC",eb="@iiif/UNSET_META_VALUE",K2=(0,di.createAction)(Ky)(),J2=(0,di.createAction)(Jy)(),eI=(0,di.createAction)(eb)(),tb={setMetaValue:K2,setMetaValueDynamic:J2,unsetMetaValue:eI},Eh="RESOURCE_ERROR",ib="RESOURCE_LOADING",Ch="RESOURCE_READY",rb="@iiif/REQUEST_RESOURCE",nb="@iiif/REQUEST_ERROR",sb="@iiif/REQUEST_MISMATCH",ab="@iiif/REQUEST_COMPLETE",ob="@iiif/REQUEST_OFFLINE_RESOURCE",tI=(0,di.createAction)(rb)(),lb=(0,di.createAction)(nb)(),iI=(0,di.createAction)(sb)(),rI=(0,di.createAction)(ab)();(0,di.createAction)(ob)();var kh="@iiif/BATCH",ub="@iiif/BATCH_IMPORT",Ah=(0,di.createAction)(kh)();(0,di.createAction)(ub)();var nI=(e,t)=>{let{entities:i,resource:r,mapping:n}=Im(t);if(r.id===void 0)return[lb({id:e,message:"ID is not defined in resource."})];let o=[Yy({entities:i}),Z2({mapping:n})];return r.id!==e&&(o.push(X2({id:e,type:r.type})),o.push(iI({requestId:e,actualId:r.id}))),o.push(rI({id:e})),o},cb=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function sI(e,t){return!!(e===t||cb(e)&&cb(t))}function hb(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!sI(e[i],t[i]))return!1;return!0}function Ph(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function db(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let o=e.getState(),l=o.iiif.requests[r];if(l)switch(l.loadingState){case Eh:break;case ib:{let u,h=!1;try{let g=await Promise.race([new Promise((f,y)=>{h||(u=e.subscribe(()=>{let S=e.getState();if(S.iiif.requests[r].loadingState===Eh){y();return}if(S.iiif.requests[r].loadingState===Ch){let C=Ph(S,r);C?f(C):y()}}))}),new Promise((f,y)=>setTimeout(()=>{h=!0,y()},i*60))]);if(u&&u(),g)return g}catch{u&&u();break}break}case Ch:{let u=Ph(o,r);if(u)return u;break}}e.dispatch(tI({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let h=nI(r,u);return e.dispatch(Ah({actions:h})),Ph(e.getState(),r)}catch(u){throw e.dispatch(lb({id:r,message:u.toString()})),u}}}function aI(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var oI=(e={},t)=>{switch(t.type){case Xy:return D(A({},e),{[t.payload.id]:t.payload.type});case Zy:return A(A({},e),t.payload.mapping);default:return e}};function Th(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}function lI(e,t){let i={},r=[];for(let[n,o]of Object.entries(e||{})){r.push(n);let l=(t||{})[n];if(!l||l.length===0){i[n]=o;continue}i[n]=l}for(let[n,o]of Object.entries(t||{}))r.indexOf(n)===-1&&(i[n]=o);return i}var uI=(e=aI(),t)=>{var i;switch(t.type){case qy:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:t.payload.value})})})}case Qy:{if(!Th(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[o]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,o),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})})}case Hy:{let r=Object.keys(t.payload.entities),n=A({},e);for(let o of r){let l=t.payload.entities[o],u=A({},e[o]||{}),h=!1,g=Object.keys(l||{})||[];if(l&&g){for(let f of g)h=!0,u[f]=e[o][f]?lI(e[o][f],l[f]):l[f];h&&(n[o]=u)}}return n}case Vy:{if(!Th(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})})}case Gy:{if(!Th(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),o=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return o===-1||((i=n[o])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(o,1),D(A({},e),{[t.payload.type]:D(A({},e[t.payload.type]),{[t.payload.id]:D(A({},r),{[t.payload.key]:n})})}))}default:return e}},cI=(e={},t)=>{switch(t.type){case rb:case ob:return D(A({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:ib,uriMismatch:!1,resourceUri:t.payload.id}});case sb:return D(A({},e),{[t.payload.requestId]:D(A({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case nb:return D(A({},e),{[t.payload.id]:D(A({},e[t.payload.id]||{}),{loadingState:Eh,error:t.payload.message})});case ab:return D(A({},e),{[t.payload.id]:D(A({},e[t.payload.id]||{}),{loadingState:Ch,error:void 0})})}return e},hI=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:o,key:l}=t&&t.payload||{};switch(t.type){case Ky:return D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:n})})});case Jy:return D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:e[i]&&e[i][o]?r(e[i][o][l]):r(void 0)})})});case eb:return e[i]&&e[i][o]&&e[i][o][l]?D(A({},e),{[i]:D(A({},e[i]||{}),{[o]:D(A({},e[i]?e[i][o]||{}:{}),{[l]:void 0})})}):e;default:return e}};function dI(e){return(t,i)=>i&&i.type===kh?i.payload.actions.reduce(e,t):i&&i.type===ub?i.payload.state:e(t,i)}var fI=cl({mapping:oI,entities:uI,requests:cI,meta:hI}),pI=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Vn;function gI(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:o={}}=e,l=cl(A({[i]:fI},o));return Qc(dI(l),r,t?pI(hl(...n)):Vn(hl(...n)))}function mI(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var vI=class{constructor(e,t){Ve(this,"options"),Ve(this,"store"),Ve(this,"emitter"),Ve(this,"isBatching",!1),Ve(this,"batchQueue",[]),Ve(this,"remoteFetcher"),Ve(this,"staticFetcher"),Ve(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Ve(this,"middleware",i=>r=>n=>{if(n.type===kh){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let o=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:o}),o}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||gI({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=mI(),this.remoteFetcher=db(this.store,this.options.customFetcher),this.staticFetcher=db(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Ah({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Ah({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(Y2.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return Lm(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,$m)}toPresentation3(e){return this.serialize(e,zm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(h=>this.get(h,i));let n=this.getState();if(typeof e=="string"){let h=t||n.iiif.mapping[e];if(!h)return r?null:{id:e,type:"unknown"};e={id:e,type:h}}let o=t||e.type,l=e.id,u=n.iiif.entities[o];if(!u){let h=n.iiif.requests[l];return h&&h.resourceUri!==l?this.get(h.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return hb(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),o=e(n);r!==o&&!hb(r,o)&&t(o,this),r=o})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?tb.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):tb.setMetaValue({id:e,meta:t,key:i,value:r}))}};function yI(){return typeof self<"u"?self:typeof window<"u"?window:typeof Su<"u"?Su:{}}function Ih(e){let t=yI();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new vI(e);try{t.IIIF_VAULT=i}catch{}return i}var es=pb(),fb=pb();function pb(e){let t={},i=(n,o)=>{var l;return t[n]===void 0&&(t[n]=[]),(l=t[n])==null||l.push(o),()=>{r(n,o)}},r=(n,o)=>{var l,u,h;let g=(u=(l=t[n])==null?void 0:l.indexOf(o))!=null?u:-1;(h=t[n])==null||h.splice(g>>>0,1)};return{on:i,off:r,once:(n,o)=>{let l=u=>{o(u),r(n,l)};i(n,l)},emit:(n,o)=>{var l;(l=t[n])==null||l.forEach(u=>{try{u(o)}catch{}})}}}function El(e){let t=ke(),i=.75,r=1/.75,n=bl(),o=e.vault||n||Ih(),l=ph(),u=ke({}),{isReady:h,isConfigBlocking:g,setIsReady:f,internalConfig:y}=yT(e.preset,(be,Ne)=>{t.current?t.current.dispatchEvent(new CustomEvent("media",{detail:{query:be,config:Ne}})):u.current[be]=Ne}),S=Ae(()=>mh(o),[o]),C=Ae(()=>vh(o),[o]),_=Ae(()=>y2(o,{imageServiceLoader:l}),[o,l]),[T]=Be(e.nested||y.nested,{parse:ot,defaultValue:!1}),[R]=Be(e.x||y.x,{parse:kr,defaultValue:0}),[O]=Be(e.y||y.y,{parse:kr,defaultValue:0}),E=ke(),[F]=Be(e.render||y.render,{defaultValue:"canvas"}),[z]=Be(e.class),[U]=Be(e.virtualSizes||y.virtualSizes,{parse:ET}),[H]=Be(e.height||y.height,{parse:kr}),[G]=Be(e.width||y.width,{parse:kr}),[V]=Be(e.a11yRole||void 0),[le]=Be(e.a11yTitle||void 0),[q]=Be(e.interactive||y.interactive,{parse:ot,defaultValue:!0}),[ne]=Be(e.background),[ge]=Be(e.viewport||y.viewport,{parse:ot,defaultValue:!0}),[de]=Be(e.responsive||y.responsive,{parse:ot,defaultValue:!0}),[we]=Be(e.moveEvents||y.moveEvents,{parse:ot,defaultValue:!1}),[me]=Be(e.granularMoveEvents||y.granularMoveEvents,{parse:ot,defaultValue:!1}),[ce]=Be(e.clickToEnableZoom||e.clickToEnableZoom,{parse:ot,defaultValue:!0}),[We]=Be(e.disableKeyboardNavigation||y.disableKeyboardNavigation,{parse:ot,defaultValue:!1}),[ee]=Be(e.debug||y.debug,{parse:ot}),[Pe]=Be(e.enablePanOnWait||y.enablePanOnWait,{parse:ot,defaultValue:void 0}),[Oe]=Be(e.ignoreSingleFingerTouch||y.ignoreSingleFingerTouch,{parse:ot,defaultValue:void 0}),[Ge]=Be(e.requireMetaKeyForWheelZoom||y.requireMetaKeyForWheelZoom,{parse:ot,defaultValue:!1}),[ut]=Be(e.panOnWaitDelay||y.panOnWaitDelay,{parse:kr,defaultValue:40}),[K]=Be(e.enableNavigator||y.enableNavigator,{parse:ot}),[Ce,dt,pt,Et]=Be(e.target||e.region||y.target||y.region,{parse:gh}),[Ri,cr,,hr]=Be(e.rotation,{parse:kr}),[Li,jt,,Zi]=Be(e.highlight||y.highlight,{parse:gh}),[Wt]=Be(e.styleId||y.styleId),[Qr]=Be(e.highlightCssClass||y.highlightCssClass,{defaultValue:"canvas-panel-highlight"}),[Vr,,,ue]=Be(e.preferredFormats||y.preferredFormats,{parse:ly}),[xe]=Be(e.homeCover,{parse:be=>be==="false"?!1:be==="true"?!0:be==="start"?"start":be==="end"?"end":!1}),[Fe,rt]=Be(e.atlasMode||y.atlasMode),[Ct,ii]=ze(""),[Oi,zh]=ze(""),[ts]=Be(e.stylesheet||y.stylesheet),Ni=ke({}),[Tl,Nh]=ze("");function jh(be,Ne={}){return Be(e[be]||y[be],Ne)}function za(){if(t.current&&E.current){let be=t.current.getBoundingClientRect(),Ne=E.current.world.height||1,gt=E.current.world.width||1;return gt/Ne<1?be.height/Ne:be.width/gt}return-1}let qs=ke({});fe(()=>{let be=es.on("onResetSeen",()=>{qs.current={}}),Ne=ie=>{let Ie=ie.choice;if(t!=null&&t.current&&Ie&&Ie.items){let et=Ie.items;et.sort((Pr,ja)=>Pr.id<ja.id?-1:Pr.id>ja.id?1:0);let xt=et.map(Pr=>Pr.id).join(""),lt=et.map(Pr=>Pr.selected).join("");if(qs.current[xt]&&qs.current[xt]==lt)return;qs.current[xt]=lt,Ie.partOf=ie.partOf,t.current.dispatchEvent(new CustomEvent("choice",{detail:{choice:Ie}}))}},gt=ie=>{t!=null&&t.current&&t.current.dispatchEvent(new ErrorEvent("cp-load-error",{message:ie.message,error:ie.error}))},Bt=fb.on("onErrorEvent",gt),Ht=es.on("onChoiceChange",Ne);return()=>{Bt(),be(),Ht()}},[]),fe(()=>{if(E.current&&t.current){let be=A({},Na(E.current));Ct=="queued"&&be&&(be==null?void 0:be.scaleFactor)<1&&be.scaleFactor>0&&t.current!=null&&(ii("fired"),setTimeout(()=>{var Ne;(Ne=t.current)==null||Ne.dispatchEvent(new CustomEvent("world-ready",{detail:be}))},100))}},[h,t.current,Tl,Ct]),fe(()=>{var be;let Ne=E.current,gt=(be=E.current)==null?void 0:be.transitionManager;if(Ne&&gt&&h){let Bt=!1,Ht=0;return Ne.world.addLayoutSubscriber(async(ie,Ie)=>{if(ie!=="repaint"&&t.current){if(["recalculate-world-size","zoom-to","go-home","goto-region"].includes(ie)){if(ie=="recalculate-world-size"&&ii("queued"),gt.hasPending()){if(Bt)return;Bt=!0,await new Promise(Pr=>setTimeout(Pr,gt.pendingTransition.total_time-gt.pendingTransition.elapsed_time)),Bt=!1}let et=za(),xt=Math.abs(et-Ne._lastGoodScale)<2e-4;xt?Ht++:Ht=0;let lt={detail:A(D(A({source:ie,minZoomCount:Ht},Na(Ne)),{isMin:xt,isMax:Math.abs(Ne.maxScaleFactor-Ne._lastGoodScale)<2e-4}),Ie||{})};t.current.dispatchEvent(new CustomEvent("zoom",lt));return}t.current.dispatchEvent(new CustomEvent(ie,{detail:Ie}))}})}return()=>{}},[h,Tl]);function Na(be){let Ne=be._lastGoodScale,gt=za(),Bt=be.getZoomedPosition(r,{}),Ht=be.getZoomedPosition(i,{}),ie={width:Math.round(Ht[3]),height:Math.round(Ht[4])},Ie={width:Math.round(Bt[3]),height:Math.round(Bt[4])},et={width:Math.round(be.target[3]),height:Math.round(be.target[4])},xt=2,lt=et.height+xt<Ie.height&&et.width+xt<Ie.width;return{canZoomIn:et.height>ie.height&&et.width>ie.width,canZoomOut:lt,scaleFactor:be.getScaleFactor(),current:Ne,max:be.maxScaleFactor,min:gt,worldHeight:be.world.height,worldWidth:be.world.width}}fe(()=>{var be;let Ne=E.current,gt=(be=E.current)==null?void 0:be.transitionManager;if(h&&Ne&&we){let Bt=-1,Ht=-1,ie=!1;return Ne.registerHook("useAfterFrame",async()=>{if(t.current&&(Ne.target[1]!==Bt||Ne.target[2]!==Ht)){if(!me&&gt){if(ie)return;gt.hasPending()&&(ie=!0,await new Promise(Ie=>setTimeout(Ie,gt.pendingTransition.total_time-gt.pendingTransition.elapsed_time)),ie=!1)}t.current.dispatchEvent(new CustomEvent("move",{detail:{x:Ne.x,y:Ne.y,width:Ne.width,height:Ne.height,points:Ne.target,lastX:Bt,lastY:Ht}})),Bt=Ne.x,Ht=Ne.y}})}return()=>{}},[h,we]);function Il(be){Tt(()=>{e.__registerPublicApi&&e.__registerPublicApi(be)},[])}return Il(be=>{t.current=be;let Ne,gt,Bt=!1;if(ce){Ne=Ie=>{Ie.stopPropagation()};let ie=()=>{Ne&&!Bt&&(Bt=!0,be.addEventListener("wheel",Ne,{capture:!0}),be.addEventListener("touchstart",Ne,{capture:!0}))};gt=()=>{Ne&&Bt&&(Bt=!1,be.removeEventListener("wheel",Ne,{capture:!0}),be.removeEventListener("touchstart",Ne,{capture:!0}))},ie(),document.addEventListener("click",Ie=>{document.activeElement!==be&&ie()})}be.addEventListener("click",ie=>{gt&&gt();let Ie=ie.composedPath()[0];Ie&&be!==document.activeElement&&Ie.focus()});let Ht=Object.keys(u.current);if(Ht.length){for(let ie of Ht)be.dispatchEvent(new CustomEvent("media",{detail:{query:ie,config:u.current[ie]}}));u.current={}}return{vault:o,events:S,styles:C,thumbnailHelper:_,imageServiceLoader:l,getRotation:()=>hr.current,setRotation:ie=>{be.setAttribute("rotation",ie.toString())},getHighlight:()=>Zi.current,setHighlight:ie=>{typeof ie=="string"?be.setAttribute("highlight",ie):jt(ie)},getTarget:()=>Et.current,setTarget:ie=>{typeof ie=="string"?be.setAttribute("target",ie):dt(ie)},setDefaultChoiceIds:ie=>{be.setAttribute("choice-id",ie.join(","))},getPosition(){var ie,Ie,et,xt;return{x:(ie=E.current)==null?void 0:ie.x,y:(Ie=E.current)==null?void 0:Ie.y,width:(et=E.current)==null?void 0:et.width,height:(xt=E.current)==null?void 0:xt.height}},getMaxZoom(){var ie;return((ie=E.current)==null?void 0:ie.maxScaleFactor)||1},getMinZoom(){return za()||0},makeChoice(ie,Ie){es.emit("onMakeChoice",{id:ie,options:Ie})},zoomIn(ie){E.current&&E.current.world.trigger("zoom-to",{point:ie,factor:i})},zoomOut(ie){E.current&&E.current.world.trigger("zoom-to",{point:ie,factor:r})},zoomBy(ie,Ie){E.current&&E.current.world.trigger("zoom-to",{point:Ie,factor:ie})},zoomTo(ie,Ie,et){E.current&&E.current.world.zoomTo(ie,Ie,et)},withAtlas(ie){E.current?ie(E.current):Ni.current=D(A({},Ni.current),{[new Date().getTime()]:Ie=>ie(Ie)})},goHome(ie=!1){E.current?E.current.world.goHome(ie):Ni.current=D(A({},Ni.current),{viewport:Ie=>Ie.world.goHome(ie)})},getZoom(){var ie;return(ie=E.current)==null?void 0:ie._lastGoodScale},getScaleInformation(){let ie=E.current;if(ie!=null)return A({},Na(ie))},goToTarget(ie,Ie={}){E.current?E.current.world.gotoRegion(A(A({},ie),Ie)):Ni.current=D(A({},Ni.current),{viewport:et=>{et.world.gotoRegion(A(A({},ie),Ie))}})},setFps(ie){E.current?E.current.fpsLimit=ie:Ni.current=D(A({},Ni.current),{setFps:Ie=>{Ie.fpsLimit=ie}})},clearTarget(){dt(void 0),E.current?E.current.world.goHome(!0):Ni.current=D(A({},Ni.current),{viewport:ie=>{ie.world.goHome(!0)}})},setPreferredFormats(ie){be.setAttribute("preferred-formats",ie.join(","))},getPreferredFormats(){return ue.current||[]},setMode(ie){be.setAttribute("atlas-mode",ie)},applyStyles(ie,Ie){C.applyStyles(typeof ie=="string"?{id:ie}:ie,"atlas",Ie)},applyHTMLProperties(ie,Ie){C.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",Ie)},setClassName(ie,Ie){C.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",{className:Ie})},createAnnotationDisplay(ie){return new H2(ie)},getThumbnail(ie,Ie,et){return _.getBestThumbnailAtSize(ie,Ie,et)},addVaultEventListener(ie,Ie,et,xt){return S.addEventListener(ie,Ie,et,xt)},removeVaultEventListener(ie,Ie,et){S.removeEventListener(ie,Ie,et)},getListenersAsProps(ie,Ie){return S.getListenersAsProps(ie,Ie)}}}),fe(()=>{if(E.current){let be=Object.values(Ni.current);for(let Ne of be)Ne(E.current);Ni.current={}}},[h]),Tt(()=>{if(Wt){let be=document.getElementById(Wt);be&&zh(be.innerText)}},[h,Wt]),Tt(()=>{if(t.current&&!We){let be=gt=>{var Bt,Ht,ie;if(E.current&&E.current.transitionManager){let Ie=E.current.transitionManager,et=Ie.pendingTransition.done?E.current.target:Ie.pendingTransition.to,xt=Math.min(et[3]-et[1],et[4]-et[2])*.1,lt;switch(gt.key){case"=":{(Bt=E.current.world)==null||Bt.zoomIn();return}case"-":{(Ht=E.current.world)==null||Ht.zoomOut();return}case"0":{(ie=E.current.world)==null||ie.goHome();return}case"ArrowRight":{gt.preventDefault(),lt=et.slice(0),lt[1]=lt[1]+xt,lt[3]=lt[3]+xt;break}case"ArrowLeft":{gt.preventDefault(),lt=et.slice(0),lt[1]=lt[1]-xt,lt[3]=lt[3]-xt;break}case"ArrowUp":{gt.preventDefault(),lt=et.slice(0),lt[2]=lt[2]-xt,lt[4]=lt[4]-xt;break}case"ArrowDown":{gt.preventDefault(),lt=et.slice(0),lt[2]=lt[2]+xt,lt[4]=lt[4]+xt;break}}lt&&Ie.applyTransition(lt,{duration:500,easing:Er.easeOutExpo,constrain:!0})}},Ne=t.current;return Ne.addEventListener("keydown",be),()=>{Ne.removeEventListener("keydown",be)}}return()=>{}},[We]),{atlasProps:Ae(()=>({children:null,nested:T,responsive:de,viewport:ge,enableNavigator:K,onCreated:be=>{ii(""),f(!0),Nh(be.runtime.id),E.current=be.runtime},homePosition:Ce&&Ce.selector&&Ce.selector.type==="BoxSelector"?Ce.selector.spatial:void 0,renderPreset:F==="static"?["static-preset",{interactive:q}]:["default-preset",{interactive:q,unstable_webglRenderer:F==="webgl",controllerConfig:{ignoreSingleFingerTouch:Oe,enablePanOnWait:Pe,requireMetaKeyForWheelZoom:Ge,panOnWaitDelay:ut}}],width:G||void 0,height:H||(de?void 0:512),role:V,title:le}),[de,ge,Ce,F,K,y,V,le]),background:ne,isReady:h,isConfigBlocking:g,setIsReady:f,internalConfig:y,target:Ce,setParsedTarget:pt,highlight:Li,highlightCssClass:Qr,preferredFormats:Vr,render:F,interactive:q,mode:Fe,setMode:rt,virtualSizes:U,styleId:Wt,responsive:de,viewport:ge,debug:ee,enableNavigator:K,height:H,width:G,className:z,inlineStyles:Oi,inlineStyleSheet:ts,vault:o,nested:T,x:R,y:O,rotation:Ri,homeCover:xe,useProp:jh,useRegisterWebComponentApi:Il,runtime:E,webComponent:t}}Xe(),Qe();var Rh=Kt(!1);function bI(e){let t=ll();return fe(()=>{t&&e.onCreated(t)},[t]),null}function Lh(e){var t=e,{children:i,onCreated:r,responsive:n,viewport:o,nested:l}=t,u=oe(t,["children","onCreated","responsive","viewport","nested"]);let[h,g]=ze(!1),f=Yt(Rh);return l||f?$(Je,null,r?$(bI,{onCreated:r}):null,i):$(Rh.Provider,{value:!0},$(vC,D(A({},u),{onCreated:y=>{if(g(!0),r)return y.runtime.updateNextFrame(),r(y)},unstable_noReconciler:!0}),$(Rh.Provider,{value:!0},h?i:null)))}Xe();function gb(e){var t=e,{children:i}=t,r=oe(t,["children"]);let n=bl(),{setIsReady:o,atlasProps:l,isReady:u,className:h}=El(r);return $(pn,{vault:n},$(Lh,A({onCreated:()=>{o(!0)},viewport:!0,className:h||""},l),u?$("slot",null,i):null))}if(typeof window<"u"){let e={shadow:!0,onConstruct(t){t._props={__registerPublicApi:i=>{Object.assign(t,i(t))}}}};On(gb,"atlas-viewer",[],e),On(gb,"layout-container",[],e)}Xe(),Qe(),Xe(),Qe();var mb=()=>()=>({}),Oh=Kt(mb);function $a(e,t){let i=ke(),r=Yt(Oh)||mb;i.current!==t&&r(e),i.current=t}Xe();var wI=De(qf());Qe(),Xe(),Xe(),Qe();var vb=Kt(null);function vn({displayName:e,component:t,customConstructor:i}){let r=li(function(n,o){var l=n,{children:u}=l,h=oe(l,["children"]);let[g,f]=ze(),y=ll(),S=Yt(vb),C=ke(h);return fe(()=>(y&&y.runtime&&f(i?i(h):new t),()=>{}),[]),fe(()=>{if(y&&y.runtime&&g){let _=y.runtime,T=y.runtime.world,R=S||T;R.appendChild(g),o&&(typeof o=="function"?o(g):o.current=g),g instanceof ln&&(_.world=g),g instanceof Os||(_.pendingUpdate=!0,_.world&&_.world.needsRecalculate&&(_.world.recalculateWorldSize(),_.world.triggerRepaint()));let O=R,E=g;return()=>{E&&(O.removeChild(E),_.pendingUpdate=!0,_.world&&_.world.needsRecalculate&&(_.world.recalculateWorldSize(),_.world.triggerRepaint()))}}return()=>{}},[g,y==null?void 0:y.runtime]),fe(()=>{g&&y&&y.runtime&&(Mc(y.runtime.world,h),Fc(g,C.current,h),C.current=h,y.runtime.pendingUpdate=!0,y.runtime.world&&(y.runtime.world.needsRecalculate=!0,y.runtime.world.needsRecalculate&&(y.runtime.world.recalculateWorldSize(),y.runtime.world.triggerRepaint())))},[g,h]),g?$(vb.Provider,{value:g},u):null});return r.displayName=e,Hu(r)}Xe(),Qe();var xI=Object.defineProperty,_I=(e,t,i)=>t in e?xI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Cl=(e,t,i)=>(_I(e,typeof t!="symbol"?t+"":t,i),i);function yn(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var SI="http://library.stanford.edu/iiif/image-api/compliance.html#level0",yb="http://library.stanford.edu/iiif/image-api/compliance.html#level1",bb="http://library.stanford.edu/iiif/image-api/compliance.html#level2",EI="http://library.stanford.edu/iiif/image-api/conformance.html#level0",wb="http://library.stanford.edu/iiif/image-api/conformance.html#level1",xb="http://library.stanford.edu/iiif/image-api/conformance.html#level2",CI="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",_b="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Sb="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",kI="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",Eb="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Cb="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",AI="http://iiif.io/api/image/1/level0.json",PI="http://iiif.io/api/image/1/profiles/level0.json",kb="http://iiif.io/api/image/1/level1.json",Ab="http://iiif.io/api/image/1/profiles/level1.json",Pb="http://iiif.io/api/image/1/level2.json",Tb="http://iiif.io/api/image/1/profiles/level2.json",TI="http://iiif.io/api/image/2/level0.json",II="http://iiif.io/api/image/2/profiles/level0.json",Ib="http://iiif.io/api/image/2/level1.json",Rb="http://iiif.io/api/image/2/profiles/level1.json",Lb="http://iiif.io/api/image/2/level2.json",Ob="http://iiif.io/api/image/2/profiles/level2.json",RI="level0",$b="level1",Fb="level2",LI="http://iiif.io/api/image/2/level0",Mb="http://iiif.io/api/image/2/level1",zb="http://iiif.io/api/image/2/level2",OI="https://iiif.io/api/image/1.1/compliance/#level0",Nb="https://iiif.io/api/image/1.1/compliance/#level1",jb="https://iiif.io/api/image/1.1/compliance/#level2",Bb=[zb,bb,xb,Sb,Cb,Pb,Tb,Lb,Ob,Fb,jb],Db=[...Bb,Mb,yb,wb,_b,Eb,kb,Ab,Ib,Rb,$b,Nb],$I=[LI,Mb,zb,SI,yb,bb,EI,wb,xb,CI,_b,Sb,kI,Eb,Cb,AI,PI,kb,Ab,Pb,Tb,TI,II,Ib,Rb,Lb,Ob,RI,$b,Fb,OI,Nb,jb],FI={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},MI={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},zI={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function NI(e){return Bb.indexOf(e)!==-1?zI:Db.indexOf(e)!==-1?MI:FI}function jI(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=NI(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function BI(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function DI(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&typeof i[0]<"u"&&(i[0]!==""&&(t.width=parseInt(i[0],10)),typeof i[1]<"u"&&i[1]!==""?(t.height=parseInt(i[1],10),t.version=2):t.version=3),t}function UI(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function Ub(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],o=i[4];if(o[0]==="/"&&(o=o.substring(1)),t.length>0){if(t[0]==="/"&&(t=t.substring(1)),t!==o.substring(0,t.length))throw new Error(`Path does not start with prefix (path: ${o}, prefix: ${t})`);o=o.substring(t.length)}return{scheme:r,server:n,path:o,prefix:t}}function WI(e,t=""){let{path:i,scheme:r,server:n,prefix:o}=Ub(e,t),l=(i||"").split("/").reverse(),[u,h,g,f,...y]=l,S=y.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:o,identifier:S};if(u==="info.json"){let[,..._]=l;return{type:"info",scheme:r,server:n,prefix:o,identifier:_.reverse().filter(Boolean).join("/")}}let C=(u||"").split(".");if(typeof C[1]>"u"||typeof C[0]>"u"||typeof f>"u"||typeof g>"u"||typeof h>"u")throw new Error("Invalid image request");return{type:"image",scheme:r,server:n,prefix:o,identifier:S,originalPath:i,region:BI(f),size:DI(g),rotation:UI(h),quality:C[0],format:C[1]}}function HI(e){let t=WI(yn(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=jI(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function qI(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];if(l){let u=l.width;n.push(e/u)}}return n}function QI(e,t,i){let r=i.length,n=[];for(let o=0;o<r;o++){let l=i[o];l&&n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function Nt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function kl(e){if(!e||!e.profile||!Nt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&$I.indexOf(i)!==-1)return!0;return!1}function VI(e){if(!kl(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(Db.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function Al(e,t){if(t&&t.profile){let i=t.profile;if(i){let r=Array.isArray(i)?i:[i];return r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function $h(e){return kl(e)?Al(0,e)?0:Al(1,e)?1:Al(2,e)?2:null:null}function Wb(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function GI(e){if(!VI(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let o=i[n];if(o&&typeof o!="string"&&(o.maxHeight||o.maxWidth))return[{id:Nt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:o.maxHeight||o.maxWidth,maxWidth:o.maxWidth||o.maxHeight,level:$h(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let n=e.tiles.length;for(let o=0;o<n;o++){let l=e.tiles[o];l&&(l.height||l.width)&&t.push({id:Nt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width,level:$h(e),version:Wb(e)?3:2})}}return t}function Hb(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i&&i[4]&&i[5]){let r=i[1],n=parseInt(i[4],10),o=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&o&&l)return{type:"fixed",id:e,height:o,width:n}}return{type:"unknown",id:e}}function YI(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function XI(e){if(typeof e=="string")return Hb(e);let t=YI(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=Nt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Hb(r):null}function ZI(e){return kl(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:Nt(e),type:"fixed-service",height:t.height,width:t.width,level:$h(e),version:Wb(e)?3:2})):[]}function qb(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=e[r];if(!n)continue;let o=ZI(n);o.length&&t.push(...o);let l=GI(n);l.length&&t.push(...l)}return t}function Qb(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)kl(t[n])&&r.push(t[n]);return r}function KI(e,t=!0,i){let r=[],n=XI(e);if(n===null)return r;let o=e;if(r.push(n),t&&o&&o.width&&o.height){let l=[],u=Qb(o);for(let h of u){let g={id:Nt(h),width:o.width,height:o.height};if(i.canLoadSync(g)){let f=i.loadServiceSync(g);f&&(f.height||(f.height=o.height),f.width||(f.width=o.width),l.push(...qb([f])))}}if(l.length)return r.push(...l),r}return o.service&&r.push(...qb(o.service)),r}function JI({x:e=0,y:t=0,w:i,h:r,full:n,square:o,percent:l}){if(n)return"full";if(o)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let u=`${e},${t},${i},${r}`;return l?`pct:${u}`:u}function eR({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:o,serialiseAsFull:l,version:u}){let h=[];return i&&h.push("^"),e?(h.push(l?"full":"max"),h.join("")):(r&&h.push("!"),t&&h.push(`pct:${t}`),n&&h.push(`${n}`),h.push(","),o&&u===3&&h.push(`${o}`),h.join(""))}function tR(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function Vb(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if(e.type==="base")return r;if(e.type==="info")return`${r}/info.json`;let{size:n}=e,{region:o,rotation:l,format:u,quality:h}=e;if(t){let g=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],f=t.profile,y=g.indexOf("http://iiif.io/api/image/2/context.json")!==-1||f==="level2",S=g.indexOf("http://iiif.io/api/image/3/context.json")!==-1;if((n.width===t.width&&!n.height||n.height===t.height&&!n.width||n.width===t.width&&n.height===t.height)&&(n=D(A({},n),{max:!0})),y&&(n.max&&!n.serialiseAsFull&&(n=D(A({},n),{serialiseAsFull:!0})),!n.max&&n.width&&n.height&&(n=D(A({},n),{height:void 0})),n=D(A({},n),{version:2})),S){if(n.max&&n.serialiseAsFull&&(n=D(A({},n),{serialiseAsFull:!1})),n.width&&!n.height&&t.width&&t.height){let C=t.height/t.width;n=D(A({},n),{height:Math.ceil(n.width*C)})}n=D(A({},n),{version:3})}}return[r,JI(o),eR(n),tR(l),`${h}.${u}`].filter(Boolean).join("/")}function Fh(e,t,i){let r=HI({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:yn(Nt(e)),profile:e.level===null||typeof e.level>"u"?"level0":`level${e.level}`,type:e.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=t,r.size.height=i,{id:Vb(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Ws(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function iR(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function rR(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=(f,y=0)=>r.explain?i.push(new Array(y).fill(0).map(S=>"    ").join("")+f().trim()):void 0,o=[],l=[],u=null;n(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let h=(f,y)=>{if(n(()=>"Swapping choice",3),iR(r,y,f)){if(r.preferFixedSize&&f.unsafe){n(()=>`We found an image that was marked as unsafe, but it was the best size. (${f.id})`,4),l.push(f);return}r.returnAllOptions&&y&&l.push(y),n(()=>`We found a new image that was the best size. (${f.id})`,4),u=f}else r.returnAllOptions&&l.push(f)};n(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let g=t.length;for(let f=0;f<g;f++){let y=t[f]();n(()=>`Candidate group ${f}: ${JSON.stringify(y,null,2)}`,1);let S=y.length;n(()=>`Checking candidate list number ${f} and found ${S} potential ways of creating image(s)`,1);for(let C=0;C<S;C++){let _=y[C];if(n(()=>`-> Checking candidate ${C}`,1),_.type==="unknown"&&r.atAnyCost&&(n(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),o.push(_)),_.type==="fixed"&&(_.unsafe?(n(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),o.push(_)):(n(()=>"We've found a fixed size image, checking if it matches the request",2),h(_,u))),_.type==="fixed-service")if(r.unsafeImageService){n(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let T=Fh(_,r.width,r.height);h(T,u)}else{n(()=>"Checking for an image from the tile source 3",2);let T=Fh(_,_.width,_.height);h(T,u)}if(_.type==="variable"&&_.maxWidth){let T=Fh({id:_.id,width:_.maxWidth,height:_.maxWidth,level:_.level,version:_.version},_.maxWidth);h(T,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;n(()=>`We found a match in choice list number ${f}, no searching any more`);break}}return r.atAnyCost&&l.length===0?(n(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||o[0]||null,fallback:o.slice(1),log:i}):r.returnAllOptions?(n(()=>"Returning all options that we have found"),{best:(r.atAnyCost?u||l[0]||o[0]:u||l[0])||null,fallback:[...l,...o],log:i}):(n(()=>"Returning the best image that we found, and a fallback"),{best:u||l[0]||null,fallback:u?l:l.slice(1),log:i})}function nR(e,t,i){let r=e>t?e:t,n=i.length,o=[];for(let l=0;l<n;l++){let u=i[l];if(!u||u.scaleFactors.length===0)continue;let h=u.scaleFactors[0];if(!h)continue;let g=r/h,f=[h];for(;g>=u.width;)h=h*2,f.push(h),g=g/2;o.push(D(A({},u),{scaleFactors:f}))}return o}function sR(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let o=0;o<i;o++){let l=e[o],u=t[o];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++)if(e[o].width===t[l].width&&e[o].height===t[l].height){n++;break}return n===i}function Gb(e){return Al(0,e)}var Yb=class{constructor(e={}){Cl(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),Cl(this,"fetchingCount",0),Cl(this,"imageServices",{}),Cl(this,"knownImageServers",{}),this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Ws(Nt(e)),n=yn(Nt(e)),o=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!o&&e.tiles&&!Gb(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Nt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:qI(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Ws(Nt(e)),o=this.knownImageServers[n],l=yn(Nt(e));return this.imageServices[l]?this.imageServices[l]||null:!this.config.approximateServices||!o||!o.result||!(r!=null&&r.height||e.height)||!(r!=null&&r.width||e.width)||!i&&(o.malformed||o.verifications<this.config.verificationsRequired)||Gb(e.source)?null:(this.imageServices[l]||(this.imageServices[l]={"@context":o.result.context,"@id":Nt(e),id:Nt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||nR(e.width,e.height,o.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||QI(Math.round(e.width/o.result.resourceServiceRatio),Math.round(e.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(r==null?void 0:r.profile)||o.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l]||null)}async getThumbnailFromResource(e,t,i=!0,r=[]){let n=e?await this.getImageCandidates(e,i):[];return rR(t,[()=>r,()=>n])}async getImageCandidates(e,t=!0){let i=e;if(t&&i&&i.height&&i.width){let r=Qb(i);for(let n of r){let o={id:Nt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};await this.loadService(o)}}return KI(e,t,this)}async verify(e){let t=this.predict(e,!1,!0),i=await this.fetchService(Nt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&sR(t.sizes||[],i.sizes||[]);if(r){let n=Ws(Nt(e)),o=this.knownImageServers[n];o&&(o.verifications+=1,o.verifications>=this.config.verificationsRequired&&(o.verified=!0))}return r}canLoadSync(e){let t=typeof e=="string"?e:Nt(e),i=yn(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Ws(t)];return!!(r&&!r.malformed&&r.verifications>=this.config.verificationsRequired)}async markAsMalformed(e){return this.knownImageServers[Ws(Nt(e))].malformed=!0,this.loadService(e,!0)}async fetchService(e,t=!1){let i=yn(e),r=this.imageServices[i];if(r&&(!t||r.real))return r;if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let n=await this.fetch(i).then(o=>o.json());return!n.id&&n["@id"]&&(n.id=n["@id"]),n.id!==e&&(n.id=e,n["@id"]&&(n["@id"]=e)),this.imageServices[i]=Object.assign(n,{real:!0}),this.imageServices[i]}async fetch(e,t){return fetch(e,t)}async loadService(e,t=!1){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(o=>setTimeout(o,500));else{n=!1;break}}let i=this.knownImageServers[Ws(Nt(e))];if(i&&!i.malformed&&!t){await i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=await this.fetchService(Nt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}loadServiceSync(e){let t=yn(Nt(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}};new Yb;var aR=e=>{var t=e,{height:i,tiles:r,width:n,x:o,y:l,style:u,skipSizes:h=!1,skipThumbnail:g=!1,rotation:f=0,useFloorCalc:y=!1,viewport:S,tileFormat:C,children:_}=t,T=oe(t,["height","tiles","width","x","y","style","skipSizes","skipThumbnail","rotation","useFloorCalc","viewport","tileFormat","children"]);let R=n/r.width,O=r.imageService.tiles||[],E=r.imageService.sizes||[],F=r.imageService.id||r.imageService["@id"],z=Ae(()=>{let H=F;return H&&H.endsWith("/info.json")?H.slice(0,-10):H},[F]),U=u&&typeof u.opacity<"u"&&u.opacity!==1;return $(Hs,A({key:z,scale:R,height:r.height,width:r.width,x:o,rotation:f,y:l},T),$(oR,{key:"composite-"+z,id:z,width:r.width,height:r.height,renderOptions:U?{renderLayers:1,renderSmallestFallback:!1}:S?{renderLayers:1,renderSmallestFallback:!0}:{renderLayers:2,renderSmallestFallback:!0}},_,r.thumbnail&&!U&&!g?$(Fa,{uri:r.thumbnail.id,target:{width:r.width,height:r.height},display:{width:r.thumbnail.width,height:r.thumbnail.height},style:u}):null,h?null:E.map((H,G)=>{let{prefix:V,server:le,scheme:q,path:ne}=Ub(z);return $(Fa,{key:G,uri:Vb({scheme:q,server:le,prefix:V,identifier:ne,type:"image",region:{full:!0},size:{max:!1,upscaled:!1,confined:!1,width:H.width,height:H.height},rotation:{angle:0,mirror:!1},format:"jpg",quality:"default"},r.imageService),target:{width:r.width,height:r.height},display:{width:H.width,height:H.height},style:u})}),O.map(H=>(H.scaleFactors||[]).map(G=>$(lR,{key:`${H}-${G}`,uri:z,display:{width:r.width,height:r.height},tile:H,scaleFactor:G,style:u,format:C,useFloorCalc:y})))))};vn({displayName:"Atlas.World",component:ln,customConstructor:e=>new ln(e.width,e.height)});var Hs=vn({displayName:"Atlas.WorldObject",component:Os}),Xb=vn({displayName:"Atlas.Box",component:$s}),Fa=vn({displayName:"Atlas.SingleImage",component:ur});vn({displayName:"Atlas.ImageTexture",component:So});var oR=vn({displayName:"Atlas.CompositeResource",component:wc,customConstructor:e=>new wc({id:e.id,width:e.width,height:e.height,images:[],renderOptions:e.renderOptions})}),lR=vn({displayName:"Atlas.TiledImage",component:on,customConstructor:e=>on.fromTile(e.uri,e.display,e.tile,e.scaleFactor,void 0,e.format,e.useFloorCalc)});vn({displayName:"Atlas.Text",component:_a}),Xe(),Qe(),Xe(),Qe(),Qe(),Qe(),Xe(),Qe();var Mh=li((e,t)=>{var i=e,{children:r}=i,n=oe(i,["children"]);let o=ke(),l=hn(),u=ke(0),h=ke(),[g,f]=ws(y=>y+1,0);return Bc(()=>{if(n.relative){let y=o.current;if(y&&l){let S=l.getScaleFactor();u.current!==S&&(u.current=S,y.style.transformOrigin="0 0",y.style.transform=`scale(${1/u.current})`,y.style.width=`${u.current*100}%`,y.style.height=`${u.current*100}%`)}}},[n.relative]),Tt(()=>{let y=h.current;if(!y){let S=setTimeout(f,100);return()=>{clearTimeout(S)}}return t&&y&&(typeof t=="function"?t(y):t.current=y),y&&y.__host?n.relative?Ss($("div",{ref:o},r),y.__host.element):Ss(r,y.__host.element):y&&(y.__onCreate=()=>{n.relative?Ss($("div",{ref:o},r),y.__host.element):Ss(r,y.__host.element)}),()=>{}},[g,t,r,h,n.relative]),$(Xb,A({html:!0,ref:h},n))});Xe();var uR=e=>{var t=e,{handleSize:i=9,resizable:r,onSave:n,children:o}=t,l=oe(t,["handleSize","resizable","onSave","children"]);let{portalRef:u,mode:h,mouseEvent:g,isEditing:f}=_C({x:l.x||0,y:l.y||0,width:l.width,height:l.height},n),y=Ae(()=>g("translate"),[g]),S=Ae(()=>g("east"),[g]),C=Ae(()=>g("west"),[g]),_=Ae(()=>g("south"),[g]),T=Ae(()=>g("north"),[g]),R=Ae(()=>g("south-east"),[g]),O=Ae(()=>g("south-west"),[g]),E=Ae(()=>g("north-east"),[g]),F=Ae(()=>g("north-west"),[g]);return $(Je,null,$(Hs,A({},l),o,$(Mh,{ref:u,target:{x:0,y:0,height:l.height,width:l.width},relative:!0,interactive:!1},h==="sketch"&&r?$(Je,null,$("div",{onMouseDown:y,onTouchStart:y,style:{display:"block",width:"100%",height:"100%",border:"1px dashed #999",boxSizing:"border-box",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"east",onTouchStart:S,onMouseDown:S,style:{cursor:"e-resize",position:"absolute",background:"#fff",height:i*2,width:i,right:0,top:"50%",transform:`translate(${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"west",onMouseDown:C,style:{cursor:"w-resize",position:"absolute",background:"#fff",height:i*2,width:i,left:0,top:"50%",transform:`translate(-${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"north",onMouseDown:T,style:{cursor:"n-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",top:0,transform:`translate(-${i}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid rgba(0,0,0,.5)",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"south",onMouseDown:_,style:{cursor:"s-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",bottom:0,transform:`translate(-${i}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"north-east",onMouseDown:E,style:{cursor:"ne-resize",position:"absolute",background:"#fff",height:i,width:i,right:0,top:0,transform:`translate(${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"south-east",onMouseDown:R,style:{cursor:"se-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,right:0,transform:`translate(${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"south-west",onMouseDown:O,style:{cursor:"sw-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,left:0,transform:`translate(-${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}}),$("div",{title:"north-west",onMouseDown:F,style:{cursor:"nw-resize",position:"absolute",background:"#fff",height:i,width:i,top:0,left:0,transform:`translate(-${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:f?"none":h==="sketch"?"initial":"none"}})):null)))};Xe();var Ma=e=>{var t=e,{children:i,interactive:r,region:n,onClick:o,onSave:l,isEditing:u,className:h,style:g}=t,f=oe(t,["children","interactive","region","onClick","onSave","isEditing","className","style"]);let y=Oc(),S=typeof r>"u"?typeof o=="function":r,C=Ue(_=>{l&&l(A({id:n.id,x:n.x,y:n.y,height:n.height,width:n.width},_))},[l,n.id,n.x,n.y,n.height,n.width]);return $(uR,{x:n.x,y:n.y,width:n.width,height:n.height,resizable:u,onSave:C,onClick:y==="explore"&&o?_=>{o(n)}:()=>{}},$(Xb,A({html:!0,className:h,interactive:S,relativeStyle:!0,target:{x:0,y:0,width:n.width,height:n.height},style:g},f)),i)};Xe(),Qe(),Xe();function Zb({annotationId:e,interactive:t,relative:i}){var r;let n=hh({id:e}),o={fill:"rgba(0,0,0,0)"},l={fill:"rgba(0,0,0,0)"};if(!((r=n==null?void 0:n.motivation)!=null&&r.includes("supplementing"))||!n.body)return null;let u=(Array.isArray(n.body)?n.body:[n.body]).filter(g=>g.type==="TextualBody"),h=n.target.selector;return h?$(Je,null,$("rect",{x:i?0:h.spatial.x,y:i?0:h.spatial.y,width:h.spatial.width,height:h.spatial.height,style:l}),$("text",{x:i?0:h.spatial.x,y:(i?0:h.spatial.y)+h.spatial.height*.75,textLength:h.spatial.width,fontSize:`${h.spatial.height}px`,lengthAdjust:"spacingAndGlyphs",className:"text-line-segment",part:"text-line-segment",style:D(A({},o),{pointerEvents:t?"initial":void 0})},u[0].value||"")):null}function cR({annotation:e,textSelectionEnabled:t}){var i;let r=Mt();return!((i=e==null?void 0:e.motivation)!=null&&i.includes("supplementing"))||!e.body?null:$(Mh,{target:D(A({},e.target.selector.spatial),{x:0,y:0}),interactive:t},$(pn,{vault:r},$("svg",{height:e.target.selector.spatial.height,width:e.target.selector.spatial.width,style:{userSelect:t?"text":void 0}},$(Zb,{annotationId:e.id,interactive:t,relative:!0}))))}var hR=({id:e,style:t,className:i,interactive:r,textSelectionEnabled:n})=>{let o=hh({id:e}),l=Zn(o,"atlas"),u=Zn(o,"html"),h=vl(o,["atlas"]),g=mn(),f=Ae(()=>tm(t,l),[t,l]);return g&&o&&o.target&&o.target.selector&&o.target.selector.type==="BoxSelector"&&o.target.source&&o.target.source.id===g.id?$(Ma,A({id:o.id,isEditing:!0,region:o.target.selector.spatial,style:f,className:(u==null?void 0:u.className)||i,interactive:!!(u!=null&&u.href||r),href:(u==null?void 0:u.href)||null,title:(u==null?void 0:u.title)||null,hrefTarget:(u==null?void 0:u.target)||null},h),$(cR,{annotation:o,textSelectionEnabled:n})):null},Kb=({className:e,page:t,textSelectionEnabled:i})=>{var r;let n=Zn(t,"atlas"),o=Zn(t,"html");return xi(l=>t.id?l.iiif.entities.AnnotationPage[t.id]:null,[]),$(Je,null,(r=t.items)==null?void 0:r.map(l=>$(hR,{key:l.id,id:l.id,style:n,className:(o==null?void 0:o.className)||e,textSelectionEnabled:i})))};Xe(),Qe();function dR(){let e=hn(),[t,i]=ze(),[r,n]=ze();return Bc(()=>{e&&(!t||e.focalPosition[1]!==t[1]||e.focalPosition[2]!==t[2]||e.focalPosition[3]!==t[3]||e.focalPosition[4]!==t[4])&&i(new Float32Array(e.focalPosition)),e&&(!r||e.homePosition[1]!==r[1]||e.homePosition[2]!==r[2]||e.homePosition[3]!==r[3]||e.homePosition[4]!==r[4])&&n(new Float32Array(e.homePosition))},[t,r]),$(Je,null,t?$(Ma,{id:"focal",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"focal",x:t[1],y:t[2],width:t[3]-t[1],height:t[4]-t[2]},style:{backgroundColor:"rgba(0, 0, 244, 0.5)"}}):null,r?$(Ma,{id:"home",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"home",x:r[1],y:r[2],width:r[3]-r[1],height:r[4]-r[2]},style:{backgroundColor:"rgba(0, 200, 0, 0.5)"}}):null)}Qe(),Xe();function fR(e,t){let i=yn(e.id||e["@id"]||"").slice(0,-10);return!i||t.percentScale||!t.width||t.confined||!e.height||!e.width?[null,{height:0,width:0}]:[[i,"full",bT(t),"0","default.jpg"].join("/"),{width:t.width||1,height:t.confined?e.height/e.width*t.width:t.height||e.height/e.width*t.width}]}Qe(),Qe();function Jb({id:e,image:t,thumbnail:i,isStatic:r,virtualSizes:n=[],x:o=0,y:l=0,rotation:u=0,annotations:h,tileFormat:g,skipSizes:f,annotationId:y,skipThumbnail:S,useFloorCalc:C}){var _,T,R,O;let E=Zn(y?{id:y,type:"Annotation"}:void 0,"atlas"),F=Zn({id:e,type:"ContentResource"},"atlas"),z=Ae(()=>A(A({},E),F),[E,F]),U=vl(y?{id:y,type:"Annotation"}:void 0,["atlas"]),H=vl({id:e,type:"ContentResource"},["atlas"]);return $(J.Fragment,null,t.service?$(Je,{key:"service"},$(aR,A(A({viewport:r,tiles:{id:t.service.id,height:t.height!==t.service.height&&t.service.height!==void 0?t.service.height:t.height,width:t.width!==t.service.width&&t.service.width!==void 0?t.service.width:t.width,imageService:t.service,thumbnail:!S&&i&&i.type==="fixed"?i:void 0},skipSizes:f,skipThumbnail:S,x:((_=t.target)==null?void 0:_.spatial.x)+o,y:((T=t.target)==null?void 0:T.spatial.y)+l,rotation:u,useFloorCalc:C,width:(R=t.target)==null?void 0:R.spatial.width,height:(O=t.target)==null?void 0:O.spatial.height,style:z,tileFormat:g},U),H),t.service&&n.map(G=>{if(t.service){let[V,{height:le,width:q}]=fR(t.service,G);return V?$(Fa,{priority:!0,style:z,key:V,uri:V,target:t.target.spatial,display:{height:le,width:q}}):null}return null})),h):$(Je,{key:"no-service"},$(Fa,A(A({style:z,uri:t.id,target:t.target.spatial,display:t.width&&t.height?{width:t.width,height:t.height}:void 0},U),H)),h))}Xe(),Qe();function pR(){let[e,{addAnnotation:t,removeAnnotation:i}]=IP(),r=Mt(),n=mT(),o=ke([]),l=e==null?void 0:e.id,u=Ae(()=>mh(r),[r]);return $a(()=>({annotations:{add(h){t(h)},get(h){if(l){let g=(r.get({id:l,type:"AnnotationPage"}).items||[]).find(f=>f.id===h);return g?r.get(g):null}return null},getSource(h){return o.current[h]||null},getAll(){if(l){let h=r.get({id:l,type:"AnnotationPage"});return h?r.get(h.items)||[]:[]}return[]},remove(h){i(h)},applyStyles(h){l&&n.applyStyles(l,"atlas",h)},addEventListener(h,g){if(l)return u.addEventListener({id:l,type:"AnnotationPage"},h,g)},applyHTMLProperties(h){l&&n.applyStyles(l,"html",h)}}}),l),[e,{addAnnotation:t,removeAnnotation:i}]}Qe();var e0=Kt(null);function gR(){let e=Yt(e0);return[e.fullPage,{addAnnotation:e.addAnnotation,removeAnnotation:e.removeAnnotation}]}function t0({children:e}){let[t,{addAnnotation:i,removeAnnotation:r}]=pR();return $(e0.Provider,{value:Ae(()=>({fullPage:t,addAnnotation:i,removeAnnotation:r}),[t])},e)}Xe();function mR({media:e,children:t}){let[{element:i,currentTime:r,progress:n},o,l]=oy({duration:e.duration});return $a(u=>(u.mediaActions=l,u.mediaElement=i,u.setMediaProgressElement=h=>{n.current=h},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),$(hT,{state:o,actions:l,currentTime:r,progress:n,element:i},$("video",{ref:i,src:e.url}),t)}Xe();function vR({media:e}){let[{element:t,currentTime:i,progress:r},n,o]=oy({duration:e.duration}),l=o.playPause;return $a(u=>(u.mediaActions=o,u.mediaElement=t,u.setMediaProgressElement=h=>{r.current=h},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),$("div",{className:"video-container",part:"video-container",onClick:l},$("style",null,`
            .video-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `),$("video",{ref:t,src:e.url,style:{width:"100%",objectFit:"contain"}}))}Xe();function yR({annotationPageId:e,selectionEnabled:t}){let i=gT({id:e}),r=mn(),n=Mt(),o=Zn(i,"text-lines");return!i||!i.items||!r?null:$(Hs,A({},{x:0,y:0,width:r.width,height:r.height}),$(Mh,{target:{x:0,y:0,width:r.width,height:r.height}},$(pn,{vault:n},$("svg",{tabindex:0,"aria-name":"","aria-live":"off","aria-atomic":"true","aria-relevant":"all","aria-expanded":"true",role:"article",style:D(A({},o),{userSelect:"text"}),width:r.width,height:r.height},i.items.map(l=>$(Zb,{key:`line-${l.id}`,annotationId:l.id,interactive:t}))))))}function bR(e,t){let i=[],r={};for(let n of e){let o={},l=[],u=t.get(n),h=(u==null?void 0:u.items)||[];for(let g of h){let f=t.get(g);if(f.motivation)for(let y of f.motivation)l.includes(y)||l.push(y),o[y]=o[y]?o[y]:[],o[y].push(f.id)}i.push({typeMap:o,allTypes:l,id:n});for(let g of l)r[g]=r[g]||[],r[g].push(n)}return{pagesWithTypes:i,pageMapping:r}}function i0({x:e,y:t,highlight:i,annoMode:r,onCreated:n,debug:o,virtualSizes:l,highlightCssClass:u,defaultChoices:h,isStatic:g,textSelectionEnabled:f,textEnabled:y,disableThumbnail:S,skipSizes:C,rotation:_,useFloorCalc:T}){var R;let O=gn(),E=mn(),F=vl(E,["deep-zoom"]),[z]=gR(),U=Mt(),H=Ae(()=>vh(U),[U]),[G,V]=tT({strategies:["images","media"],defaultChoices:h==null?void 0:h.map(({id:me})=>me)}),le=fh((O==null?void 0:O.id)||(E==null?void 0:E.id)),q=xi((me,ce)=>le.availablePageIds.map(We=>ce.get(We)),[...le.availablePageIds]);fe(()=>{let me=U2(U);if(E!=null&&E.id){let ce=(h==null?void 0:h.map(({id:ee})=>ee))||[],We=me.getAllPaintingAnnotations(E.id);for(let ee of We){if(ee.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let Pe=Array.from(Array.isArray(ee.body)?ee.body:[ee.body]);for(let Oe of Pe){let[Ge,{selector:ut}]=iy(Oe),K=U.get(Ge);if((K.type||"unknown").toLowerCase()!=="choice")continue;let Ce=U.get(K.items),dt=ce.length?ce.map(Et=>Ce.find(Ri=>Ri.id===Et)).filter(Boolean):[Ce[0]];dt.length===0&&dt.push(Ce[0]);let pt={type:"single-choice",items:Ce.map(Et=>({id:Et.id,label:Et.label,selected:dt.indexOf(Et)!==-1})),label:Ge.label};es.emit("onChoiceChange",{choice:pt,partOf:{canvasId:E.id,choiceId:K.id,manifestId:O==null?void 0:O.id}})}}me.extractChoices(E.id)}},[E==null?void 0:E.id,V,h]);let ne=Ae(()=>bR(le.availablePageIds,U),q),ge=(R=ne.pageMapping.supplementing)!=null&&R.length?ne.pageMapping.supplementing[0]:null;fe(()=>{let me=es.on("onMakeChoice",ce=>{V.makeChoice(ce.id,ce.options)});return()=>{me()}},[V]),fe(()=>{if(y){let me=[];for(let ce of le.availablePageIds)U.requestStatus(ce)||me.push(U.load(ce))}},[E==null?void 0:E.id,y]),fe(()=>{if(h)for(let me of h)typeof me.opacity<"u"&&H.applyStyles({id:me.id},"atlas",{opacity:me.opacity})},[h]);let de=nT({maxWidth:256,maxHeight:256});if(!E)return null;if(G.type==="media"){if(G.media.type!=="Sound"&&G.media.type!=="Video")throw new Error("Unknown media type");return $(Hs,A({key:G.type,height:E.height||1e3,width:E.width||1e3,x:e,y:t},F),G.media.type==="Sound"?$(mR,{media:G.media}):null,G.media.type==="Video"?$(vR,{media:G.media}):null)}if(G.type==="unknown"){if(de&&de.type==="fixed")return $(Hs,{height:E.height,width:E.width,x:e,y:t},$(Fa,{uri:de.id,target:{x:0,y:0,width:E.width,height:E.height},display:de.width&&de.height?{width:de.width,height:de.height}:void 0}));throw new Error("Unknown image strategy")}let we=$(Je,null,r?$(Kg,{onCreate:me=>{n&&n(me)}}):null,i&&i.selector&&i.selector.type==="BoxSelector"?$(Ma,{id:"highlight",isEditing:!0,onClick:()=>{},onSave:()=>{},region:i.selector.spatial,style:u?void 0:{border:"3px solid red"},className:u}):null,z?$(Kb,{page:z,textSelectionEnabled:f}):null,G.annotations&&G.annotations.pages?G.annotations.pages.map(me=>$(Kb,{key:me.id,page:me,textSelectionEnabled:f})):null,o?$(dR,null):null,y&&ge?$(yR,{annotationPageId:ge,selectionEnabled:f}):null);return $(Hs,A({key:G.type,height:E.height,width:E.width,x:e,y:t},F),G.type==="images"?G.images.map((me,ce)=>$(Jb,{isStatic:g,key:me.id,image:me,id:me.id,rotation:_,annotationId:me.annotationId,thumbnail:ce===0&&!S?de:void 0,virtualSizes:l,annotations:we,skipSizes:C,skipThumbnail:S,useFloorCalc:T})):null)}Qe(),Xe(),Qe();function Pl({error:e,resetErrorBoundary:t,aspectRatio:i,height:r=512,width:n}){let o=i?{paddingTop:`${i*100}%`}:{height:r,width:n};return fe(()=>{console.error(e),fb.emit("onErrorEvent",{message:e==null?void 0:e.message,error:e})},[e]),$("slot",{name:"fallback"},$("div",{role:"alert",style:A({background:"#000",color:"#fff",display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",fontFamily:"monospace"},o)},$("div",{style:{padding:"1em",textAlign:"center"}},$("img",{className:"img-oops",part:"image-oops",width:33,height:24,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAICAYAAAAvOAWIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAC6ADAAQAAAABAAAACAAAAADGHiDWAAAAO0lEQVQYGWP4DwQMQACjQWxkABOH0TgVwjRhKIQLwFRAaZg4jEaTphKXEWYOPmsYgQCmjnQPwnXiYQAAP/M3zvinPKAAAAAASUVORK5CYII="}),$("h2",null,"Unable to load image"),$("pre",null,e==null?void 0:e.message),t?$("button",{style:{color:"#fff",border:"2px solid #fff",background:"#000",fontFamily:"monospace",padding:"0.25em 1em"},onClick:t},"Try again"):null,$("style",null,".img-oops { border: 3px solid white; padding: 15px; image-rendering: auto; image-rendering: crisp-edges; image-rendering: pixelated; margin-bottom: 10px; }"))))}function wR(e,t){var i=e,{unit:r}=i,n=oe(i,["unit"]);return r==="percent"?{x:t.width*(n.x/100),y:t.height*(n.y/100),width:t.width*(n.width/100),height:t.height*(n.height/100)}:n}Xe(),Qe();var xR=oh;function _R(e){let t=Vv(),i=aP(),r=uh(),n=ke(!1),o=ke();$a(h=>(o.current=h,h.sequence=i,n.current||(n.current=!0,h.dispatchEvent(new CustomEvent("sequence",{detail:i}))),{}),[i]),fe(()=>{o.current&&(es.emit("onResetSeen"),o.current.dispatchEvent(new CustomEvent("sequence-change",{detail:{index:i.currentSequenceIndex,total:i.sequence.length}})))},[i.currentSequenceIndex,r]);let l=0,u=t.map((h,g)=>{let f=l;return l+=h.width+(e.margin||0),$(xR,{key:h.id,canvas:h.id},$(i0,D(A({key:h.id},e),{x:f})))});return $(Je,null,u)}var SR=wI.ErrorBoundary;function r0(e){let t=Mt(),i=Xn(),r=mn(),n=gn(),o=fh((n==null?void 0:n.id)||(r==null?void 0:r.id)),[l,u]=ze(!1),h=e.rotation||0,g=!e.displayOptions.viewport&&r?e.displayOptions.homePosition?e.displayOptions.homePosition.width/e.displayOptions.homePosition.height:r.width/r.height:void 0;$a(_=>o?(_.annotationPageManager||(_.annotationPageManager={}),_.annotationPageManager.availablePageIds=o.availablePageIds,_.annotationPageManager.enabledPageIds=o.enabledPageIds,_.annotationPageManager.setPageEnabled=o.setPageEnabled,_.annotationPageManager.setPageDisabled=o.setPageDisabled,{}):{},[o.availablePageIds,o.enabledPageIds,o.setPageEnabled,o.setPageDisabled].join("/")),Tt(()=>{e.followAnnotations!==!1&&o.availablePageIds.map(_=>{t.requestStatus(_)||t.load(_)})},[o.availablePageIds,e.followAnnotations]),xi(_=>i.canvas?_.iiif.entities.Canvas[i.canvas]:null,[]);let[f,y]=Ae(()=>{let _=e.displayOptions,{width:T,height:R,homePosition:O,containerProps:E}=_,F=oe(_,["width","height","homePosition","containerProps"]),z=e.displayOptions.homePosition&&r?wR(e.displayOptions.homePosition,r):null;return z&&(F.homePosition=z),T&&(F.width=T),R&&(F.height=R),[F,E]},[e.displayOptions,r]),S=_=>{_.altKey&&_.code==="KeyB"&&u(!0)},C=e.renderMultiple?_R:i0;return $(SR,{fallbackRender:_=>$(Pl,A({height:f.height,width:f.width,aspectRatio:g},_))},$(Lh,D(A({key:e.renderMultiple?"":r==null?void 0:r.id,aspectRatio:g,containerProps:A({onKeyDown:S},y||{}),className:e.className,background:e.background},f),{mode:l?"sketch":e.mode,homeCover:e.homeCover,homeOnResize:!!e.homeCover}),$(C,{isStatic:!e.interactive,debug:e.debug,virtualSizes:e.virtualSizes,highlight:e.highlight,highlightCssClass:e.highlightCssClass,annoMode:l,defaultChoices:e.defaultChoices,disableThumbnail:e.disableThumbnail,skipSizes:e.skipSizes,rotation:h,useFloorCalc:e.useFloorCalc,onCreated:_=>{n&&r&&_&&navigator.clipboard.writeText(xl({id:`${r.id}#xywh=${_.x},${_.y},${_.width},${_.height}`,type:"Canvas",partOf:[{id:n.id,type:"Manifest"}]})),u(!1)},x:e.x,y:e.y,textSelectionEnabled:e.textSelectionEnabled,textEnabled:e.textEnabled,margin:e.margin}),e.children))}Xe();function ER(e){return $("svg",A({width:"1em",height:"1em",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#000"},e),$("g",{transform:"translate(1 1)",strokeWidth:2,fill:"none",fillRule:"evenodd"},$("circle",{strokeOpacity:.5,cx:18,cy:18,r:18}),$("path",{d:"M36 18c0-9.94-8.06-18-18-18"},$("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"}))))}Xe(),Qe();var CR=({manifestId:e,children:t})=>{let{manifest:i,isLoaded:r,error:n}=gl(e,{});return fe(()=>{n&&console.error(n)},[n]),n?$(Pl,{error:new Error(`Unable to load Manifest: ${e} 
 
 ${n.toString()}`)}):!r||!i?$(ER,null):$(ml,{manifest:i.id},t)};Qe();var n0=["width","height","target","region","highlight","highlight-css-class","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","class","move-events","granular-move-events","a11y-title","a11y-role"],kR=[...n0,"manifest-id","canvas-id","choice-id","text-selection-enabled","disable-thumbnail","text-enabled","follow-annotations","iiif-content","home-cover","rotation","background"],AR=e=>{let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:o,setParsedTarget:l,highlight:u,highlightCssClass:h,virtualSizes:g,viewport:f,debug:y,mode:S,interactive:C,x:_,y:T,homeCover:R,className:O,inlineStyles:E,inlineStyleSheet:F,useProp:z,useRegisterWebComponentApi:U,setMode:H,background:G}=El(e),[V,le]=ze(void 0),q=ke([]),[ne,ge]=ze(),[de,,we]=z("iiifContent",{parse:Sl}),[me,ce,,We]=z("canvasId"),[ee,Pe,,Oe]=z("rotation",{parse:kr,defaultValue:0}),[Ge,ut,,K]=z("manifestId"),[Ce]=z("followAnnotations",{parse:ot,defaultValue:!0}),[dt,,,pt]=z("choiceId",{parse:CT}),[Et]=z("textSelectionEnabled",{parse:ot,defaultValue:!0}),[Ri]=z("disableThumbnail",{parse:ot,defaultValue:!1}),[cr]=z("skipSizes",{parse:ot,defaultValue:!1}),[hr]=z("textEnabled",{parse:ot,defaultValue:!1}),[Li]=z("useFloorCalc",{parse:ot,defaultValue:!1}),jt=de&&de.type!=="remote-content-state"?de:null,Zi=de&&de.type==="remote-content-state"?de.id:null,Wt=Ue(ue=>{i.current&&(es.emit("onResetSeen"),i.current.dispatchEvent(new CustomEvent("canvas-change",{detail:{canvas:ue}})))},[]),Qr=Ue(ue=>{if(V){let xe={id:`${me}#xywh=${wl(ue.x)},${wl(ue.y)},${ue.width},${ue.height}`,type:"Canvas",partOf:[{id:Ge,type:"Manifest"}]},Fe={contentState:xe,normalisedContentState:Bs(xe),encodedContentState:xl(xe),selection:{type:"BoxSelector",spatial:ue}};q.current.push(Fe),V(Fe)}},[V,Ge,me]);if(U(ue=>({vault:t,setCanvas:xe=>{ue.setAttribute("canvas-id",xe)},setManifest:xe=>{ue.setAttribute("manifest-id",xe)},setDefaultChoiceIds:xe=>{ue.setAttribute("choice-id",xe.join(","))},getDefaultChoiceIds(){return(pt.current||[]).map(({id:xe})=>xe)},getCanvasId(){return We.current},getContentState(){var xe,Fe,rt,Ct;let ii=K!=null&&K.current?K==null?void 0:K.current:Ge,Oi={id:`${We!=null&&We.current?We==null?void 0:We.current:me}#xywh=${(xe=r.current)==null?void 0:xe.x},${(Fe=r.current)==null?void 0:Fe.y},${(rt=r.current)==null?void 0:rt.width},${(Ct=r.current)==null?void 0:Ct.height}`,type:"Canvas",partOf:[{id:ii,type:"Manifest"}]};return{contentState:Oi,normalisedContentState:Bs(Oi),encodedContentState:xl(Oi)}},getPosition(){var xe,Fe,rt,Ct;return{x:(xe=r.current)==null?void 0:xe.x,y:(Fe=r.current)==null?void 0:Fe.y,width:(rt=r.current)==null?void 0:rt.width,height:(Ct=r.current)==null?void 0:Ct.height}},getManifestId(){return K.current},disableTextSelection(){ue.setAttribute("text-selection-enabled","false")},enableTextSelection(){ue.setAttribute("text-selection-enabled","true")},enableText(){ue.setAttribute("text-enabled","true")},disableText(){ue.setAttribute("text-enabled","true")},easingFunctions(){return Er},getContentStateStack(){return q.current},transition(xe){var Fe,rt;(Fe=r.current)!=null&&Fe.transitionManager&&xe((rt=r.current)==null?void 0:rt.transitionManager)},enableContentStateSelection(xe){H("sketch"),le(Fe=>Fe||xe)},disableContentStateSelection(){le(void 0),H("explore"),q.current=[]},setContentStateFromText(xe,Fe=!1){if(xe==null||xe.trim()==="")return;let rt=Bs(_l(xe));rt.immediate=Fe;let Ct=rt.target[0];We.current===Ct.source.id?r.current&&rt.target&&rt.target[0]&&rt.target[0].selector&&rt.target[0].selector.type==="BoxSelector"&&r.current.world.gotoRegion(D(A({},rt.target[0].selector.spatial),{immediate:Fe})):we(rt)}})),Tt(()=>{Zi&&!ne&&fetch(Zi).then(ue=>ue.json()).then(ue=>{we(Sl(ue))}).catch(ue=>{console.error(ue),ge(new Error(`Failed to load content state from ${Zi} 

 ${ue.toString()}`))})},[Zi,ne]),Tt(()=>{if(jt&&jt.target.length){let ue=jt.target[0];if(ue.type==="SpecificResource"&&ue.source.type==="Canvas"){let xe=(ue.source.partOf||[]).find(Fe=>Fe.type==="Manifest");if(ce(ue.source.id),xe&&ut(xe.id),ue.selector&&r.current&&i.current)if(ue.selector.type==="BoxSelector"){let{x:Fe,y:rt,width:Ct,height:ii}=ue.selector.spatial;r.current.world.gotoRegion({x:Fe,y:rt,width:Ct,height:ii,immediate:jt.immediate})}else l(ue)}}},[jt]),fe(()=>{Wt(me)},[me]),o)return null;if(ne)return $(Pl,{error:ne,resetErrorBoundary:()=>ge(null)});let Vr=me?$(oh,{canvas:me},$(r0,{key:`${me}-${f?"v1":"v0"}`,interactive:C,defaultChoices:dt,followAnnotations:Ce,className:O,highlight:u,debug:y,background:G,virtualSizes:g,highlightCssClass:h,canvasId:me,displayOptions:n,mode:S,rotation:ee||0,x:_,y:T,textEnabled:hr,textSelectionEnabled:Et,disableThumbnail:Ri,skipSizes:cr,homeCover:R,useFloorCalc:Li},$("slot",{name:"atlas"}),V?$(Kg,{onCreate:Qr}):null),$("slot",null)):null;return $(Oh.Provider,{value:e.__registerPublicApi},$(pn,{vault:t},$(t0,null,Ge?$(CR,{manifestId:Ge},Vr):Vr)),E?$("style",null,E):null,F?$("link",{rel:"stylesheet",href:F}):null)};typeof window<"u"&&On(AR,"canvas-panel",kR,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),Xe(),Qe();var PR=De(qf()),TR=PR.ErrorBoundary;function IR(e){let{atlasProps:t,isConfigBlocking:i,setIsReady:r,virtualSizes:n,height:o,width:l,className:u,inlineStyles:h,inlineStyleSheet:g,viewport:f,vault:y,useProp:S,interactive:C,x:_,y:T,homeCover:R,background:O,highlight:E,highlightCssClass:F}=El(e),[z]=S("src"),[U]=S("nested",{parse:ot}),[H]=S("rotation",{parse:kr}),[G,V]=S("tileFormat"),[le]=S("skipSizes",{parse:ot}),[q]=S("disableThumbnail",{parse:ot}),[ne,ge]=sy(),de=ge[z],we=Ae(()=>{let ce=ne({id:z},{});return ce&&ce.preferredFormats&&ce.preferredFormats.length===1&&V(ce.preferredFormats[0]),ce&&ce.height&&ce.width&&de!=="loading"?{id:z,width:ce.width,height:ce.height,service:ce,type:"Image",selector:{type:"BoxSelector",spatial:{x:0,y:0,width:ce.width,height:ce.height}},target:{type:"BoxSelector",spatial:{x:0,y:0,width:ce.width,height:ce.height}}}:null},[ne,z,ge]);if(!we||!we.height||!we.width||i)return null;let me=f?void 0:t.homePosition?t.homePosition.width/t.homePosition.height:we.width/we.height;return $(TR,{fallbackRender:ce=>$(Pl,A({height:o,width:l,aspectRatio:me},ce))},$(pn,{vault:y},$(Lh,A({onCreated:()=>{r(!0)},viewport:!0,aspectRatio:me,className:u,nested:U,homeCover:R,background:O,homeOnResize:!!R,rotation:H},t),$(Jb,{key:we.id,image:we,id:we.id,isStatic:!C,virtualSizes:n,skipSizes:le,skipThumbnail:q,x:_,y:T,rotation:H,tileFormat:G,annotations:E&&E.selector&&E.selector.type==="BoxSelector"?$(Ma,{id:"highlight",isEditing:!1,interactive:!1,onClick:()=>{},onSave:()=>{},region:E.selector.spatial,style:F?void 0:{border:"3px solid red"},className:F}):void 0}))),h?$("style",null,h):null,g?$("link",{rel:"stylesheet",href:g}):null,e.children?$("slot",null,e.children):null)}function RR(e){let t=Ae(()=>new Yb,[]);return $(ny.Provider,{value:t},$(IR,A({},e)))}typeof window<"u"&&On(RR,"image-service",["src","nested","x","y","width","height","target","region","highlight","highlight-css-class","text-selection-enabled","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","iiif-content","class","choice-id","move-events","granular-move-events","home-cover","tile-format","rotation","background"],{shadow:!0,onConstruct(e){e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),Xe(),Qe();var LR=[...n0,"manifest-id","range-id","start-canvas","paging-enabled","text-selection-enabled","text-enabled","follow-annotations","margin","background"];function OR(e){let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:o,highlight:l,highlightCssClass:u,virtualSizes:h,viewport:g,debug:f,mode:y,interactive:S,className:C,inlineStyles:_,inlineStyleSheet:T,useProp:R,useRegisterWebComponentApi:O,background:E}=El(e),[F,z,,U]=R("manifestId"),[H,,,G]=R("rangeId"),[V,le,,q]=R("startCanvas"),[ne]=R("margin",{parse:kr,defaultValue:0}),[ge]=R("pagingEnabled",{parse:ot,defaultValue:!0}),[de]=R("textSelectionEnabled",{parse:ot,defaultValue:!0}),[we]=R("textEnabled",{parse:ot,defaultValue:!1}),[me]=R("followAnnotations",{parse:ot,defaultValue:!0}),[ce,,We]=R("iiifContent",{parse:Sl}),ee=ce&&ce.type!=="remote-content-state"?ce:null,Pe=ce&&ce.type==="remote-content-state"?ce.id:null,[Oe,Ge]=ze(),[ut]=R("skipSizes",{parse:ot,defaultValue:!1});return O(K=>({vault:t,setManifest:Ce=>{K.setAttribute("manifest-id",Ce)},setRange:Ce=>{K.setAttribute("range-id",Ce)},getRangeId(){return G.current},getContentState(){let Ce=U!=null&&U.current?U==null?void 0:U.current:F,dt=i.current.sequence,pt=dt.items[dt.sequence[dt.currentSequenceIndex][0]].id,{x:Et,y:Ri,width:cr,height:hr}=(r==null?void 0:r.current)||{},Li={id:`${pt}#xywh=${wl(Et)},${wl(Ri)},${cr},${hr}`,type:"Canvas",partOf:[{id:Ce,type:"Manifest"}]};return{contentState:Li,normalisedContentState:Bs(Li),encodedContentState:xl(Li)}},setContentStateFromText(Ce,dt=!1){if(Ce==null||Ce.trim()==="")return;let pt=Bs(_l(Ce));pt.immediate=dt,We(pt)},getManifestId(){return U.current},disableTextSelection(){K.setAttribute("text-selection-enabled","false")},enableTextSelection(){K.setAttribute("text-selection-enabled","true")},enableText(){K.setAttribute("text-enabled","true")},disableText(){K.setAttribute("text-enabled","true")}})),Tt(()=>{Pe&&!Oe&&fetch(Pe).then(K=>K.json()).then(K=>{We(Sl(K))}).catch(K=>{console.error(K),Ge(new Error(`Failed to load content state from ${Pe} 

 ${K.toString()}`))})},[Pe,Oe]),Tt(()=>{var K;if(ee&&ee.target.length){let Ce=ee.target[0];if(Ce.type==="SpecificResource"&&Ce.source.type==="Canvas"){let dt=(Ce.source.partOf||[]).find(pt=>pt.type==="Manifest");if(i.current.sequence.setCurrentCanvasId(Ce.source.id),dt&&z(dt.id),Ce.selector&&Ce.selector.type==="BoxSelector"){let{x:pt,y:Et,width:Ri,height:cr}=Ce.selector.spatial;(K=r==null?void 0:r.current)==null||K.world.gotoRegion({x:pt,y:Et,width:Ri,height:cr,immediate:ee.immediate})}}}},[ee]),!F||o?null:$(Oh.Provider,{value:e.__registerPublicApi},$(pn,{vault:t},$(t0,null,$(sP,{manifest:F,startCanvas:V,rangeId:H,pagingEnabled:ge},$(r0,{renderMultiple:!0,key:`${V}-${g?"v1":"v0"}`,background:E,interactive:S,followAnnotations:me,className:C,highlight:l,debug:f,virtualSizes:h,highlightCssClass:u,displayOptions:n,mode:y,textEnabled:we,skipSizes:ut,textSelectionEnabled:de,margin:ne},$("slot",{name:"atlas"})),$("slot",null)))),_?$("style",null,_):null,T?$("link",{rel:"stylesheet",href:T}):null)}typeof window<"u"&&On(OR,"sequence-panel",LR,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),Xe(),Qe(),Xe();var $R=({metadata:e=[],config:t,variation:i="table",labelWidth:r=16,bordered:n,labelStyle:o,showEmptyMessage:l,allowHtml:u,separator:h})=>{let g={separator:h},f=Ae(()=>{let y=(t||[]).reduce((C,_)=>[...C,..._.keys],[]),S={};for(let C of e){let _=C&&C.label?Object.values(C.label):[];for(let T of _)if(T&&T.length&&(y.indexOf(`metadata.${T[0]}`)!==-1||y.length===0)&&C){let R=`metadata.${T[0]}`;S[R]=S[R]?S[R]:[],S[R].push(C);break}}return S},[t,e]);return Object.keys(f).length===0&&l?$("slot",{name:"empty"}):t&&t.length?$("table",{"data-variation":i,"data-label-style":o,"data-bordered":n},$("slot",{slot:"header"}),$("tbody",null,t.map((y,S)=>{let C=[];for(let _ of y.keys)for(let T of f[_]||[])C.push($("div",{key:S+"__"+_},u?$("span",{dangerouslySetInnerHTML:{__html:Ar(T.value,g)}}):Ar(T.value,g)));return C.length===0?null:$("tr",{className:"metadata-row",key:S},$("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?$("span",{dangerouslySetInnerHTML:{__html:Ar(y.label,g)}}):Ar(y.label,g)),$("td",{className:"metadata-value"},C))})),$("slot",{name:"footer"})):$("table",{"data-variation":i,"data-label-style":o,"data-bordered":n},$("slot",{name:"header"}),$("tbody",null,e&&e.length?e.map((y,S)=>y?$("tr",{className:"metadata-row",key:S},$("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?$("span",{dangerouslySetInnerHTML:{__html:Ar(y.label,g)}}):Ar(y.label,g)),$("td",{className:"metadata-value"},u?$("span",{dangerouslySetInnerHTML:{__html:Ar(y.value,g)}}):Ar(y.value,g))):null):$("slot",{name:"empty-table"})),$("slot",{name:"footer"}))};function FR(e){let t=bl(),i=e.vault||t||Ih(),[r]=Be(e.manifestId),[n]=Be(e.variation),[o]=Be(e.labelStyle),[l]=Be(e.separator),[u]=Be(e.labelWidth,{parse:kr}),[h]=Be(e.bordered,{parse:ot,defaultValue:!1}),[g]=Be(e.allowHtml,{parse:ot,defaultValue:!1}),[f]=Be(e.showEmptyMessage,{parse:ot,defaultValue:!1});return r?$(Je,null,$(pn,{vault:i},$(ml,{manifest:r},$(MR,{manifestId:r,variation:n,labelStyle:o,labelWidth:u,bordered:h,showEmptyMessage:f,allowHtml:g,separator:l})))):$("slot",{name:"no-manifest"})}function MR(e){let{manifest:t}=gl(e.manifestId);return $($R,D(A({},e),{metadata:t==null?void 0:t.metadata}))}var zR=["manifest-id","config-id","variation","label-style","label-width","bordered","show-empty-message"];typeof window<"u"&&On(FR,"metadata-panel",zR,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),Xe(),Qe(),Xe();function s0(e){var t;let i=uh(),r=Mt(),n=Ae(()=>i==null?void 0:i.items.find(h=>h.type==="Canvas"),[i]),o=Ae(()=>!!(i!=null&&i.items.find(h=>h.type==="Range")),[i]),l=e.selected&&e.selected===(i==null?void 0:i.id);function u(){var h,g;if(i&&e.onRangeClick){let f={isLeaf:!o};if(n){let[y,S]=(h=n.id)==null?void 0:h.split("#");f.selector=n.id,f.canvasId=y,f.fragment=S}else if(i){let y=Uy(r,i);if(y){let[S,C]=(g=y.id)==null?void 0:g.split("#");f.selector=y.id,f.canvasId=S,f.fragment=C}}if(f.selector)try{f.parsedSelector=Sh(f.selector)}catch{}e.onRangeClick(i,f)}}return i?$("ul",{className:"range-item-container","data-leaf":!o,"data-selected":l,"data-with-selector":((t=n==null?void 0:n.id)==null?void 0:t.indexOf("#"))!==-1,"data-range-id":i.id},i.label?$("li",{className:"range-split",onClick:u},$("span",{className:"range-label"},Ar(i.label))):null,o?$("div",{className:"range-nested-container"},i.items.map(h=>h.type==="Canvas"||h.type==="SpecificResource"||!h.id?null:$(lh,{key:h.id,range:h.id},$(s0,{onRangeClick:e.onRangeClick,selected:e.selected})))):null):null}Xe(),Qe();function NR(e){let t=gn(),i=Mt();if(!t)throw new Error("No manifest");let r=e.canvasId?W2(i,t,e.canvasId):e.selectedRange?i.get(e.selectedRange):void 0;return Tt(()=>{if(r&&e.autoScroll){let n=document.querySelector(`[data-range-id="${r.id}"]`);n&&n.scrollIntoView({block:"nearest",behavior:"auto"})}},[r]),!t||!t.structures.length?$("slot",{name:"no-range"}):$(Je,null,r?$("div",{className:"range-current"},Ar(r.label)):null,t.structures.map(n=>$(lh,{key:n.id,range:n.id},$(s0,{selected:r==null?void 0:r.id,onRangeClick:e.onRangeClick}))))}Qe();function jR(e){let t=bl(),i=e.vault||t||Ih(),[r]=Be(e.manifestId),[n]=Be(e.canvasId),[o]=Be(e.selectedRange),[l]=Be(e.autoScroll,{parse:ot,defaultValue:!0}),[u,h]=ze();if(Tt(()=>{e.__registerPublicApi&&e.__registerPublicApi(f=>(h(f),{}))},[]),!r)return $("slot",{name:"no-manifest"});function g(f,y){u&&u.dispatchEvent(new CustomEvent("range-change",{detail:{range:f,isLeaf:y.isLeaf,canvasId:y.canvasId,fragment:y.fragment,selector:y.selector,parsedSelector:y.parsedSelector}}))}return $(Je,null,$(pn,{vault:i},$(BR,{manifestId:r,canvasId:n,selectedRange:o,autoScroll:l,onRangeClick:g})))}function BR(e){let{manifest:t,isLoaded:i}=gl(e.manifestId);return!t||!i?null:$(ml,{manifest:t.id},$(NR,A({},e)))}var DR=["manifest-id","config-id","canvas-id","auto-scroll","selected-range"];typeof window<"u"&&On(jR,"range-panel",DR,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}})})();/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 *//** Code to "flatten" quadratic and cubic Bzier curves to polylines.
 *
 * All code in this module is based on JavaScript code by Raph Levien, published on his blog at
 * https://raphlinus.github.io/.
 * I merely changed the structure a bit, removed some unneeded parts and added some comments and type hints.
 *
 * Flattening of quadratic Bzier curves:
 * - Article: https://raphlinus.github.io/graphics/curves/2019/12/23/flatten-quadbez.html
 * - Code: https://github.com/raphlinus/raphlinus.github.io/blob/master/_posts/2019-12-23-flatten-quadbez.md?plain=1#L73-L212
 *
 * Flattening of cubic Bzier curves: https://levien.com/tmp/flatten.html
 *
 * Note that the code in this module has a different license than the rest of the package,
 * due to the inclusion of Apache-licensed third party code.
 *
 * @license
 * Copyright 2022 Johannes Baiter <johannes.baiter@gmail.com>
 * Copyright 2019, 2022 Raph Levien <raph.levien@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */return Xw}rO();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Eu=globalThis,pf=Eu.ShadowRoot&&(Eu.ShadyCSS===void 0||Eu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,gf=Symbol(),Kw=new WeakMap;let dx=class{constructor(w,p,v){if(this._$cssResult$=!0,v!==gf)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=w,this.t=p}get styleSheet(){let w=this.o;const p=this.t;if(pf&&w===void 0){const v=p!==void 0&&p.length===1;v&&(w=Kw.get(p)),w===void 0&&((this.o=w=new CSSStyleSheet).replaceSync(this.cssText),v&&Kw.set(p,w))}return w}toString(){return this.cssText}};const nO=L=>new dx(typeof L=="string"?L:L+"",void 0,gf),sO=(L,...w)=>{const p=L.length===1?L[0]:w.reduce(((v,x,k)=>v+(I=>{if(I._$cssResult$===!0)return I.cssText;if(typeof I=="number")return I;throw Error("Value passed to 'css' function must be a 'css' function result: "+I+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(x)+L[k+1]),L[0]);return new dx(p,L,gf)},aO=(L,w)=>{if(pf)L.adoptedStyleSheets=w.map((p=>p instanceof CSSStyleSheet?p:p.styleSheet));else for(const p of w){const v=document.createElement("style"),x=Eu.litNonce;x!==void 0&&v.setAttribute("nonce",x),v.textContent=p.cssText,L.appendChild(v)}},Jw=pf?L=>L:L=>L instanceof CSSStyleSheet?(w=>{let p="";for(const v of w.cssRules)p+=v.cssText;return nO(p)})(L):L;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:oO,defineProperty:lO,getOwnPropertyDescriptor:uO,getOwnPropertyNames:cO,getOwnPropertySymbols:hO,getPrototypeOf:dO}=Object,In=globalThis,ex=In.trustedTypes,fO=ex?ex.emptyScript:"",Jd=In.reactiveElementPolyfillSupport,oo=(L,w)=>L,af={toAttribute(L,w){switch(w){case Boolean:L=L?fO:null;break;case Object:case Array:L=L==null?L:JSON.stringify(L)}return L},fromAttribute(L,w){let p=L;switch(w){case Boolean:p=L!==null;break;case Number:p=L===null?null:Number(L);break;case Object:case Array:try{p=JSON.parse(L)}catch{p=null}}return p}},fx=(L,w)=>!oO(L,w),tx={attribute:!0,type:String,converter:af,reflect:!1,useDefault:!1,hasChanged:fx};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),In.litPropertyMetadata??(In.litPropertyMetadata=new WeakMap);let oa=class extends HTMLElement{static addInitializer(w){this._$Ei(),(this.l??(this.l=[])).push(w)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(w,p=tx){if(p.state&&(p.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(w)&&((p=Object.create(p)).wrapped=!0),this.elementProperties.set(w,p),!p.noAccessor){const v=Symbol(),x=this.getPropertyDescriptor(w,v,p);x!==void 0&&lO(this.prototype,w,x)}}static getPropertyDescriptor(w,p,v){const{get:x,set:k}=uO(this.prototype,w)??{get(){return this[p]},set(I){this[p]=I}};return{get:x,set(I){const M=x==null?void 0:x.call(this);k==null||k.call(this,I),this.requestUpdate(w,M,v)},configurable:!0,enumerable:!0}}static getPropertyOptions(w){return this.elementProperties.get(w)??tx}static _$Ei(){if(this.hasOwnProperty(oo("elementProperties")))return;const w=dO(this);w.finalize(),w.l!==void 0&&(this.l=[...w.l]),this.elementProperties=new Map(w.elementProperties)}static finalize(){if(this.hasOwnProperty(oo("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(oo("properties"))){const p=this.properties,v=[...cO(p),...hO(p)];for(const x of v)this.createProperty(x,p[x])}const w=this[Symbol.metadata];if(w!==null){const p=litPropertyMetadata.get(w);if(p!==void 0)for(const[v,x]of p)this.elementProperties.set(v,x)}this._$Eh=new Map;for(const[p,v]of this.elementProperties){const x=this._$Eu(p,v);x!==void 0&&this._$Eh.set(x,p)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(w){const p=[];if(Array.isArray(w)){const v=new Set(w.flat(1/0).reverse());for(const x of v)p.unshift(Jw(x))}else w!==void 0&&p.push(Jw(w));return p}static _$Eu(w,p){const v=p.attribute;return v===!1?void 0:typeof v=="string"?v:typeof w=="string"?w.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var w;this._$ES=new Promise((p=>this.enableUpdating=p)),this._$AL=new Map,this._$E_(),this.requestUpdate(),(w=this.constructor.l)==null||w.forEach((p=>p(this)))}addController(w){var p;(this._$EO??(this._$EO=new Set)).add(w),this.renderRoot!==void 0&&this.isConnected&&((p=w.hostConnected)==null||p.call(w))}removeController(w){var p;(p=this._$EO)==null||p.delete(w)}_$E_(){const w=new Map,p=this.constructor.elementProperties;for(const v of p.keys())this.hasOwnProperty(v)&&(w.set(v,this[v]),delete this[v]);w.size>0&&(this._$Ep=w)}createRenderRoot(){const w=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return aO(w,this.constructor.elementStyles),w}connectedCallback(){var w;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(w=this._$EO)==null||w.forEach((p=>{var v;return(v=p.hostConnected)==null?void 0:v.call(p)}))}enableUpdating(w){}disconnectedCallback(){var w;(w=this._$EO)==null||w.forEach((p=>{var v;return(v=p.hostDisconnected)==null?void 0:v.call(p)}))}attributeChangedCallback(w,p,v){this._$AK(w,v)}_$ET(w,p){var k;const v=this.constructor.elementProperties.get(w),x=this.constructor._$Eu(w,v);if(x!==void 0&&v.reflect===!0){const I=(((k=v.converter)==null?void 0:k.toAttribute)!==void 0?v.converter:af).toAttribute(p,v.type);this._$Em=w,I==null?this.removeAttribute(x):this.setAttribute(x,I),this._$Em=null}}_$AK(w,p){var k,I;const v=this.constructor,x=v._$Eh.get(w);if(x!==void 0&&this._$Em!==x){const M=v.getPropertyOptions(x),j=typeof M.converter=="function"?{fromAttribute:M.converter}:((k=M.converter)==null?void 0:k.fromAttribute)!==void 0?M.converter:af;this._$Em=x;const X=j.fromAttribute(p,M.type);this[x]=X??((I=this._$Ej)==null?void 0:I.get(x))??X,this._$Em=null}}requestUpdate(w,p,v){var x;if(w!==void 0){const k=this.constructor,I=this[w];if(v??(v=k.getPropertyOptions(w)),!((v.hasChanged??fx)(I,p)||v.useDefault&&v.reflect&&I===((x=this._$Ej)==null?void 0:x.get(w))&&!this.hasAttribute(k._$Eu(w,v))))return;this.C(w,p,v)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(w,p,{useDefault:v,reflect:x,wrapped:k},I){v&&!(this._$Ej??(this._$Ej=new Map)).has(w)&&(this._$Ej.set(w,I??p??this[w]),k!==!0||I!==void 0)||(this._$AL.has(w)||(this.hasUpdated||v||(p=void 0),this._$AL.set(w,p)),x===!0&&this._$Em!==w&&(this._$Eq??(this._$Eq=new Set)).add(w))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(p){Promise.reject(p)}const w=this.scheduleUpdate();return w!=null&&await w,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var v;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[k,I]of this._$Ep)this[k]=I;this._$Ep=void 0}const x=this.constructor.elementProperties;if(x.size>0)for(const[k,I]of x){const{wrapped:M}=I,j=this[k];M!==!0||this._$AL.has(k)||j===void 0||this.C(k,void 0,I,j)}}let w=!1;const p=this._$AL;try{w=this.shouldUpdate(p),w?(this.willUpdate(p),(v=this._$EO)==null||v.forEach((x=>{var k;return(k=x.hostUpdate)==null?void 0:k.call(x)})),this.update(p)):this._$EM()}catch(x){throw w=!1,this._$EM(),x}w&&this._$AE(p)}willUpdate(w){}_$AE(w){var p;(p=this._$EO)==null||p.forEach((v=>{var x;return(x=v.hostUpdated)==null?void 0:x.call(v)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(w)),this.updated(w)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(w){return!0}update(w){this._$Eq&&(this._$Eq=this._$Eq.forEach((p=>this._$ET(p,this[p])))),this._$EM()}updated(w){}firstUpdated(w){}};oa.elementStyles=[],oa.shadowRootOptions={mode:"open"},oa[oo("elementProperties")]=new Map,oa[oo("finalized")]=new Map,Jd==null||Jd({ReactiveElement:oa}),(In.reactiveElementVersions??(In.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const lo=globalThis,Au=lo.trustedTypes,ix=Au?Au.createPolicy("lit-html",{createHTML:L=>L}):void 0,px="$lit$",Tn=`lit$${Math.random().toFixed(9).slice(2)}$`,gx="?"+Tn,pO=`<${gx}>`,ms=document,co=()=>ms.createComment(""),ho=L=>L===null||typeof L!="object"&&typeof L!="function",mf=Array.isArray,gO=L=>mf(L)||typeof(L==null?void 0:L[Symbol.iterator])=="function",ef=`[ 	
\f\r]`,so=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,rx=/-->/g,nx=/>/g,ds=RegExp(`>|${ef}(?:([^\\s"'>=/]+)(${ef}*=${ef}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),sx=/'/g,ax=/"/g,mx=/^(?:script|style|textarea|title)$/i,mO=L=>(w,...p)=>({_$litType$:L,strings:w,values:p}),fo=mO(1),vs=Symbol.for("lit-noChange"),Dt=Symbol.for("lit-nothing"),ox=new WeakMap,fs=ms.createTreeWalker(ms,129);function vx(L,w){if(!mf(L)||!L.hasOwnProperty("raw"))throw Error("invalid template strings array");return ix!==void 0?ix.createHTML(w):w}const vO=(L,w)=>{const p=L.length-1,v=[];let x,k=w===2?"<svg>":w===3?"<math>":"",I=so;for(let M=0;M<p;M++){const j=L[M];let X,se,A=-1,D=0;for(;D<j.length&&(I.lastIndex=D,se=I.exec(j),se!==null);)D=I.lastIndex,I===so?se[1]==="!--"?I=rx:se[1]!==void 0?I=nx:se[2]!==void 0?(mx.test(se[2])&&(x=RegExp("</"+se[2],"g")),I=ds):se[3]!==void 0&&(I=ds):I===ds?se[0]===">"?(I=x??so,A=-1):se[1]===void 0?A=-2:(A=I.lastIndex-se[2].length,X=se[1],I=se[3]===void 0?ds:se[3]==='"'?ax:sx):I===ax||I===sx?I=ds:I===rx||I===nx?I=so:(I=ds,x=void 0);const $e=I===ds&&L[M+1].startsWith("/>")?" ":"";k+=I===so?j+pO:A>=0?(v.push(X),j.slice(0,A)+px+j.slice(A)+Tn+$e):j+Tn+(A===-2?M:$e)}return[vx(L,k+(L[p]||"<?>")+(w===2?"</svg>":w===3?"</math>":"")),v]};class po{constructor({strings:w,_$litType$:p},v){let x;this.parts=[];let k=0,I=0;const M=w.length-1,j=this.parts,[X,se]=vO(w,p);if(this.el=po.createElement(X,v),fs.currentNode=this.el.content,p===2||p===3){const A=this.el.content.firstChild;A.replaceWith(...A.childNodes)}for(;(x=fs.nextNode())!==null&&j.length<M;){if(x.nodeType===1){if(x.hasAttributes())for(const A of x.getAttributeNames())if(A.endsWith(px)){const D=se[I++],$e=x.getAttribute(A).split(Tn),oe=/([.?@])?(.*)/.exec(D);j.push({type:1,index:k,name:oe[2],strings:$e,ctor:oe[1]==="."?bO:oe[1]==="?"?wO:oe[1]==="@"?xO:Tu}),x.removeAttribute(A)}else A.startsWith(Tn)&&(j.push({type:6,index:k}),x.removeAttribute(A));if(mx.test(x.tagName)){const A=x.textContent.split(Tn),D=A.length-1;if(D>0){x.textContent=Au?Au.emptyScript:"";for(let $e=0;$e<D;$e++)x.append(A[$e],co()),fs.nextNode(),j.push({type:2,index:++k});x.append(A[D],co())}}}else if(x.nodeType===8)if(x.data===gx)j.push({type:2,index:k});else{let A=-1;for(;(A=x.data.indexOf(Tn,A+1))!==-1;)j.push({type:7,index:k}),A+=Tn.length-1}k++}}static createElement(w,p){const v=ms.createElement("template");return v.innerHTML=w,v}}function la(L,w,p=L,v){var I,M;if(w===vs)return w;let x=v!==void 0?(I=p._$Co)==null?void 0:I[v]:p._$Cl;const k=ho(w)?void 0:w._$litDirective$;return(x==null?void 0:x.constructor)!==k&&((M=x==null?void 0:x._$AO)==null||M.call(x,!1),k===void 0?x=void 0:(x=new k(L),x._$AT(L,p,v)),v!==void 0?(p._$Co??(p._$Co=[]))[v]=x:p._$Cl=x),x!==void 0&&(w=la(L,x._$AS(L,w.values),x,v)),w}class yO{constructor(w,p){this._$AV=[],this._$AN=void 0,this._$AD=w,this._$AM=p}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(w){const{el:{content:p},parts:v}=this._$AD,x=((w==null?void 0:w.creationScope)??ms).importNode(p,!0);fs.currentNode=x;let k=fs.nextNode(),I=0,M=0,j=v[0];for(;j!==void 0;){if(I===j.index){let X;j.type===2?X=new go(k,k.nextSibling,this,w):j.type===1?X=new j.ctor(k,j.name,j.strings,this,w):j.type===6&&(X=new _O(k,this,w)),this._$AV.push(X),j=v[++M]}I!==(j==null?void 0:j.index)&&(k=fs.nextNode(),I++)}return fs.currentNode=ms,x}p(w){let p=0;for(const v of this._$AV)v!==void 0&&(v.strings!==void 0?(v._$AI(w,v,p),p+=v.strings.length-2):v._$AI(w[p])),p++}}class go{get _$AU(){var w;return((w=this._$AM)==null?void 0:w._$AU)??this._$Cv}constructor(w,p,v,x){this.type=2,this._$AH=Dt,this._$AN=void 0,this._$AA=w,this._$AB=p,this._$AM=v,this.options=x,this._$Cv=(x==null?void 0:x.isConnected)??!0}get parentNode(){let w=this._$AA.parentNode;const p=this._$AM;return p!==void 0&&(w==null?void 0:w.nodeType)===11&&(w=p.parentNode),w}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(w,p=this){w=la(this,w,p),ho(w)?w===Dt||w==null||w===""?(this._$AH!==Dt&&this._$AR(),this._$AH=Dt):w!==this._$AH&&w!==vs&&this._(w):w._$litType$!==void 0?this.$(w):w.nodeType!==void 0?this.T(w):gO(w)?this.k(w):this._(w)}O(w){return this._$AA.parentNode.insertBefore(w,this._$AB)}T(w){this._$AH!==w&&(this._$AR(),this._$AH=this.O(w))}_(w){this._$AH!==Dt&&ho(this._$AH)?this._$AA.nextSibling.data=w:this.T(ms.createTextNode(w)),this._$AH=w}$(w){var k;const{values:p,_$litType$:v}=w,x=typeof v=="number"?this._$AC(w):(v.el===void 0&&(v.el=po.createElement(vx(v.h,v.h[0]),this.options)),v);if(((k=this._$AH)==null?void 0:k._$AD)===x)this._$AH.p(p);else{const I=new yO(x,this),M=I.u(this.options);I.p(p),this.T(M),this._$AH=I}}_$AC(w){let p=ox.get(w.strings);return p===void 0&&ox.set(w.strings,p=new po(w)),p}k(w){mf(this._$AH)||(this._$AH=[],this._$AR());const p=this._$AH;let v,x=0;for(const k of w)x===p.length?p.push(v=new go(this.O(co()),this.O(co()),this,this.options)):v=p[x],v._$AI(k),x++;x<p.length&&(this._$AR(v&&v._$AB.nextSibling,x),p.length=x)}_$AR(w=this._$AA.nextSibling,p){var v;for((v=this._$AP)==null?void 0:v.call(this,!1,!0,p);w!==this._$AB;){const x=w.nextSibling;w.remove(),w=x}}setConnected(w){var p;this._$AM===void 0&&(this._$Cv=w,(p=this._$AP)==null||p.call(this,w))}}class Tu{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(w,p,v,x,k){this.type=1,this._$AH=Dt,this._$AN=void 0,this.element=w,this.name=p,this._$AM=x,this.options=k,v.length>2||v[0]!==""||v[1]!==""?(this._$AH=Array(v.length-1).fill(new String),this.strings=v):this._$AH=Dt}_$AI(w,p=this,v,x){const k=this.strings;let I=!1;if(k===void 0)w=la(this,w,p,0),I=!ho(w)||w!==this._$AH&&w!==vs,I&&(this._$AH=w);else{const M=w;let j,X;for(w=k[0],j=0;j<k.length-1;j++)X=la(this,M[v+j],p,j),X===vs&&(X=this._$AH[j]),I||(I=!ho(X)||X!==this._$AH[j]),X===Dt?w=Dt:w!==Dt&&(w+=(X??"")+k[j+1]),this._$AH[j]=X}I&&!x&&this.j(w)}j(w){w===Dt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,w??"")}}class bO extends Tu{constructor(){super(...arguments),this.type=3}j(w){this.element[this.name]=w===Dt?void 0:w}}class wO extends Tu{constructor(){super(...arguments),this.type=4}j(w){this.element.toggleAttribute(this.name,!!w&&w!==Dt)}}class xO extends Tu{constructor(w,p,v,x,k){super(w,p,v,x,k),this.type=5}_$AI(w,p=this){if((w=la(this,w,p,0)??Dt)===vs)return;const v=this._$AH,x=w===Dt&&v!==Dt||w.capture!==v.capture||w.once!==v.once||w.passive!==v.passive,k=w!==Dt&&(v===Dt||x);x&&this.element.removeEventListener(this.name,this,v),k&&this.element.addEventListener(this.name,this,w),this._$AH=w}handleEvent(w){var p;typeof this._$AH=="function"?this._$AH.call(((p=this.options)==null?void 0:p.host)??this.element,w):this._$AH.handleEvent(w)}}class _O{constructor(w,p,v){this.element=w,this.type=6,this._$AN=void 0,this._$AM=p,this.options=v}get _$AU(){return this._$AM._$AU}_$AI(w){la(this,w)}}const tf=lo.litHtmlPolyfillSupport;tf==null||tf(po,go),(lo.litHtmlVersions??(lo.litHtmlVersions=[])).push("3.3.1");const yx=(L,w,p)=>{const v=(p==null?void 0:p.renderBefore)??w;let x=v._$litPart$;if(x===void 0){const k=(p==null?void 0:p.renderBefore)??null;v._$litPart$=x=new go(w.insertBefore(co(),k),k,void 0,p??{})}return x._$AI(L),x};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ps=globalThis;let gs=class extends oa{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var p;const w=super.createRenderRoot();return(p=this.renderOptions).renderBefore??(p.renderBefore=w.firstChild),w}update(w){const p=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(w),this._$Do=yx(p,this.renderRoot,this.renderOptions)}connectedCallback(){var w;super.connectedCallback(),(w=this._$Do)==null||w.setConnected(!0)}disconnectedCallback(){var w;super.disconnectedCallback(),(w=this._$Do)==null||w.setConnected(!1)}render(){return vs}};var hx;gs._$litElement$=!0,gs.finalized=!0,(hx=ps.litElementHydrateSupport)==null||hx.call(ps,{LitElement:gs});const rf=ps.litElementPolyfillSupport;rf==null||rf({LitElement:gs});(ps.litElementVersions??(ps.litElementVersions=[])).push("4.2.1");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const SO=L=>L.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const bx={CHILD:2},wx=L=>(...w)=>({_$litDirective$:L,values:w});class xx{constructor(w){}get _$AU(){return this._$AM._$AU}_$AT(w,p,v){this._$Ct=w,this._$AM=p,this._$Ci=v}_$AS(w,p){return this.update(w,p)}update(w,p){return this.render(...p)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uo=(L,w)=>{var v;const p=L._$AN;if(p===void 0)return!1;for(const x of p)(v=x._$AO)==null||v.call(x,w,!1),uo(x,w);return!0},Pu=L=>{let w,p;do{if((w=L._$AM)===void 0)break;p=w._$AN,p.delete(L),L=w}while((p==null?void 0:p.size)===0)},_x=L=>{for(let w;w=L._$AM;L=w){let p=w._$AN;if(p===void 0)w._$AN=p=new Set;else if(p.has(L))break;p.add(L),kO(w)}};function EO(L){this._$AN!==void 0?(Pu(this),this._$AM=L,_x(this)):this._$AM=L}function CO(L,w=!1,p=0){const v=this._$AH,x=this._$AN;if(x!==void 0&&x.size!==0)if(w)if(Array.isArray(v))for(let k=p;k<v.length;k++)uo(v[k],!1),Pu(v[k]);else v!=null&&(uo(v,!1),Pu(v));else uo(this,L)}const kO=L=>{L.type==bx.CHILD&&(L._$AP??(L._$AP=CO),L._$AQ??(L._$AQ=EO))};class AO extends xx{constructor(){super(...arguments),this._$AN=void 0}_$AT(w,p,v){super._$AT(w,p,v),_x(this),this.isConnected=w._$AU}_$AO(w,p=!0){var v,x;w!==this.isConnected&&(this.isConnected=w,w?(v=this.reconnected)==null||v.call(this):(x=this.disconnected)==null||x.call(this)),p&&(uo(this,w),Pu(this))}setValue(w){if(SO(this._$Ct))this._$Ct._$AI(w,this);else{const p=[...this._$Ct._$AH];p[this._$Ci]=w,this._$Ct._$AI(p,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const PO=()=>new TO;class TO{}const nf=new WeakMap,IO=wx(class extends AO{render(L){return Dt}update(L,[w]){var v;const p=w!==this.G;return p&&this.G!==void 0&&this.rt(void 0),(p||this.lt!==this.ct)&&(this.G=w,this.ht=(v=L.options)==null?void 0:v.host,this.rt(this.ct=L.element)),Dt}rt(L){if(this.isConnected||(L=void 0),typeof this.G=="function"){const w=this.ht??globalThis;let p=nf.get(w);p===void 0&&(p=new WeakMap,nf.set(w,p)),p.get(this.G)!==void 0&&this.G.call(this.ht,void 0),p.set(this.G,L),L!==void 0&&this.G.call(this.ht,L)}else this.G.value=L}get lt(){var L,w;return typeof this.G=="function"?(L=nf.get(this.ht??globalThis))==null?void 0:L.get(this.G):(w=this.G)==null?void 0:w.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),RO=sO`
  :host {
    position: relative;
    display: flex;
    justify-content: center;
    max-height: 100vh;
    max-width: 100vw;
  }

  .image-sequence {
    height: 100vh;
    width: 100%;
  }

  .image-sequence.interactive {
    cursor: grab;
  }

  .image-sequence.interactive.loading {
    cursor: wait;
  }

  .overlay {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: rgba(0,0,0,0);
    color: white;
    transition: all 0.25s linear;
    z-index: 9999;
    pointer-events: none;
  }

  .overlay.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .overlay:not(.visible) {
    opacity: 0;
    display: none;
  }

  .overlay:hover {
    background: rgba(0,0,0,0.6);
  }

  .overlay.loading.visible {
    animation: loading-overlay 1s infinite alternate;
  }

  .buffering-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    border-radius: 5px;
    height: 15%;
    width: 15%;
    background: rgba(0,0,0,0.6);
  }

  @keyframes loading-overlay {
    from {
      opacity: 0.6;
    }
    to {
      opacity: 1;
    }
  }

  .description {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    align-items: center;
    opacity: 0;
    transition: opacity 0.25s linear;
  }

  .description__icon {
    fill: white;
    height: 2em;
  }

  .overlay:hover .description {
    opacity: 1;
  }

  canvas {
    display: none;
    pointer-events: none;
    user-select: none;
    object-fit: contain;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  canvas.visible {
    display: block;
  }

  canvas.fade-in {
    animation: fade-in 0.25s 1 linear;          
  }

  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  slot[name='placeholder-image'] img {
    display: block;
    pointer-events: none;
    opacity: 0;
    height: 100%;
    width: 100%;
    margin: 0px auto 0px;
    transition: opacity 0.25s linear;
    object-fit: contain;
  }

  slot[name='placeholder-image'] img.loading {
    opacity: 1;
    filter: brightness(0.4);
    animation: loading-image 1s linear infinite alternate;
  }

  @keyframes loading-image {
    from {
      filter: brightness(0.4);
    }
    to {
      filter: brightness(0.2);
    }
  }`;var Ut,Cu,lf,uf,cf,hf,ku;class of extends gs{constructor(){super();Yw(this,Ut);yr(this,"canvasRef",PO());this.description="Click and drag horizontally to rotate image",this.imageUrls=this.getAttribute("items").split(","),this.posterImageSrc=this.imageUrls.length>0?this.imageUrls[0]:"",this.isContinuous=this.getAttribute("continuous")==="true",this.isInteractive=this.getAttribute("interactive")==="true",this.didInteract=!1,this.isReversed=this.getAttribute("reverse")==="true",this.sequenceId=this.getAttribute("sequence-id");const p=.2;this.bufferSize=Math.ceil(this.imageUrls.length*p),this.blitting=null,this.images=Array(this.imageUrls.length).fill(null),this.requests=Array(this.imageUrls.length).fill(null),this.visible=!1,this.index=0,this.intrinsicHeight=0,this.intrinsicWidth=0,this.oldIndex=null,this.oldX=null,this.imageCount=this.imageUrls.length,this.isInteractive&&this.addEventListener("mousemove",this.handleMouseMove.bind(this))}get bufferedPct(){return Math.floor(this.images.filter((p,v)=>aa(this,Ut,Cu).includes(v)&&p!==null).length/this.bufferSize*100)}get someImagesLoaded(){return this.images.some(p=>p!==null)}connectedCallback(){super.connectedCallback();const p=(k,I)=>{k.forEach(M=>{M.isIntersecting&&(this.visible=!0,I.disconnect())})},v={root:null,threshold:.5};new IntersectionObserver(p,v).observe(this)}debounce(p,v=250,x=!1){let k=null;return function(){const I=this,M=arguments,j=function(){k=null,x||p.apply(I,M)},X=x&&!k;clearTimeout(k),k=setTimeout(j,v),X&&p.apply(I,M)}}handleMouseMove({buttons:p,clientX:v}){if(p){if(this.didInteract=!0,this.oldX){const x=v-this.oldX,k=Math.floor(Math.log(Math.abs(x)))||1;x>0?this.isReversed?this.previousImage(k):this.nextImage(k):x<0&&(this.isReversed?this.nextImage(k):this.previousImage(k))}this.oldX=v}else this.oldX=null}nextImage(p=1){const v=this.index+p>=this.imageCount?this.index+p-this.imageCount:this.index+p;this.index=v}willUpdate(p){if(p.has("rotateToIndex")&&this.rotateToIndex!==!1){const v=this.rotateToIndex-this.index+this.bufferSize/2,x=Array(v).fill(0).map((k,I)=>this.index+I+1);zr(this,Ut,ku).call(this,x).then(this.animateRotation(this.rotateToIndex))}if(p.has("animationFrame")){if(!this.animationFrame||this.images[this.animationFrame]===null)return;zr(this,Ut,hf).call(this,this.images[this.animationFrame])}p.has("index")&&this.someImagesLoaded&&zr(this,Ut,ku).call(this).then(()=>{this.animateRotation(this.index)}),p.has("visible")&&!this.visible&&zr(this,Ut,ku).call(this).then(()=>zr(this,Ut,hf).call(this))}animateRotation(p){if(this.animationFrame===p)return;this.animationFrame=this.index;const v=setInterval(()=>{if(this.animationFrame===p&&(this.index=p,this.rotateToIndex=!1,this.synchronizeSequenceInstances()),this.rotateToIndex!==p){clearInterval(v);return}this.animationFrame+=1},this.transition)}previousImage(p=1){const v=this.index-p<0?this.imageCount+this.index-p:this.index-p;this.index=v}synchronizeSequenceInstances(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{document.querySelectorAll(`q-image-sequence[sequence-id="${this.sequenceId}"]`).forEach(v=>{parseInt(v.getAttribute("index"))!==this.index&&v.setAttribute("index",this.index)})},250)}render(){const p=this.isInteractive?fo`<div slot='overlay' class="overlay ${this.didInteract===!1?"visible":""}"><span class="description">
            <svg class="description__icon">
              <symbol id="rotation-icon" viewBox="0 0 24 24">
                <path d="M6.07426 4.68451L6.89234 4.68451L6.89234 6.34444C7.68861 5.65993 8.56396 5.09807 9.5184 4.65884C10.4728 4.21961 11.4791 4 12.5371 4C13.5952 4 14.6014 4.21106 15.5559 4.63317C16.5103 5.05528 17.3856 5.6086 18.1819 6.29311L18.1819 4.68451L19 4.68451L19 7.93593L15.8913 7.93593L15.8913 7.08029L17.7565 7.08029C16.9821 6.39578 16.1694 5.85388 15.3186 5.45458C14.4678 5.05528 13.5406 4.85564 12.5371 4.85564C11.5336 4.85564 10.6092 5.05528 9.76382 5.45458C8.91847 5.85388 8.10311 6.39578 7.31775 7.08029L9.18298 7.08029L9.18298 7.93593L6.07426 7.93593L6.07426 4.68451ZM6.09062 14.0794L7.8086 9.42473L9.05209 9.90389C9.24843 9.98375 9.42023 10.0978 9.56748 10.2461C9.71474 10.3945 9.81018 10.577 9.85381 10.7938L10.1156 12.1457L14.975 9.86966C15.3895 9.67572 15.8067 9.66431 16.2267 9.83544C16.6466 10.0066 16.9493 10.3089 17.1348 10.7424C17.3202 11.1759 17.3338 11.6123 17.1757 12.0515C17.0175 12.4908 16.7312 12.8073 16.3167 13.0013L13.7479 14.1992L13.9115 14.6099C13.9333 14.6555 13.9442 14.7069 13.9442 14.7639L13.9442 14.935L13.8461 17.7415C13.8352 18.0381 13.737 18.3005 13.5516 18.5287C13.3661 18.7569 13.1316 18.9109 12.848 18.9907L9.3466 19.9491C9.03027 20.0403 8.73031 20.009 8.4467 19.8549C8.1631 19.7009 7.95585 19.4699 7.82496 19.1619L6.12334 15.1575C6.04699 14.9864 6.00608 14.8067 6.00063 14.6184C5.99518 14.4302 6.02517 14.2505 6.09062 14.0794ZM6.97415 14.6099L8.83938 19.0079L12.848 17.9469L12.9953 14.4559L12.6189 13.6002L15.9076 12.0601C16.0931 11.9688 16.2185 11.8433 16.284 11.6836C16.3494 11.5239 16.3385 11.3471 16.2512 11.1531C16.164 10.9592 16.044 10.8308 15.8913 10.7681C15.7386 10.7053 15.5695 10.7196 15.3841 10.8109L9.41204 13.5831L8.88847 10.9478L8.38126 10.7595L6.97415 14.6099Z" />
              </symbol>
              <switch>
                <use xlink:href="#rotation-icon"></use>
              </switch>
            </svg>
            <span class="description__text">${this.description}</span>
          </span></div>`:"";return fo`<div class="image-sequence ${aa(this,Ut,lf)?"":"loading"} ${this.isInteractive?"interactive":""}">
        <slot name="loading-overlay">
          <div slot="loading-overlay" class='${aa(this,Ut,lf)?"":"visible"} loading overlay'>
            <div class="buffering-indicator">Loading Image Sequence&nbsp;(${this.bufferedPct}%)...</div>
            </div>
        </slot>
        <canvas ${IO(this.canvasRef)} height="${this.intrinsicHeight}" width="${this.intrinsicWidth}" class="${this.someImagesLoaded?"visible":""} ${this.didInteract?"":"fade-in"}" slot="images"></canvas>
        <slot name="overlay">
          ${p}
        </slot>
      </div>`}}Ut=new WeakSet,Cu=function(){const p=this.images.length,v=p+this.index-Math.round(this.bufferSize/2);return Array(this.bufferSize).fill(0).map((x,k)=>(v+k)%p)},lf=function(){return this.images.filter((p,v)=>aa(this,Ut,Cu).includes(v)&&p!==null).length===this.bufferSize},uf=function(p,v){if(this.requests[v])return;const x=new Request(p),k=fetch(x).then(I=>I.blob()).then(I=>window.createImageBitmap(I)).then(I=>{this.intrinsicHeight===0&&(this.intrinsicHeight=I.height,this.intrinsicWidth=I.width),this.images[v]=I}).then(()=>{this.requests[v]=null,this.requestUpdate()}).catch(I=>{console.error(I)});return this.requests[v]=k,k},cf=function(p){this.context.drawImage(p,0,0)},hf=function(p){if(this.canvasRef.value){if(this.context??(this.context=this.canvasRef.value.getContext("2d")),p){window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>zr(this,Ut,cf).call(this,p));return}if(!this.images[this.index]){zr(this,Ut,uf).call(this,this.imageUrls[this.index],this.index);return}window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>zr(this,Ut,cf).call(this,this.images[this.index]))}},ku=function(p){if(!this.images.some(k=>k===null))return Promise.all([]);const v=p??aa(this,Ut,Cu),x=this.images.map((k,I)=>{if(!v.includes(I)||k!==null)return null;const M=this.imageUrls[I];return zr(this,Ut,uf).call(this,M,I)}).filter(k=>k);return Promise.all(x)},yr(of,"styles",[RO]),yr(of,"properties",{animationFrame:{type:Number,state:!0},bufferSize:{type:Number,state:!0},didInteract:{type:Boolean,state:!0},images:{type:Array,state:!0},imageUrls:{attribute:"image-urls",type:String},index:{type:Number},intrinsicHeight:{type:Number,state:!0},intrinsicWidth:{type:Number,state:!0},rotateToIndex:{attribute:"rotate-to-index",type:Number},transition:{type:Number},visible:{type:Boolean,state:!0}});customElements.define("q-image-sequence",of);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class df extends xx{constructor(w){if(super(w),this.it=Dt,w.type!==bx.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(w){if(w===Dt||w==null)return this._t=void 0,this.it=w;if(w===vs)return w;if(typeof w!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(w===this.it)return this._t;this.it=w;const p=[w];return p.raw=p,this._t={_$litType$:this.constructor.resultType,strings:p,values:[]}}}df.directiveName="unsafeHTML",df.resultType=1;const ao=wx(df);class Sx extends gs{setupStyles(){const w=this.querySelector('style[slot="lightbox-styles"]');w&&w.sheet&&(this.adoptedStyleSheets=[w.sheet])}constructor(){super(),this.setupStyles(),this.setupFiguresData(),this.setupFullscreenButton(),this.setupNavigationButtons(),this.setupKeyboardControls()}get counterCurrent(){return this.querySelector("[data-lightbox-counter-current]")}get counterTotal(){return this.querySelector("[data-lightbox-counter-total]")}get fullscreenButton(){return this.querySelector("[data-lightbox-fullscreen]")}get nextButton(){return this.querySelector("[data-lightbox-next]")}get previousButton(){return this.querySelector("[data-lightbox-previous]")}get slides(){return this.querySelectorAll(".q-lightbox-slides__slide")}get slideIds(){return Array.from(this.slides).map(w=>w.id)}get currentSlide(){if(this.slides.length)return this.currentId?this.slides[this.currentSlideIndex]:this.slides[0]}get currentSlideIndex(){if(this.slides.length)return this.currentId?this.slideIds.findIndex(w=>w===this.currentId):0}get fullscreen(){return document.fullscreen||this.wrapper.classList.contains("quire-entry__lightbox--fullscreen")}get wrapper(){return document.querySelector(".quire-entry__lightbox")}enterFullscreen(){const w=this.renderRoot.firstElementChild;w.requestFullscreen?w.requestFullscreen():(this.wrapper.classList.add("quire-entry__lightbox--fullscreen"),document.body.style.position="fixed",document.body.style.top=`-${window.scrollY}px`)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():(this.wrapper.classList.remove("quire-entry__lightbox--fullscreen"),document.body.style.position="",document.body.style.top="")}next(){if(!this.slides.length)return;const w=this.currentSlideIndex+1,p=this.slideIds[w%this.slides.length];this.currentId=p}previous(){if(!this.slides.length)return;const w=this.currentSlideIndex-1,p=this.slideIds.slice(w)[0];this.currentId=p}_alignSlideData(w){const{aspect_ratio:p="widescreen",mediaType:v}=w;return{...w,isAudio:v==="soundcloud",isVideo:v==="video"||v==="vimeo"||v==="youtube",aspectRatio:p}}_lightboxSlide(w){const{id:p,mediaType:v,figureElementContent:x,annotationsElementContent:k,aspectRatio:I,isVideo:M,isAudio:j,label:X,labelHtml:se,caption:A,captionHtml:D,credit:$e,creditHtml:oe}=w,mt=`q-lightbox-slides__element--${v}`,Ke=M?`q-lightbox-slides__element--video q-lightbox-slides__element--${I}`:"";return fo`<div class="q-lightbox-slides__slide" slot="slides" id="${p}">
      <div class="q-lightbox-slides__element ${mt} ${Ke} ${j?"q-lightbox-slides__element--audio":""}">
        ${ao(x)}
      </div>
      <div class="q-figure-slides__slide-ui">
        <div class="q-lightbox-slides__caption ${X||A||$e?"":"is-hidden"}">
          <span class="q-lightbox-slides__caption-label ${X?"":"is-hidden"}">${ao(se)}</span>
          <span class="q-lightbox-slides__caption-content ${A||$e?"":"is-hidden"}">${D?ao(D):""} ${oe?ao(oe):""}</span>
        </div>
        ${ao(k??"")}
      </div>
    </div>`}setupFiguresData(){const w=this.querySelector('script[type="application/json"]'),p=JSON.parse(w.innerHTML);this.figures=p,p.forEach(v=>{console.log("Rendering",v.id);const x=this._alignSlideData(v),k=document.createElement("template");yx(this._lightboxSlide(x),k.content);const I=k.content.cloneNode(!0);this.appendChild(I)})}setupFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.addEventListener("click",()=>{this.toggleFullscreen()})}setupNavigationButtons(){!this.nextButton||!this.previousButton||(this.nextButton.addEventListener("click",()=>{this.next()}),this.previousButton.addEventListener("click",()=>{this.previous()}))}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{if(this.slides.length>1)switch(w){case"ArrowRight":this.next();break;case"ArrowLeft":this.previous();break}})}toggleFullscreen(){this.updateFullscreenButton(),this.fullscreen?this.exitFullscreen():this.enterFullscreen()}updateCounterElements(){!this.counterCurrent||!this.counterTotal||(this.counterCurrent.innerText=this.currentSlideIndex+1,this.counterTotal.innerText=this.slides.length)}updateCurrentSlideElement(){this.currentSlide&&(this.slides.forEach(w=>{w.id!==this.currentId&&delete w.dataset.lightboxCurrent,[this.preloadNextId,this.preloadPrevId].includes(w.id)?w.dataset.lightboxPreload=!0:delete w.dataset.lightboxPreload}),this.currentSlide.dataset.lightboxCurrent=!0)}updateFullscreenButton(){this.fullscreenButton&&(this.fullscreenButton.dataset.lightboxFullscreen=!this.fullscreen)}render(){return this.slides.length?(this.currentId=this.slideIds[this.currentSlideIndex],this.preloadNextId=this.currentSlideIndex+1<this.slideIds.length?this.slideIds[this.currentSlideIndex+1]:void 0,this.preloadPrevId=this.currentSlideIndex-1>=0?this.slideIds[this.currentSlideIndex-1]:void 0,this.updateCurrentSlideElement(),this.updateCounterElements(),fo`
      <div class="q-lightbox">
        <slot name="lightbox-styles"></slot>
        <slot name="data"></slot>
        <div class="q-lightbox-slides">
          <slot name="slides"></slot>
        </div>
        <slot name="ui"></slot>
      </div>
    `):""}}yr(Sx,"properties",{currentId:{attribute:"current-id",type:String},preloadNextId:{attribute:"preload-next-id",type:String},preloadPrevId:{attribute:"preload-prev-id",type:String}});customElements.define("q-lightbox",Sx);class Ex extends gs{get closeButton(){return this.querySelector("[data-modal-close]")}get lightbox(){return this.querySelector("q-lightbox")}constructor(){super(),this.setupKeyboardControls(),this.setupModalTriggers()}close(){this.active=!1,this.currentId=null,this.updateLightboxCurrentId(),this.enableScrolling()}disableScrolling(){document.querySelector("html").style.overflow="hidden"}enableScrolling(){document.querySelector("html").style.overflow="auto"}getCurrentFigureId(w){const{target:p}=w;let v=p;for(;!v.matches("figure")&&!v.getAttribute("id");)v=v.parentNode;return v.getAttribute("id")}open(w){this.currentId=this.getCurrentFigureId(w),this.active=!0,this.updateLightboxCurrentId(),this.disableScrolling()}setupCloseButton(){this.closeButton&&this.closeButton.addEventListener("click",()=>{this.close()})}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{this.active&&w==="Escape"&&this.close()})}setupModalTriggers(){document.querySelectorAll(".q-figure__modal-link").forEach(w=>{w.addEventListener("click",p=>{p.preventDefault(),this.open(p)})})}updateLightboxCurrentId(){this.lightbox&&this.lightbox.setAttribute("current-id",this.currentId)}render(){return this.dataset.modalActive=this.active,this.setupCloseButton(),fo`
      <div class="q-modal">
        <slot></slot>
      </div>
    `}}yr(Ex,"properties",{active:{type:Boolean},currentId:{attribute:"current-id",type:String}});customElements.define("q-modal",Ex);var Cx=Cx||{};Cx.Widget=(function(L){function w(v){if(p[v])return p[v].exports;var x=p[v]={exports:{},id:v,loaded:!1};return L[v].call(x.exports,x,x.exports,w),x.loaded=!0,x.exports}var p={};return w.m=L,w.c=p,w.p="",w(0)})([function(L,w,p){function v(Z){return!!(Z===""||Z&&Z.charCodeAt&&Z.substr)}function x(Z){return!!(Z&&Z.constructor&&Z.call&&Z.apply)}function k(Z){return!(!Z||Z.nodeType!==1||Z.nodeName.toUpperCase()!=="IFRAME")}function I(Z){var re,he=!1;for(re in Je)if(Je.hasOwnProperty(re)&&Je[re]===Z){he=!0;break}return he}function M(Z){var re,he,te;for(re=0,he=qi.length;re<he&&(te=Z(qi[re]),te!==!1);re++);}function j(Z){var re,he,te,Re="";for(Z.substr(0,2)==="//"&&(Z=window.location.protocol+Z),te=Z.split("/"),re=0,he=te.length;re<he&&re<3;re++)Re+=te[re],re<2&&(Re+="/");return Re}function X(Z){return Z.contentWindow?Z.contentWindow:Z.contentDocument&&"parentWindow"in Z.contentDocument?Z.contentDocument.parentWindow:null}function se(Z){var re,he=[];for(re in Z)Z.hasOwnProperty(re)&&he.push(Z[re]);return he}function A(Z,re,he){he.callbacks[Z]=he.callbacks[Z]||[],he.callbacks[Z].push(re)}function D(Z,re){var he,te=!0;return re.callbacks[Z]=[],M(function(Re){if(he=Re.callbacks[Z]||[],he.length)return te=!1,!1}),te}function $e(Z,re,he){var te,Re,tt=X(he);return!!tt.postMessage&&(te=he.getAttribute("src").split("?")[0],Re=JSON.stringify({method:Z,value:re}),te.substr(0,2)==="//"&&(te=window.location.protocol+te),te=te.replace(/http:\/\/(w|wt).soundcloud.com/,"https://$1.soundcloud.com"),void tt.postMessage(Re,te))}function oe(Z){var re;return M(function(he){if(he.instance===Z)return re=he,!1}),re}function mt(Z){var re;return M(function(he){if(X(he.element)===Z)return re=he,!1}),re}function Ke(Z,re){return function(he){var te=x(he),Re=oe(this),tt=!te&&re?he:null,mi=te&&!re?he:null;return mi&&A(Z,mi,Re),$e(Z,tt,Re.element),this}}function wt(Z,re,he){var te,Re,tt;for(te=0,Re=re.length;te<Re;te++)tt=re[te],Z[tt]=Ke(tt,he)}function je(Z,re,he){return Z+"?url="+re+"&"+De(he)}function De(Z){var re,he,te=[];for(re in Z)Z.hasOwnProperty(re)&&(he=Z[re],te.push(re+"="+(re==="start_track"?parseInt(he,10):he?"true":"false")));return te.join("&")}function Qt(Z,re,he){var te,Re,tt=Z.callbacks[re]||[];for(te=0,Re=tt.length;te<Re;te++)tt[te].apply(Z.instance,he);(I(re)||re===Pt.READY)&&(Z.callbacks[re]=[])}function Ve(Z){var re,he,te,Re,tt;try{he=JSON.parse(Z.data)}catch{return!1}return re=mt(Z.source),te=he.method,Re=he.value,(!re||$t(Z.origin)===$t(re.domain))&&(re?(te===Pt.READY&&(re.isReady=!0,Qt(re,Yi),D(Yi,re)),te!==Pt.PLAY||re.playEventFired||(re.playEventFired=!0),te!==Pt.PLAY_PROGRESS||re.playEventFired||(re.playEventFired=!0,Qt(re,Pt.PLAY,[Re])),tt=[],Re!==void 0&&tt.push(Re),void Qt(re,te,tt)):(te===Pt.READY&&or.push(Z.source),!1))}function $t(Z){return Z.replace(pe,"")}var gi,$,Ai,br=p(1),Je=p(2),Gt=p(3),Pt=br.api,Fi=br.bridge,or=[],qi=[],Yi="__LATE_BINDING__",lr="http://wt.soundcloud.test:9200/",pe=/^http(?:s?)/;window.addEventListener?window.addEventListener("message",Ve,!1):window.attachEvent("onmessage",Ve),L.exports=Ai=function(Z,re,he){if(v(Z)&&(Z=document.getElementById(Z)),!k(Z))throw new Error("SC.Widget function should be given either iframe element or a string specifying id attribute of iframe element.");re&&(he=he||{},Z.src=je(lr,re,he));var te,Re,tt=mt(X(Z));return tt&&tt.instance?tt.instance:(te=or.indexOf(X(Z))>-1,Re=new gi(Z),qi.push(new $(Re,Z,te)),Re)},Ai.Events=Pt,window.SC=window.SC||{},window.SC.Widget=Ai,$=function(Z,re,he){this.instance=Z,this.element=re,this.domain=j(re.getAttribute("src")),this.isReady=!!he,this.callbacks={}},gi=function(){},gi.prototype={constructor:gi,load:function(Z,re){if(Z){re=re||{};var he=this,te=oe(this),Re=te.element,tt=Re.src,mi=tt.substr(0,tt.indexOf("?"));te.isReady=!1,te.playEventFired=!1,Re.onload=function(){he.bind(Pt.READY,function(){var ct,ys=te.callbacks;for(ct in ys)ys.hasOwnProperty(ct)&&ct!==Pt.READY&&$e(Fi.ADD_LISTENER,ct,te.element);re.callback&&re.callback()})},Re.src=je(mi,Z,re)}},bind:function(Z,re){var he=this,te=oe(this);return te&&te.element&&(Z===Pt.READY&&te.isReady?setTimeout(re,1):te.isReady?(A(Z,re,te),$e(Fi.ADD_LISTENER,Z,te.element)):A(Yi,function(){he.bind(Z,re)},te)),this},unbind:function(Z){var re,he=oe(this);he&&he.element&&(re=D(Z,he),Z!==Pt.READY&&re&&$e(Fi.REMOVE_LISTENER,Z,he.element))}},wt(gi.prototype,se(Je)),wt(gi.prototype,se(Gt),!0)},function(L,w){w.api={LOAD_PROGRESS:"loadProgress",PLAY_PROGRESS:"playProgress",PLAY:"play",PAUSE:"pause",FINISH:"finish",SEEK:"seek",READY:"ready",OPEN_SHARE_PANEL:"sharePanelOpened",CLICK_DOWNLOAD:"downloadClicked",CLICK_BUY:"buyClicked",ERROR:"error"},w.bridge={REMOVE_LISTENER:"removeEventListener",ADD_LISTENER:"addEventListener"}},function(L,w){L.exports={GET_VOLUME:"getVolume",GET_DURATION:"getDuration",GET_POSITION:"getPosition",GET_SOUNDS:"getSounds",GET_CURRENT_SOUND:"getCurrentSound",GET_CURRENT_SOUND_INDEX:"getCurrentSoundIndex",IS_PAUSED:"isPaused"}},function(L,w){L.exports={PLAY:"play",PAUSE:"pause",TOGGLE:"toggle",SEEK_TO:"seekTo",SET_VOLUME:"setVolume",NEXT:"next",PREV:"prev",SKIP:"skip"}}]);const LO=(L,w,p={})=>{const v={root:document.querySelector(".quire-entry__content"),rootMargin:"-50% 0% -50% 0%",threshold:0,...p},x=I=>{I.forEach(M=>{M.isIntersecting&&w()})};new IntersectionObserver(x,v).observe(L)};var ar;const yt=(ar=class{constructor(w){this.copyLinkButton=w.querySelector(".accordion-section__copy-link-button"),this.element=w,this.id=w.getAttribute("id"),this.globalExpand=document.querySelector(".global-accordion-expand-all"),this.globalCollapse=document.querySelector(".global-accordion-collapse-all"),this.tooltip=w.querySelector(".accordion-tooltip")}get parentAccordions(){return Array.from(yt.elements).filter(w=>w.contains(this.element)&&w!==this.element)}static setGlobalControls(){if(!(!!yt.globalCollapse&&!!yt.globalExpand))return;const p=this.globalControlsState,v=yt.elements.length,x=Array.from(yt.elements).filter(I=>I.getAttribute("open")===null).length,k=()=>{let I;switch(!0){case x===v:I="allClosed";break;case x===0:I="allOpen";break;default:I="mixed";break}return I};if(p!==k())switch(this.globalControlsState=k(),this.globalControlsState){case"allClosed":yt.globalExpand.classList.remove("visually-hidden"),yt.globalCollapse.classList.add("visually-hidden");break;case"allOpen":yt.globalExpand.classList.add("visually-hidden"),yt.globalCollapse.classList.remove("visually-hidden");break;default:yt.globalCollapse.classList.remove("visually-hidden"),yt.globalExpand.classList.remove("visually-hidden");break}}static setup(){yt.elements.length&&(yt.elements.forEach(w=>{new yt(w).init()}),yt.setGlobalControls())}addEventListeners(){this.copyLinkButton.addEventListener("click",this.copyLink.bind(this)),this.element.addEventListener("toggle",yt.setGlobalControls.bind(this)),yt.globalExpand&&yt.globalExpand.addEventListener("click",this.open.bind(this)),yt.globalCollapse&&yt.globalCollapse.addEventListener("click",this.close.bind(this))}close(){this.element.removeAttribute("open"),yt.setGlobalControls()}copyLink(){if(this.copying)return;this.copying=!0;const w=this.copyLinkButton.getAttribute("value"),{origin:p,pathname:v}=window.location;this.tooltip.classList.add("accordion-tooltip--active");try{const x=new URL(v+w,p);navigator.clipboard.writeText(x),window.history.replaceState({},"",x),setTimeout(()=>{this.tooltip.classList.remove("accordion-tooltip--active"),this.copying=!1},2e3)}catch(x){console.error("Error copying heading link: ",x)}}init(){this.addEventListeners(),this.setStateFromUrl()}open(){this.element.setAttribute("open",!0),yt.setGlobalControls()}setStateFromUrl(){const w=window.location.hash.replace(/^#/,"");if(!w)return;const p=document.querySelector(window.location.hash);(w===this.id||this.element.contains(p))&&(this.open(),this.parentAccordions&&this.parentAccordions.length&&this.parentAccordions.forEach(v=>v.setAttribute("open",!0)))}},yr(ar,"className","accordion-section"),yr(ar,"globalExpand",document.querySelector(".global-accordion-expand-all")),yr(ar,"globalCollapse",document.querySelector(".global-accordion-collapse-all")),yr(ar,"elements",document.querySelectorAll(`.${ar.className}`)),yr(ar,"partOfAccordion",w=>w.closest(`.${ar.className}`)),ar),OO=({callback:L,interval:w=200,maxTries:p=10,tries:v=0,validate:x})=>{const k=()=>{if(v===p){console.error("Polling reached maximum number of attempts");return}v++,x()?L():setTimeout(k,w)};k()};function $O(L,w=null,p=null){const v=document.querySelector(".quire-navbar"),x=7,k=v?L-v.clientHeight-x:L-x;[document.documentElement,document.body.parentNode,document.body].forEach(M=>{M.scrollTop=k})}const vf=L=>{if(!L)return;L=L.replace(":","\\:"),L=L.replace(".","\\.");const w=document.querySelector(L);if(w){yt.partOfAccordion(w)&&new yt(w.closest(`.${yt.className}`)).setStateFromUrl();const p=w.getBoundingClientRect().top+window.scrollY;$O(p),setTimeout(()=>w.focus())}},kx=L=>({checked:L.checked,id:L.getAttribute("value"),input:L.getAttribute("type"),type:L.getAttribute("data-annotation-type")}),Ax=L=>{if(!L)return;const w=L.querySelector("canvas-panel"),p=L.querySelector("q-image-sequence"),v=L.querySelector("image-service");if(w)return w.getAttribute("canvas-id");if(v)return v.getAttribute("src");if(p)return p.getAttribute("sequence-id")},lx=L=>{const[w,p,v,x]=L.split(",").map(k=>parseInt(k.trim()));return{x:w,y:p,width:v,height:x}},ff=function({annotationIds:L=[],figureId:w,historyBehavior:p="push",region:v,sequence:x={}}){if(!w){console.error("goToFigureState called without an undefined figureId");return}const k=`#${w}`,I=`[slot="slides"][id="${w}"]`,M=document.querySelector(k),j=document.querySelector(I),X=Ax(M||j);if(!M&&!j)return;const se=j.closest("q-lightbox");if(se.currentId=w,!X)return;const D=[...document.querySelectorAll(`#${w} .annotations-ui__input, [slot="slides"][id="${w}"] .annotations-ui__input`)].map(je=>{const De=je.getAttribute("data-annotation-id");return je.checked=L.includes(De),kx(je)});yt.elements.forEach(je=>{je.contains(M)&&je.setAttribute("open",!0)}),Px(X,{annotations:D,region:v||"reset",sequence:x});const $e=new URL(window.location.pathname,window.location.origin);$e.hash=w,vf($e.hash);const oe=new URLSearchParams(L.map(je=>["annotation-id",encodeURIComponent(je)]));v&&oe.set("region",encodeURIComponent(v)),Number.isInteger(parseInt(x.index))&&oe.set("sequence-index",encodeURIComponent(x.index));const mt=oe.toString(),Ke=[$e.pathname];mt&&Ke.push(mt);const wt=[{},"",`${Ke.join("?")}${$e.hash}`];p==="replace"?window.history.replaceState(...wt):window.history.pushState(...wt)},ux=L=>{const w=L.getAttribute("id"),p=Ax(L.closest(".q-figure, .q-lightbox-slides__slide")),v=document.querySelector("q-lightbox").contains(L),x=kx(L),{checked:k,input:I,type:M}=x;if(v){const j=document.querySelector(`#${w.split("lightbox-")[1]}`);j&&(j.checked=L.checked)}else{const j=document.querySelector(`#${["lightbox",w].join("-")}`);j&&(j.checked=L.checked)}if(I==="checkbox"&&M==="choice"){const j=L.closest("form"),X=j.querySelectorAll(".annotations-ui__input[checked]");if(!k&&X.length===1&&X[0].setAttribute("disabled",!0),k){const se=j.querySelector("[disabled]");se&&se.removeAttribute("disabled")}}Px(p,{annotations:[x]})},FO=(L,w)=>{const{checked:p,id:v,type:x}=w;switch(x){case"annotation":L.applyStyles(v,{opacity:+!!p});break;case"choice":OO({callback:()=>MO(L,w),validate:()=>!!L.makeChoice});break}},MO=(L,w)=>{const{checked:p,id:v,input:x}=w;L.setAttribute("choice-id",v),L.makeChoice(v,{deselect:!p,deselectOthers:x==="radio"})},zO=()=>{const L=document.querySelectorAll(".ref");for(const p of L){let v=p.getAttribute("data-annotation-ids");v=v.length?v.split(","):void 0;const x=p.getAttribute("data-figure-id"),k={index:parseInt(p.getAttribute("data-sequence-index")),transition:parseInt(p.getAttribute("data-sequence-transition"))},I=p.getAttribute("data-region");p.getAttribute("data-on-scroll")==="true"?LO(p,()=>ff({annotationIds:v,figureId:x,historyBehavior:"replace",region:I,sequence:k})):p.addEventListener("click",({target:j})=>ff({annotationIds:v,figureId:x,region:I,sequence:k}))}const w=document.querySelectorAll(".annotations-ui__input");for(const p of w)ux(p),p.addEventListener("click",({target:v})=>ux(v))},Px=(L,w)=>{const p=document.querySelectorAll(`canvas-panel[canvas-id="${L}"], image-service[src="${L}"], q-image-sequence[sequence-id="${L}"]`);p.length||console.error(`Failed to call update on canvas panel or image-service component with id ${L}. Element does not exist.`);const{annotations:v,region:x}=w;p.forEach(k=>{const I=k.tagName.toLowerCase()==="q-image-sequence";if(I&&NO(k,w),x&&!I){const M=lx(x&&x!=="reset"?x:k.getAttribute("region")),j={easing:k.easingFunctions().easeOutExpo,duration:2e3};setTimeout((()=>{k.transition(se=>{se.goToRegion(M,{transition:j})})})(),500)}Array.isArray(v)&&v.forEach(M=>FO(k,M))})},NO=(L,{sequence:w={}})=>{const{index:p,transition:v}=w,x=parseInt(L.getAttribute("index")),k=parseInt(p);if(Number.isInteger(k)&&k>=0&&x!==k){if(v){L.setAttribute("transition",v),L.setAttribute("rotate-to-index",k);return}L.setAttribute("rotate-to-index",!1),L.setAttribute("index",k)}};var sf={exports:{}};/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */var cx;function jO(){return cx||(cx=1,(function(L,w){(function(){var p=function(v){var x=new p.Builder;return x.pipeline.add(p.trimmer,p.stopWordFilter,p.stemmer),x.searchPipeline.add(p.stemmer),v.call(x,x),x.build()};p.version="2.3.9";/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */p.utils={},p.utils.warn=(function(v){return function(x){v.console&&console.warn&&console.warn(x)}})(this),p.utils.asString=function(v){return v==null?"":v.toString()},p.utils.clone=function(v){if(v==null)return v;for(var x=Object.create(null),k=Object.keys(v),I=0;I<k.length;I++){var M=k[I],j=v[M];if(Array.isArray(j)){x[M]=j.slice();continue}if(typeof j=="string"||typeof j=="number"||typeof j=="boolean"){x[M]=j;continue}throw new TypeError("clone is not deep and does not support nested objects")}return x},p.FieldRef=function(v,x,k){this.docRef=v,this.fieldName=x,this._stringValue=k},p.FieldRef.joiner="/",p.FieldRef.fromString=function(v){var x=v.indexOf(p.FieldRef.joiner);if(x===-1)throw"malformed field ref string";var k=v.slice(0,x),I=v.slice(x+1);return new p.FieldRef(I,k,v)},p.FieldRef.prototype.toString=function(){return this._stringValue==null&&(this._stringValue=this.fieldName+p.FieldRef.joiner+this.docRef),this._stringValue};/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */p.Set=function(v){if(this.elements=Object.create(null),v){this.length=v.length;for(var x=0;x<this.length;x++)this.elements[v[x]]=!0}else this.length=0},p.Set.complete={intersect:function(v){return v},union:function(){return this},contains:function(){return!0}},p.Set.empty={intersect:function(){return this},union:function(v){return v},contains:function(){return!1}},p.Set.prototype.contains=function(v){return!!this.elements[v]},p.Set.prototype.intersect=function(v){var x,k,I,M=[];if(v===p.Set.complete)return this;if(v===p.Set.empty)return v;this.length<v.length?(x=this,k=v):(x=v,k=this),I=Object.keys(x.elements);for(var j=0;j<I.length;j++){var X=I[j];X in k.elements&&M.push(X)}return new p.Set(M)},p.Set.prototype.union=function(v){return v===p.Set.complete?p.Set.complete:v===p.Set.empty?this:new p.Set(Object.keys(this.elements).concat(Object.keys(v.elements)))},p.idf=function(v,x){var k=0;for(var I in v)I!="_index"&&(k+=Object.keys(v[I]).length);var M=(x-k+.5)/(k+.5);return Math.log(1+Math.abs(M))},p.Token=function(v,x){this.str=v||"",this.metadata=x||{}},p.Token.prototype.toString=function(){return this.str},p.Token.prototype.update=function(v){return this.str=v(this.str,this.metadata),this},p.Token.prototype.clone=function(v){return v=v||function(x){return x},new p.Token(v(this.str,this.metadata),this.metadata)};/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */p.tokenizer=function(v,x){if(v==null||v==null)return[];if(Array.isArray(v))return v.map(function($e){return new p.Token(p.utils.asString($e).toLowerCase(),p.utils.clone(x))});for(var k=v.toString().toLowerCase(),I=k.length,M=[],j=0,X=0;j<=I;j++){var se=k.charAt(j),A=j-X;if(se.match(p.tokenizer.separator)||j==I){if(A>0){var D=p.utils.clone(x)||{};D.position=[X,A],D.index=M.length,M.push(new p.Token(k.slice(X,j),D))}X=j+1}}return M},p.tokenizer.separator=/[\s\-]+/;/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */p.Pipeline=function(){this._stack=[]},p.Pipeline.registeredFunctions=Object.create(null),p.Pipeline.registerFunction=function(v,x){x in this.registeredFunctions&&p.utils.warn("Overwriting existing registered function: "+x),v.label=x,p.Pipeline.registeredFunctions[v.label]=v},p.Pipeline.warnIfFunctionNotRegistered=function(v){var x=v.label&&v.label in this.registeredFunctions;x||p.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,v)},p.Pipeline.load=function(v){var x=new p.Pipeline;return v.forEach(function(k){var I=p.Pipeline.registeredFunctions[k];if(I)x.add(I);else throw new Error("Cannot load unregistered function: "+k)}),x},p.Pipeline.prototype.add=function(){var v=Array.prototype.slice.call(arguments);v.forEach(function(x){p.Pipeline.warnIfFunctionNotRegistered(x),this._stack.push(x)},this)},p.Pipeline.prototype.after=function(v,x){p.Pipeline.warnIfFunctionNotRegistered(x);var k=this._stack.indexOf(v);if(k==-1)throw new Error("Cannot find existingFn");k=k+1,this._stack.splice(k,0,x)},p.Pipeline.prototype.before=function(v,x){p.Pipeline.warnIfFunctionNotRegistered(x);var k=this._stack.indexOf(v);if(k==-1)throw new Error("Cannot find existingFn");this._stack.splice(k,0,x)},p.Pipeline.prototype.remove=function(v){var x=this._stack.indexOf(v);x!=-1&&this._stack.splice(x,1)},p.Pipeline.prototype.run=function(v){for(var x=this._stack.length,k=0;k<x;k++){for(var I=this._stack[k],M=[],j=0;j<v.length;j++){var X=I(v[j],j,v);if(!(X==null||X===""))if(Array.isArray(X))for(var se=0;se<X.length;se++)M.push(X[se]);else M.push(X)}v=M}return v},p.Pipeline.prototype.runString=function(v,x){var k=new p.Token(v,x);return this.run([k]).map(function(I){return I.toString()})},p.Pipeline.prototype.reset=function(){this._stack=[]},p.Pipeline.prototype.toJSON=function(){return this._stack.map(function(v){return p.Pipeline.warnIfFunctionNotRegistered(v),v.label})};/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */p.Vector=function(v){this._magnitude=0,this.elements=v||[]},p.Vector.prototype.positionForIndex=function(v){if(this.elements.length==0)return 0;for(var x=0,k=this.elements.length/2,I=k-x,M=Math.floor(I/2),j=this.elements[M*2];I>1&&(j<v&&(x=M),j>v&&(k=M),j!=v);)I=k-x,M=x+Math.floor(I/2),j=this.elements[M*2];if(j==v||j>v)return M*2;if(j<v)return(M+1)*2},p.Vector.prototype.insert=function(v,x){this.upsert(v,x,function(){throw"duplicate index"})},p.Vector.prototype.upsert=function(v,x,k){this._magnitude=0;var I=this.positionForIndex(v);this.elements[I]==v?this.elements[I+1]=k(this.elements[I+1],x):this.elements.splice(I,0,v,x)},p.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var v=0,x=this.elements.length,k=1;k<x;k+=2){var I=this.elements[k];v+=I*I}return this._magnitude=Math.sqrt(v)},p.Vector.prototype.dot=function(v){for(var x=0,k=this.elements,I=v.elements,M=k.length,j=I.length,X=0,se=0,A=0,D=0;A<M&&D<j;)X=k[A],se=I[D],X<se?A+=2:X>se?D+=2:X==se&&(x+=k[A+1]*I[D+1],A+=2,D+=2);return x},p.Vector.prototype.similarity=function(v){return this.dot(v)/this.magnitude()||0},p.Vector.prototype.toArray=function(){for(var v=new Array(this.elements.length/2),x=1,k=0;x<this.elements.length;x+=2,k++)v[k]=this.elements[x];return v},p.Vector.prototype.toJSON=function(){return this.elements};/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */p.stemmer=(function(){var v={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},x={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},k="[^aeiou]",I="[aeiouy]",M=k+"[^aeiouy]*",j=I+"[aeiou]*",X="^("+M+")?"+j+M,se="^("+M+")?"+j+M+"("+j+")?$",A="^("+M+")?"+j+M+j+M,D="^("+M+")?"+I,$e=new RegExp(X),oe=new RegExp(A),mt=new RegExp(se),Ke=new RegExp(D),wt=/^(.+?)(ss|i)es$/,je=/^(.+?)([^s])s$/,De=/^(.+?)eed$/,Qt=/^(.+?)(ed|ing)$/,Ve=/.$/,$t=/(at|bl|iz)$/,gi=new RegExp("([^aeiouylsz])\\1$"),$=new RegExp("^"+M+I+"[^aeiouwxy]$"),Ai=/^(.+?[^aeiou])y$/,br=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,Je=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,Gt=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,Pt=/^(.+?)(s|t)(ion)$/,Fi=/^(.+?)e$/,or=/ll$/,qi=new RegExp("^"+M+I+"[^aeiouwxy]$"),Yi=function(pe){var Z,re,he,te,Re,tt,mi;if(pe.length<3)return pe;if(he=pe.substr(0,1),he=="y"&&(pe=he.toUpperCase()+pe.substr(1)),te=wt,Re=je,te.test(pe)?pe=pe.replace(te,"$1$2"):Re.test(pe)&&(pe=pe.replace(Re,"$1$2")),te=De,Re=Qt,te.test(pe)){var ct=te.exec(pe);te=$e,te.test(ct[1])&&(te=Ve,pe=pe.replace(te,""))}else if(Re.test(pe)){var ct=Re.exec(pe);Z=ct[1],Re=Ke,Re.test(Z)&&(pe=Z,Re=$t,tt=gi,mi=$,Re.test(pe)?pe=pe+"e":tt.test(pe)?(te=Ve,pe=pe.replace(te,"")):mi.test(pe)&&(pe=pe+"e"))}if(te=Ai,te.test(pe)){var ct=te.exec(pe);Z=ct[1],pe=Z+"i"}if(te=br,te.test(pe)){var ct=te.exec(pe);Z=ct[1],re=ct[2],te=$e,te.test(Z)&&(pe=Z+v[re])}if(te=Je,te.test(pe)){var ct=te.exec(pe);Z=ct[1],re=ct[2],te=$e,te.test(Z)&&(pe=Z+x[re])}if(te=Gt,Re=Pt,te.test(pe)){var ct=te.exec(pe);Z=ct[1],te=oe,te.test(Z)&&(pe=Z)}else if(Re.test(pe)){var ct=Re.exec(pe);Z=ct[1]+ct[2],Re=oe,Re.test(Z)&&(pe=Z)}if(te=Fi,te.test(pe)){var ct=te.exec(pe);Z=ct[1],te=oe,Re=mt,tt=qi,(te.test(Z)||Re.test(Z)&&!tt.test(Z))&&(pe=Z)}return te=or,Re=oe,te.test(pe)&&Re.test(pe)&&(te=Ve,pe=pe.replace(te,"")),he=="y"&&(pe=he.toLowerCase()+pe.substr(1)),pe};return function(lr){return lr.update(Yi)}})(),p.Pipeline.registerFunction(p.stemmer,"stemmer");/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */p.generateStopWordFilter=function(v){var x=v.reduce(function(k,I){return k[I]=I,k},{});return function(k){if(k&&x[k.toString()]!==k.toString())return k}},p.stopWordFilter=p.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),p.Pipeline.registerFunction(p.stopWordFilter,"stopWordFilter");/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */p.trimmer=function(v){return v.update(function(x){return x.replace(/^\W+/,"").replace(/\W+$/,"")})},p.Pipeline.registerFunction(p.trimmer,"trimmer");/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */p.TokenSet=function(){this.final=!1,this.edges={},this.id=p.TokenSet._nextId,p.TokenSet._nextId+=1},p.TokenSet._nextId=1,p.TokenSet.fromArray=function(v){for(var x=new p.TokenSet.Builder,k=0,I=v.length;k<I;k++)x.insert(v[k]);return x.finish(),x.root},p.TokenSet.fromClause=function(v){return"editDistance"in v?p.TokenSet.fromFuzzyString(v.term,v.editDistance):p.TokenSet.fromString(v.term)},p.TokenSet.fromFuzzyString=function(v,x){for(var k=new p.TokenSet,I=[{node:k,editsRemaining:x,str:v}];I.length;){var M=I.pop();if(M.str.length>0){var j=M.str.charAt(0),X;j in M.node.edges?X=M.node.edges[j]:(X=new p.TokenSet,M.node.edges[j]=X),M.str.length==1&&(X.final=!0),I.push({node:X,editsRemaining:M.editsRemaining,str:M.str.slice(1)})}if(M.editsRemaining!=0){if("*"in M.node.edges)var se=M.node.edges["*"];else{var se=new p.TokenSet;M.node.edges["*"]=se}if(M.str.length==0&&(se.final=!0),I.push({node:se,editsRemaining:M.editsRemaining-1,str:M.str}),M.str.length>1&&I.push({node:M.node,editsRemaining:M.editsRemaining-1,str:M.str.slice(1)}),M.str.length==1&&(M.node.final=!0),M.str.length>=1){if("*"in M.node.edges)var A=M.node.edges["*"];else{var A=new p.TokenSet;M.node.edges["*"]=A}M.str.length==1&&(A.final=!0),I.push({node:A,editsRemaining:M.editsRemaining-1,str:M.str.slice(1)})}if(M.str.length>1){var D=M.str.charAt(0),$e=M.str.charAt(1),oe;$e in M.node.edges?oe=M.node.edges[$e]:(oe=new p.TokenSet,M.node.edges[$e]=oe),M.str.length==1&&(oe.final=!0),I.push({node:oe,editsRemaining:M.editsRemaining-1,str:D+M.str.slice(2)})}}}return k},p.TokenSet.fromString=function(v){for(var x=new p.TokenSet,k=x,I=0,M=v.length;I<M;I++){var j=v[I],X=I==M-1;if(j=="*")x.edges[j]=x,x.final=X;else{var se=new p.TokenSet;se.final=X,x.edges[j]=se,x=se}}return k},p.TokenSet.prototype.toArray=function(){for(var v=[],x=[{prefix:"",node:this}];x.length;){var k=x.pop(),I=Object.keys(k.node.edges),M=I.length;k.node.final&&(k.prefix.charAt(0),v.push(k.prefix));for(var j=0;j<M;j++){var X=I[j];x.push({prefix:k.prefix.concat(X),node:k.node.edges[X]})}}return v},p.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var v=this.final?"1":"0",x=Object.keys(this.edges).sort(),k=x.length,I=0;I<k;I++){var M=x[I],j=this.edges[M];v=v+M+j.id}return v},p.TokenSet.prototype.intersect=function(v){for(var x=new p.TokenSet,k=void 0,I=[{qNode:v,output:x,node:this}];I.length;){k=I.pop();for(var M=Object.keys(k.qNode.edges),j=M.length,X=Object.keys(k.node.edges),se=X.length,A=0;A<j;A++)for(var D=M[A],$e=0;$e<se;$e++){var oe=X[$e];if(oe==D||D=="*"){var mt=k.node.edges[oe],Ke=k.qNode.edges[D],wt=mt.final&&Ke.final,je=void 0;oe in k.output.edges?(je=k.output.edges[oe],je.final=je.final||wt):(je=new p.TokenSet,je.final=wt,k.output.edges[oe]=je),I.push({qNode:Ke,output:je,node:mt})}}}return x},p.TokenSet.Builder=function(){this.previousWord="",this.root=new p.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},p.TokenSet.Builder.prototype.insert=function(v){var x,k=0;if(v<this.previousWord)throw new Error("Out of order word insertion");for(var I=0;I<v.length&&I<this.previousWord.length&&v[I]==this.previousWord[I];I++)k++;this.minimize(k),this.uncheckedNodes.length==0?x=this.root:x=this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var I=k;I<v.length;I++){var M=new p.TokenSet,j=v[I];x.edges[j]=M,this.uncheckedNodes.push({parent:x,char:j,child:M}),x=M}x.final=!0,this.previousWord=v},p.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},p.TokenSet.Builder.prototype.minimize=function(v){for(var x=this.uncheckedNodes.length-1;x>=v;x--){var k=this.uncheckedNodes[x],I=k.child.toString();I in this.minimizedNodes?k.parent.edges[k.char]=this.minimizedNodes[I]:(k.child._str=I,this.minimizedNodes[I]=k.child),this.uncheckedNodes.pop()}};/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */p.Index=function(v){this.invertedIndex=v.invertedIndex,this.fieldVectors=v.fieldVectors,this.tokenSet=v.tokenSet,this.fields=v.fields,this.pipeline=v.pipeline},p.Index.prototype.search=function(v){return this.query(function(x){var k=new p.QueryParser(v,x);k.parse()})},p.Index.prototype.query=function(v){for(var x=new p.Query(this.fields),k=Object.create(null),I=Object.create(null),M=Object.create(null),j=Object.create(null),X=Object.create(null),se=0;se<this.fields.length;se++)I[this.fields[se]]=new p.Vector;v.call(x,x);for(var se=0;se<x.clauses.length;se++){var A=x.clauses[se],D=null,$e=p.Set.empty;A.usePipeline?D=this.pipeline.runString(A.term,{fields:A.fields}):D=[A.term];for(var oe=0;oe<D.length;oe++){var mt=D[oe];A.term=mt;var Ke=p.TokenSet.fromClause(A),wt=this.tokenSet.intersect(Ke).toArray();if(wt.length===0&&A.presence===p.Query.presence.REQUIRED){for(var je=0;je<A.fields.length;je++){var De=A.fields[je];j[De]=p.Set.empty}break}for(var Qt=0;Qt<wt.length;Qt++)for(var Ve=wt[Qt],$t=this.invertedIndex[Ve],gi=$t._index,je=0;je<A.fields.length;je++){var De=A.fields[je],$=$t[De],Ai=Object.keys($),br=Ve+"/"+De,Je=new p.Set(Ai);if(A.presence==p.Query.presence.REQUIRED&&($e=$e.union(Je),j[De]===void 0&&(j[De]=p.Set.complete)),A.presence==p.Query.presence.PROHIBITED){X[De]===void 0&&(X[De]=p.Set.empty),X[De]=X[De].union(Je);continue}if(I[De].upsert(gi,A.boost,function(Iu,wr){return Iu+wr}),!M[br]){for(var Gt=0;Gt<Ai.length;Gt++){var Pt=Ai[Gt],Fi=new p.FieldRef(Pt,De),or=$[Pt],qi;(qi=k[Fi])===void 0?k[Fi]=new p.MatchData(Ve,De,or):qi.add(Ve,De,or)}M[br]=!0}}}if(A.presence===p.Query.presence.REQUIRED)for(var je=0;je<A.fields.length;je++){var De=A.fields[je];j[De]=j[De].intersect($e)}}for(var Yi=p.Set.complete,lr=p.Set.empty,se=0;se<this.fields.length;se++){var De=this.fields[se];j[De]&&(Yi=Yi.intersect(j[De])),X[De]&&(lr=lr.union(X[De]))}var pe=Object.keys(k),Z=[],re=Object.create(null);if(x.isNegated()){pe=Object.keys(this.fieldVectors);for(var se=0;se<pe.length;se++){var Fi=pe[se],he=p.FieldRef.fromString(Fi);k[Fi]=new p.MatchData}}for(var se=0;se<pe.length;se++){var he=p.FieldRef.fromString(pe[se]),te=he.docRef;if(Yi.contains(te)&&!lr.contains(te)){var Re=this.fieldVectors[he],tt=I[he.fieldName].similarity(Re),mi;if((mi=re[te])!==void 0)mi.score+=tt,mi.matchData.combine(k[he]);else{var ct={ref:te,score:tt,matchData:k[he]};re[te]=ct,Z.push(ct)}}}return Z.sort(function(ys,mo){return mo.score-ys.score})},p.Index.prototype.toJSON=function(){var v=Object.keys(this.invertedIndex).sort().map(function(k){return[k,this.invertedIndex[k]]},this),x=Object.keys(this.fieldVectors).map(function(k){return[k,this.fieldVectors[k].toJSON()]},this);return{version:p.version,fields:this.fields,fieldVectors:x,invertedIndex:v,pipeline:this.pipeline.toJSON()}},p.Index.load=function(v){var x={},k={},I=v.fieldVectors,M=Object.create(null),j=v.invertedIndex,X=new p.TokenSet.Builder,se=p.Pipeline.load(v.pipeline);v.version!=p.version&&p.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+p.version+"' does not match serialized index '"+v.version+"'");for(var A=0;A<I.length;A++){var D=I[A],$e=D[0],oe=D[1];k[$e]=new p.Vector(oe)}for(var A=0;A<j.length;A++){var D=j[A],mt=D[0],Ke=D[1];X.insert(mt),M[mt]=Ke}return X.finish(),x.fields=v.fields,x.fieldVectors=k,x.invertedIndex=M,x.tokenSet=X.root,x.pipeline=se,new p.Index(x)};/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */p.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=p.tokenizer,this.pipeline=new p.Pipeline,this.searchPipeline=new p.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},p.Builder.prototype.ref=function(v){this._ref=v},p.Builder.prototype.field=function(v,x){if(/\//.test(v))throw new RangeError("Field '"+v+"' contains illegal character '/'");this._fields[v]=x||{}},p.Builder.prototype.b=function(v){v<0?this._b=0:v>1?this._b=1:this._b=v},p.Builder.prototype.k1=function(v){this._k1=v},p.Builder.prototype.add=function(v,x){var k=v[this._ref],I=Object.keys(this._fields);this._documents[k]=x||{},this.documentCount+=1;for(var M=0;M<I.length;M++){var j=I[M],X=this._fields[j].extractor,se=X?X(v):v[j],A=this.tokenizer(se,{fields:[j]}),D=this.pipeline.run(A),$e=new p.FieldRef(k,j),oe=Object.create(null);this.fieldTermFrequencies[$e]=oe,this.fieldLengths[$e]=0,this.fieldLengths[$e]+=D.length;for(var mt=0;mt<D.length;mt++){var Ke=D[mt];if(oe[Ke]==null&&(oe[Ke]=0),oe[Ke]+=1,this.invertedIndex[Ke]==null){var wt=Object.create(null);wt._index=this.termIndex,this.termIndex+=1;for(var je=0;je<I.length;je++)wt[I[je]]=Object.create(null);this.invertedIndex[Ke]=wt}this.invertedIndex[Ke][j][k]==null&&(this.invertedIndex[Ke][j][k]=Object.create(null));for(var De=0;De<this.metadataWhitelist.length;De++){var Qt=this.metadataWhitelist[De],Ve=Ke.metadata[Qt];this.invertedIndex[Ke][j][k][Qt]==null&&(this.invertedIndex[Ke][j][k][Qt]=[]),this.invertedIndex[Ke][j][k][Qt].push(Ve)}}}},p.Builder.prototype.calculateAverageFieldLengths=function(){for(var v=Object.keys(this.fieldLengths),x=v.length,k={},I={},M=0;M<x;M++){var j=p.FieldRef.fromString(v[M]),X=j.fieldName;I[X]||(I[X]=0),I[X]+=1,k[X]||(k[X]=0),k[X]+=this.fieldLengths[j]}for(var se=Object.keys(this._fields),M=0;M<se.length;M++){var A=se[M];k[A]=k[A]/I[A]}this.averageFieldLength=k},p.Builder.prototype.createFieldVectors=function(){for(var v={},x=Object.keys(this.fieldTermFrequencies),k=x.length,I=Object.create(null),M=0;M<k;M++){for(var j=p.FieldRef.fromString(x[M]),X=j.fieldName,se=this.fieldLengths[j],A=new p.Vector,D=this.fieldTermFrequencies[j],$e=Object.keys(D),oe=$e.length,mt=this._fields[X].boost||1,Ke=this._documents[j.docRef].boost||1,wt=0;wt<oe;wt++){var je=$e[wt],De=D[je],Qt=this.invertedIndex[je]._index,Ve,$t,gi;I[je]===void 0?(Ve=p.idf(this.invertedIndex[je],this.documentCount),I[je]=Ve):Ve=I[je],$t=Ve*((this._k1+1)*De)/(this._k1*(1-this._b+this._b*(se/this.averageFieldLength[X]))+De),$t*=mt,$t*=Ke,gi=Math.round($t*1e3)/1e3,A.insert(Qt,gi)}v[j]=A}this.fieldVectors=v},p.Builder.prototype.createTokenSet=function(){this.tokenSet=p.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},p.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new p.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},p.Builder.prototype.use=function(v){var x=Array.prototype.slice.call(arguments,1);x.unshift(this),v.apply(this,x)},p.MatchData=function(v,x,k){for(var I=Object.create(null),M=Object.keys(k||{}),j=0;j<M.length;j++){var X=M[j];I[X]=k[X].slice()}this.metadata=Object.create(null),v!==void 0&&(this.metadata[v]=Object.create(null),this.metadata[v][x]=I)},p.MatchData.prototype.combine=function(v){for(var x=Object.keys(v.metadata),k=0;k<x.length;k++){var I=x[k],M=Object.keys(v.metadata[I]);this.metadata[I]==null&&(this.metadata[I]=Object.create(null));for(var j=0;j<M.length;j++){var X=M[j],se=Object.keys(v.metadata[I][X]);this.metadata[I][X]==null&&(this.metadata[I][X]=Object.create(null));for(var A=0;A<se.length;A++){var D=se[A];this.metadata[I][X][D]==null?this.metadata[I][X][D]=v.metadata[I][X][D]:this.metadata[I][X][D]=this.metadata[I][X][D].concat(v.metadata[I][X][D])}}}},p.MatchData.prototype.add=function(v,x,k){if(!(v in this.metadata)){this.metadata[v]=Object.create(null),this.metadata[v][x]=k;return}if(!(x in this.metadata[v])){this.metadata[v][x]=k;return}for(var I=Object.keys(k),M=0;M<I.length;M++){var j=I[M];j in this.metadata[v][x]?this.metadata[v][x][j]=this.metadata[v][x][j].concat(k[j]):this.metadata[v][x][j]=k[j]}},p.Query=function(v){this.clauses=[],this.allFields=v},p.Query.wildcard=new String("*"),p.Query.wildcard.NONE=0,p.Query.wildcard.LEADING=1,p.Query.wildcard.TRAILING=2,p.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},p.Query.prototype.clause=function(v){return"fields"in v||(v.fields=this.allFields),"boost"in v||(v.boost=1),"usePipeline"in v||(v.usePipeline=!0),"wildcard"in v||(v.wildcard=p.Query.wildcard.NONE),v.wildcard&p.Query.wildcard.LEADING&&v.term.charAt(0)!=p.Query.wildcard&&(v.term="*"+v.term),v.wildcard&p.Query.wildcard.TRAILING&&v.term.slice(-1)!=p.Query.wildcard&&(v.term=""+v.term+"*"),"presence"in v||(v.presence=p.Query.presence.OPTIONAL),this.clauses.push(v),this},p.Query.prototype.isNegated=function(){for(var v=0;v<this.clauses.length;v++)if(this.clauses[v].presence!=p.Query.presence.PROHIBITED)return!1;return!0},p.Query.prototype.term=function(v,x){if(Array.isArray(v))return v.forEach(function(I){this.term(I,p.utils.clone(x))},this),this;var k=x||{};return k.term=v.toString(),this.clause(k),this},p.QueryParseError=function(v,x,k){this.name="QueryParseError",this.message=v,this.start=x,this.end=k},p.QueryParseError.prototype=new Error,p.QueryLexer=function(v){this.lexemes=[],this.str=v,this.length=v.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},p.QueryLexer.prototype.run=function(){for(var v=p.QueryLexer.lexText;v;)v=v(this)},p.QueryLexer.prototype.sliceString=function(){for(var v=[],x=this.start,k=this.pos,I=0;I<this.escapeCharPositions.length;I++)k=this.escapeCharPositions[I],v.push(this.str.slice(x,k)),x=k+1;return v.push(this.str.slice(x,this.pos)),this.escapeCharPositions.length=0,v.join("")},p.QueryLexer.prototype.emit=function(v){this.lexemes.push({type:v,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},p.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},p.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return p.QueryLexer.EOS;var v=this.str.charAt(this.pos);return this.pos+=1,v},p.QueryLexer.prototype.width=function(){return this.pos-this.start},p.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},p.QueryLexer.prototype.backup=function(){this.pos-=1},p.QueryLexer.prototype.acceptDigitRun=function(){var v,x;do v=this.next(),x=v.charCodeAt(0);while(x>47&&x<58);v!=p.QueryLexer.EOS&&this.backup()},p.QueryLexer.prototype.more=function(){return this.pos<this.length},p.QueryLexer.EOS="EOS",p.QueryLexer.FIELD="FIELD",p.QueryLexer.TERM="TERM",p.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",p.QueryLexer.BOOST="BOOST",p.QueryLexer.PRESENCE="PRESENCE",p.QueryLexer.lexField=function(v){return v.backup(),v.emit(p.QueryLexer.FIELD),v.ignore(),p.QueryLexer.lexText},p.QueryLexer.lexTerm=function(v){if(v.width()>1&&(v.backup(),v.emit(p.QueryLexer.TERM)),v.ignore(),v.more())return p.QueryLexer.lexText},p.QueryLexer.lexEditDistance=function(v){return v.ignore(),v.acceptDigitRun(),v.emit(p.QueryLexer.EDIT_DISTANCE),p.QueryLexer.lexText},p.QueryLexer.lexBoost=function(v){return v.ignore(),v.acceptDigitRun(),v.emit(p.QueryLexer.BOOST),p.QueryLexer.lexText},p.QueryLexer.lexEOS=function(v){v.width()>0&&v.emit(p.QueryLexer.TERM)},p.QueryLexer.termSeparator=p.tokenizer.separator,p.QueryLexer.lexText=function(v){for(;;){var x=v.next();if(x==p.QueryLexer.EOS)return p.QueryLexer.lexEOS;if(x.charCodeAt(0)==92){v.escapeCharacter();continue}if(x==":")return p.QueryLexer.lexField;if(x=="~")return v.backup(),v.width()>0&&v.emit(p.QueryLexer.TERM),p.QueryLexer.lexEditDistance;if(x=="^")return v.backup(),v.width()>0&&v.emit(p.QueryLexer.TERM),p.QueryLexer.lexBoost;if(x=="+"&&v.width()===1||x=="-"&&v.width()===1)return v.emit(p.QueryLexer.PRESENCE),p.QueryLexer.lexText;if(x.match(p.QueryLexer.termSeparator))return p.QueryLexer.lexTerm}},p.QueryParser=function(v,x){this.lexer=new p.QueryLexer(v),this.query=x,this.currentClause={},this.lexemeIdx=0},p.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var v=p.QueryParser.parseClause;v;)v=v(this);return this.query},p.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},p.QueryParser.prototype.consumeLexeme=function(){var v=this.peekLexeme();return this.lexemeIdx+=1,v},p.QueryParser.prototype.nextClause=function(){var v=this.currentClause;this.query.clause(v),this.currentClause={}},p.QueryParser.parseClause=function(v){var x=v.peekLexeme();if(x!=null)switch(x.type){case p.QueryLexer.PRESENCE:return p.QueryParser.parsePresence;case p.QueryLexer.FIELD:return p.QueryParser.parseField;case p.QueryLexer.TERM:return p.QueryParser.parseTerm;default:var k="expected either a field or a term, found "+x.type;throw x.str.length>=1&&(k+=" with value '"+x.str+"'"),new p.QueryParseError(k,x.start,x.end)}},p.QueryParser.parsePresence=function(v){var x=v.consumeLexeme();if(x!=null){switch(x.str){case"-":v.currentClause.presence=p.Query.presence.PROHIBITED;break;case"+":v.currentClause.presence=p.Query.presence.REQUIRED;break;default:var k="unrecognised presence operator'"+x.str+"'";throw new p.QueryParseError(k,x.start,x.end)}var I=v.peekLexeme();if(I==null){var k="expecting term or field, found nothing";throw new p.QueryParseError(k,x.start,x.end)}switch(I.type){case p.QueryLexer.FIELD:return p.QueryParser.parseField;case p.QueryLexer.TERM:return p.QueryParser.parseTerm;default:var k="expecting term or field, found '"+I.type+"'";throw new p.QueryParseError(k,I.start,I.end)}}},p.QueryParser.parseField=function(v){var x=v.consumeLexeme();if(x!=null){if(v.query.allFields.indexOf(x.str)==-1){var k=v.query.allFields.map(function(j){return"'"+j+"'"}).join(", "),I="unrecognised field '"+x.str+"', possible fields: "+k;throw new p.QueryParseError(I,x.start,x.end)}v.currentClause.fields=[x.str];var M=v.peekLexeme();if(M==null){var I="expecting term, found nothing";throw new p.QueryParseError(I,x.start,x.end)}switch(M.type){case p.QueryLexer.TERM:return p.QueryParser.parseTerm;default:var I="expecting term, found '"+M.type+"'";throw new p.QueryParseError(I,M.start,M.end)}}},p.QueryParser.parseTerm=function(v){var x=v.consumeLexeme();if(x!=null){v.currentClause.term=x.str.toLowerCase(),x.str.indexOf("*")!=-1&&(v.currentClause.usePipeline=!1);var k=v.peekLexeme();if(k==null){v.nextClause();return}switch(k.type){case p.QueryLexer.TERM:return v.nextClause(),p.QueryParser.parseTerm;case p.QueryLexer.FIELD:return v.nextClause(),p.QueryParser.parseField;case p.QueryLexer.EDIT_DISTANCE:return p.QueryParser.parseEditDistance;case p.QueryLexer.BOOST:return p.QueryParser.parseBoost;case p.QueryLexer.PRESENCE:return v.nextClause(),p.QueryParser.parsePresence;default:var I="Unexpected lexeme type '"+k.type+"'";throw new p.QueryParseError(I,k.start,k.end)}}},p.QueryParser.parseEditDistance=function(v){var x=v.consumeLexeme();if(x!=null){var k=parseInt(x.str,10);if(isNaN(k)){var I="edit distance must be numeric";throw new p.QueryParseError(I,x.start,x.end)}v.currentClause.editDistance=k;var M=v.peekLexeme();if(M==null){v.nextClause();return}switch(M.type){case p.QueryLexer.TERM:return v.nextClause(),p.QueryParser.parseTerm;case p.QueryLexer.FIELD:return v.nextClause(),p.QueryParser.parseField;case p.QueryLexer.EDIT_DISTANCE:return p.QueryParser.parseEditDistance;case p.QueryLexer.BOOST:return p.QueryParser.parseBoost;case p.QueryLexer.PRESENCE:return v.nextClause(),p.QueryParser.parsePresence;default:var I="Unexpected lexeme type '"+M.type+"'";throw new p.QueryParseError(I,M.start,M.end)}}},p.QueryParser.parseBoost=function(v){var x=v.consumeLexeme();if(x!=null){var k=parseInt(x.str,10);if(isNaN(k)){var I="boost must be numeric";throw new p.QueryParseError(I,x.start,x.end)}v.currentClause.boost=k;var M=v.peekLexeme();if(M==null){v.nextClause();return}switch(M.type){case p.QueryLexer.TERM:return v.nextClause(),p.QueryParser.parseTerm;case p.QueryLexer.FIELD:return v.nextClause(),p.QueryParser.parseField;case p.QueryLexer.EDIT_DISTANCE:return p.QueryParser.parseEditDistance;case p.QueryLexer.BOOST:return p.QueryParser.parseBoost;case p.QueryLexer.PRESENCE:return v.nextClause(),p.QueryParser.parsePresence;default:var I="Unexpected lexeme type '"+M.type+"'";throw new p.QueryParseError(I,M.start,M.end)}}},(function(v,x){L.exports=x()})(this,function(){return p})})()})(sf)),sf.exports}var BO=jO();const DO=iO(BO);class UO{constructor(w){this.contentList=w,this.index=this.buildIndex(w)}buildIndex(w){return DO(function(){this.field("abstract"),this.field("content"),this.field("contributor"),this.field("subtitle"),this.field("title"),this.field("url"),this.ref("url"),w.forEach(p=>{this.add(p)})})}search(w){return this.index.search(w).map(v=>this.contentList.find(({url:x})=>x===v.ref))}}window.toggleMenu=()=>{const L=document.getElementById("site-menu"),w=document.querySelector(".side-by-side > .quire-entry__image-wrap > .quire-entry__image"),p=L.getAttribute("aria-expanded");L.classList.toggle("is-expanded",!L.classList.contains("is-expanded")),p==="true"?(w&&w.classList.remove("menu_open"),L.setAttribute("aria-expanded","false")):(w&&w.classList.add("menu_open"),L.setAttribute("aria-expanded","true"))};window.toggleSearch=()=>{const L=document.getElementById("js-search"),w=document.getElementById("js-search-input"),p=L.getAttribute("aria-expanded");L.classList.toggle("is-active",!L.classList.contains("is-active")),p==="true"?L.setAttribute("aria-expanded","false"):(w.focus(),L.setAttribute("aria-expanded","true"))};window.search=()=>{const w=document.getElementById("js-search-input").value,p=window.QUIRE_SEARCH,v=document.getElementById("js-search-results-list"),x=document.getElementById("js-search-results-template");if(w.length>=3){const M=p.search(w);I(M)}function k(){v.innerText=""}function I(M){k(),M.forEach(j=>{const X=document.importNode(x.content,!0),se=X.querySelector(".js-search-results-item"),A=X.querySelector(".js-search-results-item-title"),D=X.querySelector(".js-search-results-item-type"),$e=X.querySelector(".js-search-results-item-length");se.href=j.url,A.textContent=j.title,D.textContent=j.type,$e.textContent=j.length,v.appendChild(X)})}};function WO(L){const w=L.target.closest("a"),p=w.hash;w.pathname.includes(window.location.pathname)&&(L.preventDefault(),window.location.hash=p),vf(p)}function HO(){const w='a[href*="#"]'+['[href="#"]','[href="#0"]',".accordion-section__heading-link",".q-figure__modal-link"].map(v=>`:not(${v})`).join("");document.querySelectorAll(w).forEach(v=>{v.addEventListener("click",WO)})}function qO(){document.getElementById("container").classList.remove("no-js"),navigator.userAgent.match(/(iPad|iPhone|iPod)/i),navigator.userAgent.match(/android/i),QO(),HO()}function QO(){const L=document.getElementById("js-search").dataset.searchIndex;if(!L){console.warn("Search data url is undefined");return}fetch(L).then(async w=>{const{ok:p,statusText:v,url:x}=w;if(!p){console.warn(`Search data ${v.toLowerCase()} at ${x}`);return}const k=await w.json();window.QUIRE_SEARCH=new UO(k)})}function VO(L){const w={month:"long"},p=L.getMonth();let v;[4,5,6].includes(p)?v=L.toLocaleDateString("en-US",w).replace(/[^A-Za-z]+/,""):(v=v===8?"Sept":L.toLocaleDateString("en-US",w).slice(0,3),v+=".");const x=L.getDate(),k=L.getFullYear();return[x,v,k].join(" ")}function GO(){const L=document.querySelectorAll(".cite-current-date"),w=VO(new Date);L.forEach(p=>{p.innerHTML=w})}function YO(L,w){const p=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--gap")),v=L.getBoundingClientRect(),x=w.getBoundingClientRect(),k=x.left-v.left,I=v.right-x.right,M=v.width/2;I>0?L.style.transform=`translateX(-${M+I+p}px)`:k>0&&(L.style.transform=`translateX(-${M-k-p}px)`)}function XO(){const L=document.querySelectorAll(".expandable [aria-expanded]");for(let w=0;w<L.length;w++)L[w].addEventListener("click",p=>{p.stopPropagation(),p.target.getAttribute("aria-expanded")==="false"?p.target.setAttribute("aria-expanded","true"):p.target.setAttribute("aria-expanded","false");const x=p.target.parentNode.querySelector(".quire-citation__content");x&&(x.getAttribute("hidden"),typeof x.getAttribute("hidden")=="string"?x.removeAttribute("hidden"):x.setAttribute("hidden","hidden"),YO(x,document.documentElement))});document.addEventListener("click",w=>{const p=w.target.parentNode;if(p&&!(p.classList.contains("quire-citation")||p.classList.contains("quire-citation__content"))){const v=document.querySelectorAll(".quire-citation__button"),x=document.querySelectorAll(".quire-citation__content");if(!x)return;for(let k=0;k<x.length;k++){if(!v[k])return;v[k].setAttribute("aria-expanded","false"),x[k].setAttribute("hidden","hidden")}}})}function ZO(){GO(),XO()}function KO(){const L=new URL(window.location),w=[...new Set(L.searchParams.keys())];return Object.fromEntries(w.map(p=>[p,L.searchParams.getAll(p).map(decodeURIComponent)]))}qO();window.addEventListener("load",()=>{ZO(),vf(window.location.hash);const L=KO();yt.setup(),zO(),window.location.hash&&ff({figureId:window.location.hash.replace(/^#/,""),annotationIds:L["annotation-id"],region:L.region?L.region[0]:null,sequence:{index:L["sequence-index"]?L["sequence-index"][0]:null}})});
//# sourceMappingURL=index-CBRUzH15.js.map
